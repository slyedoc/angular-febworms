var febworms=febworms||{};febworms.Field=function(e,t){this.name=this.type=e,t&&angular.extend(this,t),this.displayName=this.displayName||this.type.charAt(0).toUpperCase()+this.type.substring(1)},angular.module("febworms",["ngRoute","dq","febworms.templates"]),angular.module("febworms",["febworms.templates"]).config(["$provide",function(e){e.provider("febwormsConfig",function(){function e(e){for(var t=r.length;t--&&r[t].type!==e;);return t}var t={enableDebugInfo:!0,validation:{messages:{},patterns:{}},fields:{templates:[],categories:{},renderInfo:{}}},r=t.fields.templates;return{debug:function(e){t.enableDebugInfo=e},fields:{add:function(t,n,o,i){if(!(t&&t.type&&n&&n.length))throw new Error("Need a valid objectTemplate and at least one category");var a=e(t.type);-1!==a?r[a]=t:r.push(t),this.category(t.type,n),this.renderInfo(t.type,o,i)},remove:function(t){var n=e(t);-1!==n&&r.splice(n,1),this.category(t),this.renderInfo(t)},renderInfo:function(e,r,n){var o={templateUrl:r,propertiesTemplateUrl:n};t.fields.renderInfo[e]=o},category:function(e,r){angular.isArray(r)||(r=[r]),angular.forEach(t.fields.categories,function(t){delete t[e]}),angular.forEach(r,function(r){void 0===t.fields.categories[r]&&(t.fields.categories[r]={}),t.fields.categories[r][e]=!0})}},validation:{message:function(e,r){var n=t.validation.messages;if(angular.isString(e)){if(!r)throw new Error("No message specified for "+e);n[e]=r}else angular.extend(n,e)},pattern:function(e,r){angular.isString(e)?t.validation.patterns[name]=r:angular.extend(t.validation.patterns,e)}},$get:function(){return t}}})}]),angular.module("febworms",["febworms.templates"]).config(["febwormsConfigProvider",function(e){e.validation.message({required:"A value is required for this field.",minlength:'The value does not match the minimum length{{ field.schema && (" of " + field.schema.validation.minlength + " characters" || "")}}.',maxlength:'The value exceeds the maximum length{{ field.schema && (" of " + field.schema.validation.maxlength + " characters" || "")}}.',pattern:'The value "{{ field.state.$viewValue }}" does not match the required format.',email:'The value "{{ field.state.$viewValue }}" is not a valid email address.',unique:'The value "{{ field.state.$viewValue }}" is already in use.',number:'The value "{{ field.state.$viewValue }}" is not a number.',min:'The value {{ field.schema && ("should be at least " + field.schema.validation.min) || field.state.$viewValue + " is too low" }}',max:'The value {{ field.schema && ("should be less than " + field.schema.validation.max) || field.state.$viewValue + " is too high" }}'});var t={"Text input fields":[new febworms.Field("text",{displayName:"Textbox"}),new febworms.Field("email"),new febworms.Field("number",{validation:{maxlength:15}}),new febworms.Field("password"),new febworms.Field("textarea")],"Checkbox fields":[new febworms.Field("checkbox",{nolabel:!0}),new febworms.Field("checkboxlist",{displayName:"Checkbox List",options:[{value:"1",text:"Option 1"},{value:"2",text:"Option 2"},{value:"3",text:"Option 3"}],value:{1:!0,2:!0}})],"Select input fields":[new febworms.Field("radiobuttonlist",{displayName:"Radiobutton List",options:[{value:"1",text:"Option 1"},{value:"2",text:"Option 2"},{value:"3",text:"Option 3"}],value:"1"}),new febworms.Field("selectlist",{displayName:"Select List",options:[{value:"1",text:"Option 1"},{value:"2",text:"Option 2"},{value:"3",text:"Option 3"}],value:"1"})]};angular.forEach(t,function(t,r){angular.forEach(t,function(t){e.fields.add(t,r)})}),e.validation.pattern({None:void 0,Url:"^(https?:\\/\\/)?([\\da-z\\.-]+)\\.([a-z\\.]{2,6})([\\/\\w \\.-]*)*\\/?$",Domain:"^([a-z][a-z0-9-]+(\\.|\\-*\\.))+[a-z]{2,6}$","IPv4 Address":"^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$","Email Address":"^([a-z0-9_\\.-]+)@([\\da-z\\.-]+)\\.([a-z\\.]{2,6})$",Integer:"^-{0,1}\\d+$","Positive Integers":"^\\d+$","Negative Integers":"^-\\d+$",Number:"^-{0,1}\\d*\\.{0,1}d+$","Positive Number":"^\\d*\\.{0,1}\\d+$","Negative Number":"^-\\d*\\.{0,1}\\d+$","Year (1920-2099)":"^(19|20)[\\d]{2,2}$",Password:"(?=.*\\d)(?=.*[!@#$%^&*\\-=()|?.\"';:]+)(?![.\\n])(?=.*[A-Z])(?=.*[a-z]).*$"})}]),angular.module("febworms",["febworms.templates"]).directive("febwormsEditValidationMessage",["febwormsEditValidationMessageLinkFn",function(e){return{templateUrl:"components/febworms/edit/canvas/field/properties/validation/validation-message.tmpl.html",link:e,scope:!0}}]).factory("febwormsEditValidationMessageLinkFn",function(){var e="Enter a error message here that will be shown if this validation fails. If this field is empty a default message will be used.";return function(t,r,n){n.$observe("febwormsEditValidationMessage",function(e){t.validationType=e}),n.$observe("febwormsEditValidationTooltip",function(r){r=r||e,t.tooltip=r})}}),angular.module("febworms",["febworms.templates"]).directive("febwormsPropertyFieldValidation",["febwormsPropertyFieldValidationLinkFn",function(e){return{restrict:"A",templateUrl:"components/febworms/edit/canvas/field/properties/validation/validation.tmpl.html",link:e}}]).factory("febwormsPropertyFieldValidationLinkFn",["febwormsConfig",function(e){var t=[],r=e.validation.patterns;return angular.forEach(r,function(e,r){t.push({value:e,text:r})}),function(e,r,n){e.patternOptions=t,e.field.validation=e.field.validation||{},e.field.validation.messages=e.field.validation.messages||{},e.fields={required:!1,minlength:!1,maxlength:!1,pattern:!1},e.$watch(n.febwormsPropertyFieldValidation,function(t){e.fields=angular.extend(e.fields,t)})}}]),angular.module("febworms",["febworms.templates"]).directive("febwormsParsePattern",function(){return{require:["ngModel"],link:function(e,t,r,n){function o(e){console.log(e);try{new RegExp(e)}catch(t){return void i.$setValidity("pattern",!1)}return i.$setValidity("pattern",!0),e}var i=n[0];i.$parsers.push(o),console.log("123")}}}),angular.module("febworms",["febworms.templates"]).directive("febwormsPropertyField",["febwormsPropertyFieldLinkFn",function(e){return{restrict:"AE",templateUrl:"components/febworms/edit/canvas/field/properties/property-field/property-field.tmpl.html",transclude:!0,scope:!0,link:e}}]).factory("febwormsPropertyFieldLinkFn",function(){return function(e,t,r){r.$observe("febwormsPropertyField",function(t){e.fieldName=t}),r.$observe("febwormsPropertyFieldLabel",function(t){t&&(e.fieldLabel=t)})}}),angular.module("febworms",["febworms.templates"]).directive("febwormsPropertyFieldValue",["febwormsPropertyFieldValueLinkFn",function(e){return{require:["^form"],templateUrl:"components/febworms/edit/canvas/field/properties/property-field/field-value.tmpl.html",transclude:!0,link:e}}]).factory("febwormsPropertyFieldValueLinkFn",["$parse",function(){return function(e,t,r,n){e.draw=!0;var o,i=n[0];e.$watch("field.$_redraw",function(r){if(r){var n=i.fieldValue;n&&(o=n.$viewValue),e.draw=!1,e.field.$_redraw=!1}else e.draw=!0,t=t}),e.$watch(function(){return i.fieldValue},function(e){e&&o&&(e.$setViewValue(o),e.$render(),o=void 0)})}}]).directive("febwormsFieldRedraw",function(){return{require:["ngModel"],link:function(e,t,r){var n=e.$eval(r.ngModel);e.$watch(r.ngModel,function(t){t!=n&&(e.field.$_redraw=!0,n=t)})}}}),angular.module("febworms",["febworms.templates"]).directive("febwormsPropertyFieldCommon",["febwormsPropertyFieldCommonLinkFn",function(e){return{restrict:"AE",templateUrl:"components/febworms/edit/canvas/field/properties/property-field/common.tmpl.html",link:e}}]).factory("febwormsPropertyFieldCommonLinkFn",function(){return function(e,t,r){e.fields={fieldname:!1,displayname:!1,placeholder:!1,tooltip:!1,focus:!1},e.$watch(r.febwormsPropertyFieldCommon,function(t){e.fields=angular.extend(e.fields,t)})}}),angular.module("febworms",["febworms.templates"]).directive("febwormsPropertyFieldOptions",["febwormsPropertyFieldOptionsLinkFn",function(e){return{scope:!0,controller:"febwormsPropertyFieldOptionsController as optionsCtrl",templateUrl:"components/febworms/edit/canvas/field/properties/options/options.tmpl.html",link:e}}]).factory("febwormsPropertyFieldOptionsLinkFn",function(){return function(e,t,r){e.multiple=!1,r.$observe("febwormsPropertyFieldOptions",function(t){"multiple"===t&&(e.multiple=!0)})}}),angular.module("febworms",["febworms.templates"]).controller("febwormsPropertyFieldOptionsController",["$scope",function(e){function t(t,r){t!==r&&(e.multiple?(e.field.value[t]=e.field.value[r],delete e.field.value[r]):r===e.field.value&&(e.field.value=t))}var r=1;e.$watchCollection("field.options",function(r){r&&angular.forEach(r,function(r){r.$_valueWatchFn||(r.$_valueWatchFn=e.$watch(function(){return r.value},t))})}),this.addOption=function(){e.field.options||(e.field.options=[]);var t={value:"Option "+r++};e.field.options.push(t);var n=e.field.options.length;e.multiple||1!==n||(e.field.value=t.value)},this.removeOption=function(t){var r=e.field.options.splice(t,1);if(r&&r.length){var n=r[0];e.multiple?void 0!==e.field.value[n.value]&&delete e.field.value[n.value]:(n.value===e.field.value&&e.field.options.length&&(e.field.value=e.field.options[0].value),n.$_valueWatchFn())}}}]),angular.module("febworms",["febworms.templates"]).directive("febwormsEditCanvasFieldProperties",["febwormsUtils",function(e){return{templateUrl:"components/febworms/edit/canvas/field/properties/properties.tmpl.html",replace:!0,scope:{field:"=febwormsEditCanvasFieldProperties"},link:function(t){t.$watch("fieldPropertiesForm.$invalid",function(e){t.field.$_invalid=e}),t.renderInfo=e.getRenderInfo(t.field)}}}]),angular.module("febworms",["febworms.templates"]).directive("febwormsEditPaletteCategories",function(){return{templateUrl:"components/febworms/edit/palette/categories/categories.tmpl.html",require:"^febwormsEditPalette",scope:{category:"=?"},controller:"febwormsEditPaletteCategoriesController"}}),angular.module("febworms",["febworms.templates"]).controller("febwormsEditPaletteCategoriesController",["$scope","febwormsConfig",function(e,t){e.categories=t.fields.categories,e.setCategory=function(t,r){e.categoryName=t,e.category=r}}]),angular.module("febworms",["febworms.templates"]).directive("febwormsEditCanvasField",function(){return{replace:!0,templateUrl:"components/febworms/edit/canvas/field/field.tmpl.html"}}),angular.module("febworms",["febworms.templates"]).directive("febwormsSchema",["febwormsSchemaLinkFn",function(e){return{require:["febwormsSchema"],controller:"febwormsSchemaController",link:e}}]).factory("febwormsSchemaLinkFn",["$parse",function(e){return function(t,r,n,o){var i=o[0],a=e(n.febwormsSchema),l=a.assign,s=a(t);i.model(s),t.$watch(function(){return i.model()},function(e){l(t,e)})}}]),angular.module("febworms",["febworms.templates"]).controller("febwormsSchemaController",["$scope","febwormsUtils",function(e,t){var r;this.model=function(e){return void 0!==e&&(r=e,angular.isArray(e.fields)||(e.fields=[])),r},this.addField=function(e,n){var o=t.copyField(e);n=void 0===n?r.fields.length:n,r.fields.splice(n,0,o)},this.removeField=function(e){r.fields.splice(e,1)},this.swapFields=function(e,t){-1>=e||-1>=t||e>=r.fields.length||t>=r.fields.length||(r.fields[e]=r.fields.splice(t,1,r.fields[e])[0])},this.moveField=function(e,t){if(e>=0&&t<=r.fields.length&&e!==t){var n=r.fields.splice(e,1)[0];t>e&&--t,r.fields.splice(t,0,n)}}}]),angular.module("febworms",["febworms.templates"]).directive("febwormsFormFields",function(){return{require:["^febwormsForm"],restrict:"AE",templateUrl:"components/febworms/form/form-fields/form-fields.tmpl.html",scope:{},link:function(e,t,r,n){var o=n[0];e.$watch(function(){return o.model},function(t){e.form=t})}}}),angular.module("febworms",["febworms.templates"]).directive("febwormsFieldInput",["febwormsFieldInputLinkFn",function(e){return{require:["^febwormsField","ngModel"],link:e}}]).factory("febwormsFieldInputLinkFn",function(){return function(e,t,r,n){var o=n[0],i=n[1];o.setFieldState(i)}}),angular.module("febworms",["febworms.templates"]).directive("febwormsFieldFocus",["$parse",function(e){return{require:["?^febwormsForm"],link:function(t,r,n,o){var i=o[0],a=r[0],l=e(n.febwormsFieldFocus),s=l.assign;t.$watch(l,function(e){if(e){if(i&&(i.clearFocusOnFields(),s(t,!0),i.editMode))return;a.focus()}else i&&!i.editMode&&a.blur()})}}}]),angular.module("febworms",["febworms.templates"]).directive("febwormsField",["febwormsFieldLinkFn",function(e){return{require:["^?febwormsForm","febwormsField"],replace:!0,templateUrl:"components/febworms/form/field/field.tmpl.html",scope:{fieldSchema:"=febwormsField",tabIndex:"=?febwormsTabIndex",editMode:"=?febwormsEditMode",noValidationSummary:"=febwormsNoValidationSummary"},controller:"febwormsFieldController",link:e}}]).factory("febwormsFieldLinkFn",["febwormsUtils",function(e){return function(t,r,n,o){var i=o[0],a=o[1];void 0===t.tabIndex&&(t.tabIndex="auto"),t.renderInfo=e.getRenderInfo(t.fieldSchema),a.init(i,t.fieldSchema,t.editMode)}}]),angular.module("febworms",["febworms.templates"]).controller("febwormsFieldController",["$scope","febwormsUtils",function(e,t){var r,n,o=this;this.init=function(t,i,a){o.initForm(t),o.initField(i),o.initDefaultData(i,a),e.form=r,e.field=n},this.initForm=function(e){return r=e?e.model:{}},this.initField=function(r){return n={$_id:"id"+t.getUnique(),schema:r},e.$watch("field.schema.name",function(e){o.registerState(e)}),n},this.initDefaultData=function(t,n){var o=t.name;return r.data=r.data||{},n?(e.$watch("field.schema.value",function(e){r.data[t.name]=e}),e.$watch("field.schema.name",function(e,t){if(e!==t){var n=r.data[t];delete r.data[t],r.data[e]=n}})):r.data&&void 0===r.data[o]&&void 0!==t.value&&(r.data[o]=t.value),r.data},this.setFieldState=function(e){n.state=e,o.registerState(n.schema.name)},this.registerState=function(e){r.state&&n.state&&(r.state.$removeControl(n.state),n.state.$name=e,r.state.$addControl(n.state)),n.name=e},this.field=function(){return n},this.form=function(){return r}}]),angular.module("febworms",["febworms.templates"]).directive("febwormsEditPalette",function(){return{require:["^febwormsSchema"],templateUrl:"components/febworms/edit/palette/palette.tmpl.html",controller:"febwormsEditPaletteController",link:function(e,t,r,n){e.schemaCtrl=n[0]}}}),angular.module("febworms",["febworms.templates"]).controller("febwormsEditPaletteController",["$scope","febwormsConfig",function(e,t){e.templates=angular.copy(t.fields.templates);e.templateFilter=function(t){return!e.selectedCategory||e.selectedCategory[t.type]}}]),angular.module("febworms",["febworms.templates"]).directive("febwormsEditFormActions",["febwormsConfig",function(e){return{require:"^febwormsEdit",templateUrl:"components/febworms/edit/form-actions/form-actions.tmpl.html",link:function(t,r,n,o){t.debugInfoEnabled=e.enableDebugInfo,t.togglePreview=function(){t.schema.$_invalid||o.togglePreview()},t.handleSave=function(){t.schema.$_invalid||t.onSave({schema:t.schema})},t.handleCancel=function(){t.onCancel({schema:t.schema})}}}}]),angular.module("febworms",["febworms.templates"]).directive("febwormsEditCanvas",function(){return{require:["^febwormsEdit","^febwormsSchema"],templateUrl:"components/febworms/edit/canvas/canvas.tmpl.html",controller:"febwormsEditCanvasController as canvasCtrl",link:function(e,t,r,n){e.editCtrl=n[0],e.schemaCtrl=n[1]}}}),angular.module("febworms",["febworms.templates"]).controller("febwormsEditCanvasController",["$scope","dqUtils","$timeout","febwormsUtils",function(e,t,r){e.dragPlaceholder={visible:!1,index:0},this.dragEnter=function(){e.dragPlaceholder.visible=!0,e.dragPlaceholder.index=e.schema.fields.length},this.dragLeave=function(){e.dragPlaceholder.visible=!1},this.dragBeginCanvasField=function(e,t){return r(function(){t.$_isDragging=!0},1),{source:"canvas",field:t,index:e}},this.dragEndCanvasField=function(e){r(function(){e.$_isDragging=!1},10)},this.drop=function(){var r=t.dragData();if(!r||!r.data)throw Error("Drop without data");{var n=r.data.field,o=r.data.source,i=r.data.index;e.schema.fields}"palette"==o?e.schemaCtrl.addField(n,e.dragPlaceholder.index):"canvas"==o&&e.schemaCtrl.moveField(i,e.dragPlaceholder.index),n.$_isDragging=!1}}]),angular.module("febworms",["febworms.templates"]).directive("febwormsTabsPane",["febwormsTabsPaneLinkFn",function(e){return{require:["febwormsTabsPane","^febwormsTabs"],restrict:"EA",scope:!0,transclude:!0,controller:"febwormsTabsPaneController",templateUrl:"components/febworms/common/tabs/tabs-pane.tmpl.html",link:e}}]).factory("febwormsTabsPaneLinkFn",function(){return function(e,t,r,n){var o=n[0],i=n[1];e.$_paneCtrl=o,r.$observe("febwormsTabsPane",function(e){o.title=e}),i.addPane(o)}}),angular.module("febworms",["febworms.templates"]).controller("febwormsTabsPaneController",["$scope",function(){}]),angular.module("febworms",["febworms.templates"]).directive("febwormsTabs",function(){return{require:["febwormsTabs"],restrict:"EA",transclude:!0,controller:"febwormsTabsController",templateUrl:"components/febworms/common/tabs/tabs.tmpl.html",link:function(e,t,r,n){e.$_tabCtrl=n[0]}}}),angular.module("febworms",["febworms.templates"]).controller("febwormsTabsController",["$scope",function(){var e=this;this.panes=[],this.addPane=function(t){e.panes.push(t),1===e.panes.length&&e.active(t)},this.active=function(t){angular.forEach(e.panes,function(e){e.active=!1}),t.active=!0}}]),angular.module("febworms",["febworms.templates"]).filter("j$on",function(){return function(e,t){return t?JSON.stringify(e||{},null,"  "):angular.toJson(e||{},!0)}}).directive("jsonify",["$window","$filter",function(e,t){return{templateUrl:"components/febworms/common/jsonify/jsonify.tmpl.html",replace:!0,scope:{jsonify:"=",displayHidden:"@jsonifyDisplayHidden"},link:function(r,n,o){r.expression=o.jsonify,r.copy=function(){e.prompt("Copy to clipboard: Ctrl+C, Enter",t("j$on")(r.jsonify,r.displayHidden))}}}}]),angular.module("febworms",["febworms.templates"]).directive("febwormsUniqueFieldName",function(){function e(e,t,r){var n,o=t.model(),i=!0;if(o)for(var a=o.fields,l=0;l<a.length;l++)if(n=a[l],n!==r&&r.name===n.name){i=!1;break}e.$setValidity("unique",i)}var t=0;return{priority:100,require:["ngModel","^febwormsSchema"],link:function(r,n,o,i){var a=i[0],l=i[1],s=r.field;if(!s)throw Error("No field property on scope");r.$watch(function(){return a.$modelValue},function(){++t}),r.$watch(function(){return t},function(){e(a,l,s)})}}}),angular.module("febworms",["febworms.templates"]).directive("febwormsValidationSummary",["febwormsValidationSummaryLinkFn",function(e){return{require:["^?febwormsField","^?form"],templateUrl:"components/febworms/validation/summary.tmpl.html",scope:{fieldName:"@?febwormsValidationSummary",validationMessages:"=?febwormsValidationMessages"},link:e}}]).factory("febwormsValidationSummaryLinkFn",["febwormsConfig",function(e){return function(t,r,n,o){var i=o[0],a=o[1];i?(t.field=i.field(),t.form=i.form()):a&&(t.form={state:a},t.$watch("fieldName",function(e){t.field={name:e,state:a[e]}})),t.validationMessages&&angular.forEach(t.validationMessages,function(e,r){e||delete t.validationMessages[r]}),t.messages=angular.extend({},e.validation.messages,t.validationMessages)}}]),angular.module("febworms",["febworms.templates"]).directive("febwormsForm",["febwormsFormCompileFn",function(e){return{restrict:"AE",require:["^?form","febwormsForm","^febwormsSchema"],controller:"febwormsFormController",scope:!0,compile:e}}]).factory("febwormsFormLinkFn",function(){return function(e,t,r,n){var o=n[0],i=n[1],a=n[2],l="true"===r.febwormsNoRender;i.init(r.febwormsFormData,a,o,l)}}).factory("febwormsFormCompileFn",["febwormsFormLinkFn",function(e){return function(t,r){var n=r.febwormsNoRender;if("true"!==n){var o="<div febworms-form-fields></div>";t.append(o)}return e}}]),angular.module("febworms",["febworms.templates"]).controller("febwormsFormController",["$scope","$parse",function(e,t){this.model={};var r=this;this.init=function(n,o,i,a){r.editMode=a;var l=t(n),s=l.assign;return e.$watch(l,function(t){void 0===t&&(t={},s&&s(e,t)),r.model.data=t}),e.$watch(function(){return o.model()},function(e){void 0===e?o.model({}):r.model.schema=e}),r.model.state=i,r.model},this.clearFocusOnFields=function(){angular.forEach(r.model.schema.fields,function(e){e.focus=!1})}}]),angular.module("febworms",["febworms.templates"]).directive("febwormsEdit",function(){return{priority:100,require:"febwormsSchema",restrict:"AE",scope:{schema:"=?febwormsSchema",actionsEnabled:"=?febwormsActionsEnabled",onSave:"&febwormsOnSave",onCancel:"&febwormsOnCancel",preview:"=?febwormsPreview"},replace:!0,controller:"febwormsEditController as editCtrl",templateUrl:"components/febworms/edit/edit.tmpl.html",link:function(e,t,r,n){void 0===e.schema&&(e.schema={}),void 0===e.actionsEnabled&&(e.actionsEnabled=!0),void 0===e.preview&&(e.preview=!1),n.model(e.schema),e.schemaCtrl=n}}}),angular.module("febworms",["febworms.templates"]).controller("febwormsEditController",["$scope","febwormsUtils","$location",function(e,t,r){var n=this;e.preview=r.search().preview,this.setMetaForm=function(e){n.metaForm=e},this.togglePreview=function(){e.preview=!e.preview},e.$watch(function(){var t=e.schemaCtrl.model();if(t&&(t.$_invalid=n.metaForm?n.metaForm.$invalid:!1,!t.$_invalid)){var r=t.fields;if(r)for(var o=r.length;--o>=0&&!t.$_invalid;)t.$_invalid=r[o].$_invalid}})}]),angular.module("dq",[]).factory("dqUtils",["$window","$rootScope",function(e){var t=null;return{getEvent:function(t){return t&&t.originalEvent?t.originalEvent:t||e.event},stopEvent:function(e){return e.cancelBubble=!0,e.bubbles=!1,e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),!1},dragData:function(e){return void 0===e?t:void(t=e)},getParentArea:function(e){var t={};return e.$emit("dqLocateArea",t),t.name},isAreaMatch:function(e){var r=this.getParentArea(e),n=t?t.area:"";return r===n}}}]),angular.module("dq").directive("dqDraggable",["dqUtils","$rootScope",function(e,t){function r(e,r,n,o,i){n.$apply(function(){var a=n.$eval(o),l={area:r,data:a};i(l),t.$broadcast(e,l)})}return{restrict:"AEC",link:function(t,n,o){var i=o.dqDraggable||o.dqDragTargetArea||"",a=!1;t.$watch(o.dqDragDisabled,function(e){a=e,n.attr("draggable",a?"false":"true")}),n.on("selectstart",function(t){return!a&&this.dragDrop?(this.dragDrop(),t=e.getEvent(t),e.stopEvent(t)):void 0}).on("dragstart",function(n){if(n=e.getEvent(n),a)return e.stopEvent(n);var l=n.dataTransfer;l.effectAllowed="all",l.setData("Text","The cake is a lie!"),r("dqDragBegin",i,t,o.dqDragBegin,function(t){e.dragData(t)})}).on("dragend",function(){r("dqDragEnd",i,t,o.dqDragEnd,function(){e.dragData(null)})})}}}]),angular.module("dq").directive("dqDragEnter",["dqDragTrack",function(e){return{link:e}}]).directive("dqDragLeave",["dqDragTrack",function(e){return{link:e}}]).directive("dqDragOver",["dqDragTrack",function(e){return{link:e}}]).directive("dqDrop",["dqDragTrack",function(e){return{link:e}}]).factory("dqDragTrack",["dqUtils","$document",function(e,t){return function(r,n,o){function i(t){var r=e.getEvent(t),n=r.target||t.target;return n!==f&&(f.contains(n)||a(!0)),u.off("dragover",i),m=!1,r.dataTransfer.dropEffect=d,e.stopEvent(t)}function a(e){s=!1;var t=o.dqDragLeave;t&&(e?r.$apply(function(){r.$eval(t)}):r.$eval(t))}if(n.data("dqDragTrack")!==!0){var l=!1,s=!1,f=n[0],d="none",m=!1,u=t.find("body");r.$on("$destroy",function(){u.off("dragover",i)}),r.$on("dqDragBegin",function(){l=e.isAreaMatch(r)}),r.$on("dqDragEnd",function(){l&&a(!1)}),n.on("dragenter",function(){if(l&&s===!1){s=!0;var e=o.dqDragEnter;e&&r.$apply(function(){r.$eval(e)})}}),n.on("dragleave",function(){l&&s===!0&&(m=!0,u.on("dragover",i))}),n.on("dragover",function(t){if(l){var n,i=e.getEvent(t),a=o.dqDragOver;if(a&&r.$apply(function(){n=r.$eval(a)}),d=n===!1?"none":"copy",!m)return i.dataTransfer.dropEffect=d,e.stopEvent(t)}}),n.on("drop",function(t){e.getEvent(t);if(l){var n=o.dqDrop;n&&r.$apply(n)}return e.stopEvent(t)}),n.data("dqDragTrack",!0)}}}]),angular.module("dq").directive("dqDragArea",["dqUtils",function(){function e(e,t,r,n){n&&t&&t.area===r&&e.$eval(n)}return{restrict:"AEC",link:function(t,r,n){var o=n.dqDragArea||n.dqDragAreaName||"";t.$on("dqDragBegin",function(r,i){e(t,i,o,n.dqDragProgressBegin)}),t.$on("dqDragEnd",function(r,i){e(t,i,o,n.dqDragProgressEnd)}),t.$on("dqLocateArea",function(e,t){t.name=o,e.stopPropagation()})}}}]),angular.module("febworms",["febworms.templates"]).factory("febwormsUtils",["$templateCache","$http","$window","febwormsConfig",function(e,t,r,n){var o=+new Date%1e4;return{getScrollOffset:function(){var e={};if(void 0!==r.pageYOffset)e.x=r.pageXOffset,e.y=r.pageYOffset;else{var t=r.document.documentElement;e.x=t.scrollLeft,e.y=t.scrollTop}return e},defaultArea:"default",getRenderInfo:function(e){var t=n.fields.renderInfo[e.type];return t||(t={},n.fields.renderInfo[e.type]=t),t.templateUrl||(t.templateUrl=this.getTemplateUrl(e)),t.propertiesTemplateUrl||(t.propertiesTemplateUrl=this.getTemplateUrl(e,"properties")),t},formatTemplateUrl:function(e,t){return"components/febworms/field-templates/"+(t||this.defaultArea)+"/"+e+".tmpl.html"},getTemplateUrl:function(e,t){t=t||this.defaultArea;var r=e.type,n=this.formatTemplateUrl(r,t);return"properties"!==t&&t!==this.defaultArea&&(n=this.getTemplateUrl(e,this.defaultArea)),n},getUnique:function(){return++o},copyField:function(e){var t=angular.copy(e);return t.name="field"+this.getUnique(),t},findElementsByClass:function(e,t,r,n){if(n=n||[],e.className===t&&n.push(e),e.hasChildNodes())for(var o=0;o<e.children.length;o++){var i=e.children[o];i.className===t&&n.push(i),r&&this.findElementsByClass(i,t,r,n)}return n}}}]),angular.module("febworms",["febworms.templates"]).directive("febwormsPlaceholder",function(){return{link:function(e,t,r){e.$watch(r.febwormsPlaceholder,function(e){t.attr("placeholder",e)})}}}),angular.module("febworms",["febworms.templates"]).directive("febwormsInputNumber",function(){return{require:"ngModel",link:function(e,t,r,n){if(n.$parsers.push(function(e){if(void 0==e)return"";var t=e.replace(/[^0-9]/g,""),r=parseInt(t);return t!=e&&(n.$setViewValue(t),n.$render()),r}),n.$parsers.push(function(e){var t=n.$isEmpty(e);return t||/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/.test(e)?(n.$setValidity("number",!0),""===e?null:t?e:parseFloat(e)):void n.$setValidity("number",!1)}),n.$formatters.push(function(e){return n.$isEmpty(e)?void 0:e}),r.min){var o=function(e){var t=parseFloat(r.min);return!n.$isEmpty(e)&&t>e?void n.$setValidity("min",!1):(n.$setValidity("min",!0),e)};n.$parsers.push(o),n.$formatters.push(o)}if(r.max){var i=function(e){var t=parseFloat(r.max);return!n.$isEmpty(e)&&e>t?void n.$setValidity("max",!1):(n.$setValidity("max",!0),e)};n.$parsers.push(i),n.$formatters.push(i)}n.$formatters.push(function(e){return n.$isEmpty(e)||angular.isNumber(e)?(n.$setValidity("number",!0),e):void n.$setValidity("number",!1)})}}}),angular.module("febworms",["febworms.templates"]).directive("febwormsDropdownInput",["$compile","$document","$timeout","$parse","febwormsUtils",function(e,t,r,n,o){function i(e,t){var n='<div class="febworms-dropdown-input input-append"><input type="text"/><div class="btn-group"><a href="" class="btn dropdown-toggle" ng-click="dropdownToggle()"><span class="caret"></span></a></div></div>',o=angular.element(n),i=o.find("input"),a=t.prop("attributes");angular.forEach(a,function(e){"febworms-dropdown-input"!==e.name&&"class"!==e.name&&i.attr(e.name,e.value)});var l,s=o.find("a");return e.dropdownToggle=function(){s[0].focus(),e.dropdownVisible=!e.dropdownVisible},s.on("blur",function(){l=r(function(){e.dropdownVisible=!1},100)}),e.$on("$destroy",function(){l&&r.cancel(l),l=void 0}),o}function a(e,t,r,i,a){var l=n(r.ngModel),s=l.assign,f='<div class="febworms-dropdown" ng-class="{ \'open\': dropdownVisible }"><ul ng-if="items && items.length" class="dropdown-menu"><li ng-repeat="item in items" ng-class="{ active: item.value === getModelValue() }"><a href="" ng-click="setModelValue(item.value)">{{ item.text || item.value }}</a></li></ul></div>',d=angular.element(f);e.setModelValue=function(t){e.dropdownVisible=!1;for(var r=t||"",n=i.$formatters.length;n--;){var o=i.$formatters[n],r=o(r);if(void 0===r)break}n=i.$parsers.length;for(var a=r;n--;){var o=i.$parsers[n];if(a=o(a),void 0===a)break}void 0===a?(i.$setViewValue(r),i.$render()):s(e,t)},e.getModelValue=function(){return l(e)};var m=a[0];return e.$watch("dropdownVisible",function(e){if(e){var t=m.getBoundingClientRect(),r=o.getScrollOffset();d.css({left:r.x+t.left+"px",top:r.y+t.top+m.clientHeight+"px",width:m.clientWidth+"px"})}}),e.$watchCollection(r.febwormsDropdownInput,function(t){e.items=t}),e.$on("$destroy",function(){d.remove()}),d}return{priority:1e3,restrict:"A",terminal:!0,scope:!0,compile:function(){return function(r,n,o){var l=i(r,n,o);n.append(l),e(l)(r);var s=l.find("input"),f=s.controller("ngModel"),d=a(r,n,o,f,l),m=e(d),u=t.find("body");u.append(d),m(r)}}}}]),angular.module("febworms",["febworms.templates"]).directive("febwormsBindExpression",["$interpolate",function(e){function t(e){for(var t=[],r=e.parts,n=r.length;n--;){var o=r[n];o.exp&&!o.exp.match(/^\s*$/)&&t.push(o.exp)}return"["+t.join()+"]"}return function(r,n,o){function i(){s&&s(),s=void 0}function a(){n.text(l(r))}var l,s,f;r.$on("$destroy",function(){i()}),r.$watch(o.febwormsBindExpression,function(o){if(void 0!==o){l=e(o),n.addClass("ng-binding").data("$binding",l);var d=t(l);f!==d?(f=d,i(),s=r.$watchCollection(d,function(){a()})):a()}})}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZlYndvcm1zLmpzIiwiZWRpdC9jYW52YXMvZmllbGQvcHJvcGVydGllcy92YWxpZGF0aW9uL3ZhbGlkYXRpb24tbWVzc2FnZS1kaXJlY3RpdmUuanMiLCJlZGl0L2NhbnZhcy9maWVsZC9wcm9wZXJ0aWVzL3ZhbGlkYXRpb24vdmFsaWRhdGlvbi1kaXJlY3RpdmUuanMiLCJlZGl0L2NhbnZhcy9maWVsZC9wcm9wZXJ0aWVzL3ZhbGlkYXRpb24vcGFyc2UtcGF0dGVybi1kaXJlY3RpdmUuanMiLCJlZGl0L2NhbnZhcy9maWVsZC9wcm9wZXJ0aWVzL3Byb3BlcnR5LWZpZWxkL3Byb3BlcnR5LWZpZWxkLWRpcmVjdGl2ZS5qcyIsImVkaXQvY2FudmFzL2ZpZWxkL3Byb3BlcnRpZXMvcHJvcGVydHktZmllbGQvZmllbGQtdmFsdWUtZGlyZWN0aXZlLmpzIiwiZWRpdC9jYW52YXMvZmllbGQvcHJvcGVydGllcy9wcm9wZXJ0eS1maWVsZC9jb21tb24tZGlyZWN0aXZlLmpzIiwiZWRpdC9jYW52YXMvZmllbGQvcHJvcGVydGllcy9vcHRpb25zL29wdGlvbnMtZGlyZWN0aXZlLmpzIiwiZWRpdC9jYW52YXMvZmllbGQvcHJvcGVydGllcy9vcHRpb25zL29wdGlvbnMtY29udHJvbGxlci5qcyIsImVkaXQvY2FudmFzL2ZpZWxkL3Byb3BlcnRpZXMvcHJvcGVydGllcy1kaXJlY3RpdmUuanMiLCJlZGl0L3BhbGV0dGUvY2F0ZWdvcmllcy9jYXRlZ29yaWVzLWRpcmVjdGl2ZS5qcyIsImVkaXQvcGFsZXR0ZS9jYXRlZ29yaWVzL2NhdGVnb3JpZXMtY29udHJvbGxlci5qcyIsImVkaXQvY2FudmFzL2ZpZWxkL2ZpZWxkLWRpcmVjdGl2ZS5qcyIsImZvcm0vc2NoZW1hL3NjaGVtYS1kaXJlY3RpdmUuanMiLCJmb3JtL3NjaGVtYS9zY2hlbWEtY29udHJvbGxlci5qcyIsImZvcm0vZm9ybS1maWVsZHMvZm9ybS1maWVsZHMtZGlyZWN0aXZlLmpzIiwiZm9ybS9maWVsZC9maWVsZC1pbnB1dC1kaXJlY3RpdmUuanMiLCJmb3JtL2ZpZWxkL2ZpZWxkLWZvY3VzLWRpcmVjdGl2ZS5qcyIsImZvcm0vZmllbGQvZmllbGQtZGlyZWN0aXZlLmpzIiwiZm9ybS9maWVsZC9maWVsZC1jb250cm9sbGVyLmpzIiwiZWRpdC9wYWxldHRlL3BhbGV0dGUtZGlyZWN0aXZlLmpzIiwiZWRpdC9wYWxldHRlL3BhbGV0dGUtY29udHJvbGxlci5qcyIsImVkaXQvZm9ybS1hY3Rpb25zL2Zvcm0tYWN0aW9ucy1kaXJlY3RpdmUuanMiLCJlZGl0L2NhbnZhcy9jYW52YXMtZGlyZWN0aXZlLmpzIiwiZWRpdC9jYW52YXMvY2FudmFzLWNvbnRyb2xsZXIuanMiLCJjb21tb24vdGFicy90YWJzLXBhbmUtZGlyZWN0aXZlLmpzIiwiY29tbW9uL3RhYnMvdGFicy1wYW5lLWNvbnRyb2xsZXIuanMiLCJjb21tb24vdGFicy90YWJzLWRpcmVjdGl2ZS5qcyIsImNvbW1vbi90YWJzL3RhYnMtY29udHJvbGxlci5qcyIsImNvbW1vbi9qc29uaWZ5L2pzb25pZnkuanMiLCJ2YWxpZGF0aW9uL3VuaXF1ZS1maWVsZC1uYW1lLmpzIiwidmFsaWRhdGlvbi9zdW1tYXJ5LWRpcmVjdGl2ZS5qcyIsImZvcm0vZm9ybS1kaXJlY3RpdmUuanMiLCJmb3JtL2Zvcm0tY29udHJvbGxlci5qcyIsImVkaXQvZWRpdC1kaXJlY3RpdmUuanMiLCJlZGl0L2VkaXQtY29udHJvbGxlci5qcyIsImRyYWcvYW5ndWxhci1kcmFnLXF1ZWVuLmpzIiwiZHJhZy9kcS1kcmFnZ2FibGUuanMiLCJkcmFnL2RxLWRyYWctdHJhY2suanMiLCJkcmFnL2RxLWRyYWctYXJlYS5qcyIsImNvbW1vbi9mZWJ3b3Jtcy11dGlscy5qcyIsImNvbW1vbi9mZWJ3b3Jtcy1wbGFjZWhvbGRlci1kaXJlY3RpdmUuanMiLCJjb21tb24vZmVid29ybXMtbnVtYmVyLWlucHV0LWRpcmVjdGl2ZS5qcyIsImNvbW1vbi9mZWJ3b3Jtcy1kcm9wZG93bi1pbnB1dC1kaXJlY3RpdmUuanMiLCJjb21tb24vYmluZC1leHByZXNzaW9uLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLEdBQUEsVUFBQSxZQU1BLFVBQUEsTUFBQSxTQUFBLEVBQUEsR0FDQSxLQUFBLEtBQUEsS0FBQSxLQUFBLEVBRUEsR0FDQSxRQUFBLE9BQUEsS0FBQSxHQUdBLEtBQUEsWUFBQSxLQUFBLGFBQUEsS0FBQSxLQUFBLE9BQUEsR0FBQSxjQUFBLEtBQUEsS0FBQSxVQUFBLElBR0EsUUFBQSxPQUFBLFlBQUEsVUFBQSxLQUFBLHVCQUVBLFFBQUEsT0FBQSxZQUFBLHVCQUFBLFFBQUEsV0FBQSxTQUFBLEdBRUEsRUFBQSxTQUFBLGlCQUFBLFdBaUJBLFFBQUEsR0FBQSxHQUdBLElBRkEsR0FBQSxHQUFBLEVBQUEsT0FFQSxLQUNBLEVBQUEsR0FBQSxPQUFBLElBS0EsTUFBQSxHQXhCQSxHQUFBLElBQ0EsaUJBQUEsRUFDQSxZQUNBLFlBQ0EsYUFFQSxRQUNBLGFBQ0EsY0FDQSxnQkFJQSxFQUFBLEVBQUEsT0FBQSxTQWNBLFFBQ0EsTUFBQSxTQUFBLEdBQ0EsRUFBQSxnQkFBQSxHQUVBLFFBQ0EsSUFBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEdBRUEsS0FBQSxHQUFBLEVBQUEsTUFBQSxHQUFBLEVBQUEsUUFDQSxLQUFBLElBQUEsT0FBQSx3REFHQSxJQUFBLEdBQUEsRUFBQSxFQUFBLEtBRUEsTUFBQSxFQUNBLEVBQUEsR0FBQSxFQUVBLEVBQUEsS0FBQSxHQUdBLEtBQUEsU0FBQSxFQUFBLEtBQUEsR0FDQSxLQUFBLFdBQUEsRUFBQSxLQUFBLEVBQUEsSUFFQSxPQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsRUFBQSxFQUVBLE1BQUEsR0FDQSxFQUFBLE9BQUEsRUFBQSxHQUdBLEtBQUEsU0FBQSxHQUNBLEtBQUEsV0FBQSxJQUVBLFdBQUEsU0FBQSxFQUFBLEVBQUEsR0FDQSxHQUFBLElBQ0EsWUFBQSxFQUNBLHNCQUFBLEVBR0EsR0FBQSxPQUFBLFdBQUEsR0FBQSxHQUVBLFNBQUEsU0FBQSxFQUFBLEdBQ0EsUUFBQSxRQUFBLEtBQ0EsR0FBQSxJQUdBLFFBQUEsUUFBQSxFQUFBLE9BQUEsV0FBQSxTQUFBLFNBQ0EsR0FBQSxLQUdBLFFBQUEsUUFBQSxFQUFBLFNBQUEsR0FDQSxTQUFBLEVBQUEsT0FBQSxXQUFBLEtBQ0EsRUFBQSxPQUFBLFdBQUEsT0FHQSxFQUFBLE9BQUEsV0FBQSxHQUFBLElBQUEsTUFJQSxZQUNBLFFBQUEsU0FBQSxFQUFBLEdBRUEsR0FBQSxHQUFBLEVBQUEsV0FBQSxRQUVBLElBQUEsUUFBQSxTQUFBLEdBQUEsQ0FFQSxJQUFBLEVBQ0EsS0FBQSxJQUFBLE9BQUEsNEJBQUEsRUFHQSxHQUFBLEdBQUEsTUFFQSxTQUFBLE9BQUEsRUFBQSxJQUdBLFFBQUEsU0FBQSxFQUFBLEdBRUEsUUFBQSxTQUFBLEdBQ0EsRUFBQSxXQUFBLFNBQUEsTUFBQSxFQUVBLFFBQUEsT0FBQSxFQUFBLFdBQUEsU0FBQSxLQUlBLEtBQUEsV0FDQSxNQUFBLFVBT0EsUUFBQSxPQUFBLFlBQUEsdUJBQUEsUUFBQSx5QkFBQSxTQUFBLEdBTUEsRUFBQSxXQUFBLFNBQ0EsU0FBQSxzQ0FDQSxVQUFBLHNJQUNBLFVBQUEsK0hBQ0EsUUFBQSwrRUFDQSxNQUFBLHlFQUNBLE9BQUEsOERBQ0EsT0FBQSw0REFDQSxJQUFBLGtJQUNBLElBQUEscUlBT0EsSUFBQSxJQUNBLHFCQUNBLEdBQUEsVUFBQSxNQUFBLFFBQ0EsWUFBQSxZQUVBLEdBQUEsVUFBQSxNQUFBLFNBQ0EsR0FBQSxVQUFBLE1BQUEsVUFDQSxZQUFBLFVBQUEsTUFFQSxHQUFBLFVBQUEsTUFBQSxZQUNBLEdBQUEsVUFBQSxNQUFBLGFBRUEsbUJBQ0EsR0FBQSxVQUFBLE1BQUEsWUFBQSxTQUFBLElBQ0EsR0FBQSxVQUFBLE1BQUEsZ0JBQ0EsWUFBQSxnQkFDQSxVQUNBLE1BQUEsSUFDQSxLQUFBLGFBRUEsTUFBQSxJQUNBLEtBQUEsYUFFQSxNQUFBLElBQ0EsS0FBQSxhQUVBLE9BQ0EsR0FBQSxFQUNBLEdBQUEsTUFJQSx1QkFDQSxHQUFBLFVBQUEsTUFBQSxtQkFDQSxZQUFBLG1CQUNBLFVBQ0EsTUFBQSxJQUNBLEtBQUEsYUFFQSxNQUFBLElBQ0EsS0FBQSxhQUVBLE1BQUEsSUFDQSxLQUFBLGFBRUEsTUFBQSxNQUVBLEdBQUEsVUFBQSxNQUFBLGNBQ0EsWUFBQSxjQUNBLFVBQ0EsTUFBQSxJQUNBLEtBQUEsYUFFQSxNQUFBLElBQ0EsS0FBQSxhQUVBLE1BQUEsSUFDQSxLQUFBLGFBRUEsTUFBQSxPQW1CQSxTQUFBLFFBQUEsRUFBQSxTQUFBLEVBQUEsR0FDQSxRQUFBLFFBQUEsRUFBQSxTQUFBLEdBQ0EsRUFBQSxPQUFBLElBQUEsRUFBQSxPQVFBLEVBQUEsV0FBQSxTQUNBLEtBQUEsT0FDQSxJQUFBLDJFQUNBLE9BQUEsOENBQ0EsZUFBQSwrRkFDQSxnQkFBQSx1REFDQSxRQUFBLGVBQ0Esb0JBQUEsU0FDQSxvQkFBQSxVQUNBLE9BQUEseUJBQ0Esa0JBQUEscUJBQ0Esa0JBQUEsc0JBQ0EsbUJBQUEsc0JBQ0EsU0FBQSxtRkN2UUEsUUFBQSxPQUFBLFlBQUEsdUJBQUEsVUFBQSxpQ0FBQSxzQ0FBQSxTQUFBLEdBQ0EsT0FDQSxZQUFBLDJGQUNBLEtBQUEsRUFDQSxPQUFBLE1BRUEsUUFBQSxzQ0FBQSxXQUVBLEdBQUEsR0FBQSxnSUFFQSxPQUFBLFVBQUEsRUFBQSxFQUFBLEdBQ0EsRUFBQSxTQUFBLGdDQUFBLFNBQUEsR0FDQSxFQUFBLGVBQUEsSUFHQSxFQUFBLFNBQUEsZ0NBQUEsU0FBQSxHQUNBLEVBQUEsR0FBQSxFQUNBLEVBQUEsUUFBQSxPQ2pCQSxRQUFBLE9BQUEsWUFBQSx1QkFBQSxVQUFBLG1DQUFBLHdDQUFBLFNBQUEsR0FDQSxPQUNBLFNBQUEsSUFDQSxZQUFBLG1GQUNBLEtBQUEsTUFFQSxRQUFBLHlDQUFBLGlCQUFBLFNBQUEsR0FFQSxHQUFBLE1BQ0EsRUFBQSxFQUFBLFdBQUEsUUFNQSxPQUpBLFNBQUEsUUFBQSxFQUFBLFNBQUEsRUFBQSxHQUNBLEVBQUEsTUFBQSxNQUFBLEVBQUEsS0FBQSxNQUdBLFNBQUEsRUFBQSxFQUFBLEdBRUEsRUFBQSxlQUFBLEVBRUEsRUFBQSxNQUFBLFdBQUEsRUFBQSxNQUFBLGVBQ0EsRUFBQSxNQUFBLFdBQUEsU0FBQSxFQUFBLE1BQUEsV0FBQSxhQUVBLEVBQUEsUUFDQSxVQUFBLEVBQ0EsV0FBQSxFQUNBLFdBQUEsRUFDQSxTQUFBLEdBR0EsRUFBQSxPQUFBLEVBQUEsZ0NBQUEsU0FBQSxHQUNBLEVBQUEsT0FBQSxRQUFBLE9BQUEsRUFBQSxPQUFBLFNDOUJBLFFBQUEsT0FBQSxZQUFBLHVCQUFBLFVBQUEsdUJBQUEsV0FFQSxPQUNBLFNBQUEsV0FDQSxLQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsR0FLQSxRQUFBLEdBQUEsR0FDQSxRQUFBLElBQUEsRUFDQSxLQUNBLEdBQUEsUUFBQSxHQUNBLE1BQUEsR0FFQSxXQURBLEdBQUEsYUFBQSxXQUFBLEdBS0EsTUFEQSxHQUFBLGFBQUEsV0FBQSxHQUNBLEVBZEEsR0FBQSxHQUFBLEVBQUEsRUFFQSxHQUFBLFNBQUEsS0FBQSxHQUNBLFFBQUEsSUFBQSxXQ1JBLFFBQUEsT0FBQSxZQUFBLHVCQUFBLFVBQUEseUJBQUEsOEJBQUEsU0FBQSxHQUVBLE9BQ0EsU0FBQSxLQUNBLFlBQUEsMkZBQ0EsWUFBQSxFQUNBLE9BQUEsRUFDQSxLQUFBLE1BR0EsUUFBQSw4QkFBQSxXQUNBLE1BQUEsVUFBQSxFQUFBLEVBQUEsR0FFQSxFQUFBLFNBQUEsd0JBQUEsU0FBQSxHQUNBLEVBQUEsVUFBQSxJQUdBLEVBQUEsU0FBQSw2QkFBQSxTQUFBLEdBQ0EsSUFDQSxFQUFBLFdBQUEsUUNBQSxRQUFBLE9BQUEsWUFBQSx1QkFBQSxVQUFBLDhCQUFBLG1DQUFBLFNBQUEsR0FFQSxPQUNBLFNBQUEsU0FDQSxZQUFBLHdGQUNBLFlBQUEsRUFDQSxLQUFBLE1BR0EsUUFBQSxvQ0FBQSxTQUFBLFdBRUEsTUFBQSxVQUFBLEVBQUEsRUFBQSxFQUFBLEdBRUEsRUFBQSxNQUFBLENBQ0EsSUFDQSxHQURBLEVBQUEsRUFBQSxFQUdBLEdBQUEsT0FBQSxpQkFBQSxTQUFBLEdBRUEsR0FBQSxFQUFBLENBRUEsR0FBQSxHQUFBLEVBQUEsVUFFQSxLQUNBLEVBQUEsRUFBQSxZQUdBLEVBQUEsTUFBQSxFQUNBLEVBQUEsTUFBQSxVQUFBLE1BRUEsR0FBQSxNQUFBLEVBQ0EsRUFBQSxJQUlBLEVBQUEsT0FBQSxXQUFBLE1BQUEsR0FBQSxZQUFBLFNBQUEsR0FDQSxHQUFBLElBQ0EsRUFBQSxjQUFBLEdBQ0EsRUFBQSxVQUNBLEVBQUEsY0FJQSxVQUFBLHNCQUFBLFdBQ0EsT0FDQSxTQUFBLFdBQ0EsS0FBQSxTQUFBLEVBQUEsRUFBQSxHQUVBLEdBQUEsR0FBQSxFQUFBLE1BQUEsRUFBQSxRQUVBLEdBQUEsT0FBQSxFQUFBLFFBQUEsU0FBQSxHQUNBLEdBQUEsSUFDQSxFQUFBLE1BQUEsVUFBQSxFQUNBLEVBQUEsU0N4RUEsUUFBQSxPQUFBLFlBQUEsdUJBQUEsVUFBQSwrQkFBQSxvQ0FBQSxTQUFBLEdBQ0EsT0FDQSxTQUFBLEtBQ0EsWUFBQSxtRkFDQSxLQUFBLE1BRUEsUUFBQSxvQ0FBQSxXQUNBLE1BQUEsVUFBQSxFQUFBLEVBQUEsR0FFQSxFQUFBLFFBQ0EsV0FBQSxFQUNBLGFBQUEsRUFDQSxhQUFBLEVBQ0EsU0FBQSxFQUNBLE9BQUEsR0FHQSxFQUFBLE9BQUEsRUFBQSw0QkFBQSxTQUFBLEdBQ0EsRUFBQSxPQUFBLFFBQUEsT0FBQSxFQUFBLE9BQUEsUUNsQkEsUUFBQSxPQUFBLFlBQUEsdUJBQUEsVUFBQSxnQ0FBQSxxQ0FBQSxTQUFBLEdBQ0EsT0FDQSxPQUFBLEVBQ0EsV0FBQSx3REFDQSxZQUFBLDZFQUNBLEtBQUEsTUFFQSxRQUFBLHFDQUFBLFdBQ0EsTUFBQSxVQUFBLEVBQUEsRUFBQSxHQUVBLEVBQUEsVUFBQSxFQUVBLEVBQUEsU0FBQSwrQkFBQSxTQUFBLEdBQ0EsYUFBQSxJQUNBLEVBQUEsVUFBQSxRQ2RBLFFBQUEsT0FBQSxZQUFBLHVCQUFBLFdBQUEsMENBQUEsU0FBQSxTQUFBLEdBcUJBLFFBQUEsR0FBQSxFQUFBLEdBTUEsSUFBQSxJQUNBLEVBQUEsVUFDQSxFQUFBLE1BQUEsTUFBQSxHQUFBLEVBQUEsTUFBQSxNQUFBLFNBQ0EsR0FBQSxNQUFBLE1BQUEsSUFFQSxJQUFBLEVBQUEsTUFBQSxRQUNBLEVBQUEsTUFBQSxNQUFBLElBL0JBLEdBQ0EsR0FBQSxDQU1BLEdBQUEsaUJBQUEsZ0JBQUEsU0FBQSxHQUNBLEdBQ0EsUUFBQSxRQUFBLEVBQUEsU0FBQSxHQUNBLEVBQUEsaUJBQ0EsRUFBQSxlQUFBLEVBQUEsT0FBQSxXQUNBLE1BQUEsR0FBQSxPQUNBLFFBd0JBLEtBQUEsVUFBQSxXQUVBLEVBQUEsTUFBQSxVQUNBLEVBQUEsTUFBQSxXQUdBLElBQUEsSUFDQSxNQUFBLFVBQUEsSUFHQSxHQUFBLE1BQUEsUUFBQSxLQUFBLEVBRUEsSUFBQSxHQUFBLEVBQUEsTUFBQSxRQUFBLE1BRUEsR0FBQSxVQUFBLElBQUEsSUFDQSxFQUFBLE1BQUEsTUFBQSxFQUFBLFFBS0EsS0FBQSxhQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsRUFBQSxNQUFBLFFBQUEsT0FBQSxFQUFBLEVBRUEsSUFBQSxHQUFBLEVBQUEsT0FBQSxDQUVBLEdBQUEsR0FBQSxFQUFBLEVBRUEsR0FBQSxTQUVBLFNBQUEsRUFBQSxNQUFBLE1BQUEsRUFBQSxjQUNBLEdBQUEsTUFBQSxNQUFBLEVBQUEsUUFJQSxFQUFBLFFBQUEsRUFBQSxNQUFBLE9BQUEsRUFBQSxNQUFBLFFBQUEsU0FDQSxFQUFBLE1BQUEsTUFBQSxFQUFBLE1BQUEsUUFBQSxHQUFBLE9BR0EsRUFBQSx1QkM3RUEsUUFBQSxPQUFBLFlBQUEsdUJBQUEsVUFBQSxxQ0FBQSxnQkFBQSxTQUFBLEdBQ0EsT0FDQSxZQUFBLHdFQUNBLFNBQUEsRUFDQSxPQUNBLE1BQUEsc0NBRUEsS0FBQSxTQUFBLEdBRUEsRUFBQSxPQUFBLCtCQUFBLFNBQUEsR0FDQSxFQUFBLE1BQUEsVUFBQSxJQUdBLEVBQUEsV0FBQSxFQUFBLGNBQUEsRUFBQSxZQ2JBLFFBQUEsT0FBQSxZQUFBLHVCQUFBLFVBQUEsZ0NBQUEsV0FDQSxPQUNBLFlBQUEsbUVBQ0EsUUFBQSx1QkFDQSxPQUNBLFNBQUEsTUFFQSxXQUFBLDZDQ1BBLFFBQUEsT0FBQSxZQUFBLHVCQUFBLFdBQUEsMkNBQUEsU0FBQSxpQkFBQSxTQUFBLEVBQUEsR0FFQSxFQUFBLFdBQUEsRUFBQSxPQUFBLFdBRUEsRUFBQSxZQUFBLFNBQUEsRUFBQSxHQUNBLEVBQUEsYUFBQSxFQUNBLEVBQUEsU0FBQSxNQ05BLFFBQUEsT0FBQSxZQUFBLHVCQUFBLFVBQUEsMEJBQUEsV0FFQSxPQUNBLFNBQUEsRUFDQSxZQUFBLDJEQ0pBLFFBQUEsT0FBQSxZQUFBLHVCQUFBLFVBQUEsa0JBQUEsdUJBQUEsU0FBQSxHQUVBLE9BQ0EsU0FBQSxrQkFDQSxXQUFBLDJCQUNBLEtBQUEsTUFHQSxRQUFBLHdCQUFBLFNBQUEsU0FBQSxHQUNBLE1BQUEsVUFBQSxFQUFBLEVBQUEsRUFBQSxHQUNBLEdBQUEsR0FBQSxFQUFBLEdBRUEsRUFBQSxFQUFBLEVBQUEsZ0JBQ0EsRUFBQSxFQUFBLE9BRUEsRUFBQSxFQUFBLEVBRUEsR0FBQSxNQUFBLEdBRUEsRUFBQSxPQUFBLFdBQ0EsTUFBQSxHQUFBLFNBQ0EsU0FBQSxHQUNBLEVBQUEsRUFBQSxTQ3RCQSxRQUFBLE9BQUEsWUFBQSx1QkFBQSxXQUFBLDRCQUFBLFNBQUEsZ0JBQUEsU0FBQSxFQUFBLEdBRUEsR0FBQSxFQUVBLE1BQUEsTUFBQSxTQUFBLEdBU0EsTUFSQSxVQUFBLElBQ0EsRUFBQSxFQUVBLFFBQUEsUUFBQSxFQUFBLFVBQ0EsRUFBQSxZQUlBLEdBR0EsS0FBQSxTQUFBLFNBQUEsRUFBQSxHQUVBLEdBQUEsR0FBQSxFQUFBLFVBQUEsRUFFQSxHQUFBLFNBQUEsRUFBQSxFQUFBLE9BQUEsT0FBQSxFQUNBLEVBQUEsT0FBQSxPQUFBLEVBQUEsRUFBQSxJQUlBLEtBQUEsWUFBQSxTQUFBLEdBQ0EsRUFBQSxPQUFBLE9BQUEsRUFBQSxJQUdBLEtBQUEsV0FBQSxTQUFBLEVBQUEsR0FDQSxJQUFBLEdBQUEsSUFBQSxHQUFBLEdBQUEsRUFBQSxPQUFBLFFBQUEsR0FBQSxFQUFBLE9BQUEsU0FJQSxFQUFBLE9BQUEsR0FBQSxFQUFBLE9BQUEsT0FBQSxFQUFBLEVBQUEsRUFBQSxPQUFBLElBQUEsS0FHQSxLQUFBLFVBQUEsU0FBQSxFQUFBLEdBQ0EsR0FBQSxHQUFBLEdBQUEsR0FBQSxFQUFBLE9BQUEsUUFBQSxJQUFBLEVBQUEsQ0FDQSxHQUFBLEdBQUEsRUFBQSxPQUFBLE9BQUEsRUFBQSxHQUFBLEVBQ0EsR0FBQSxLQUFBLEVBQ0EsRUFBQSxPQUFBLE9BQUEsRUFBQSxFQUFBLFFDekNBLFFBQUEsT0FBQSxZQUFBLHVCQUFBLFVBQUEscUJBQUEsV0FFQSxPQUNBLFNBQUEsaUJBQ0EsU0FBQSxLQUNBLFlBQUEsNkRBQ0EsU0FDQSxLQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsR0FFQSxHQUFBLEdBQUEsRUFBQSxFQUVBLEdBQUEsT0FBQSxXQUNBLE1BQUEsR0FBQSxPQUNBLFNBQUEsR0FDQSxFQUFBLEtBQUEsUUNkQSxRQUFBLE9BQUEsWUFBQSx1QkFBQSxVQUFBLHNCQUFBLDJCQUFBLFNBQUEsR0FDQSxPQUNBLFNBQUEsaUJBQUEsV0FDQSxLQUFBLE1BRUEsUUFBQSwyQkFBQSxXQUNBLE1BQUEsVUFBQSxFQUFBLEVBQUEsRUFBQSxHQUVBLEdBQUEsR0FBQSxFQUFBLEdBQ0EsRUFBQSxFQUFBLEVBRUEsR0FBQSxjQUFBLE1DWEEsUUFBQSxPQUFBLFlBQUEsdUJBQUEsVUFBQSxzQkFBQSxTQUFBLFNBQUEsR0FDQSxPQUNBLFNBQUEsa0JBQ0EsS0FBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEdBRUEsR0FBQSxHQUFBLEVBQUEsR0FNQSxFQUFBLEVBQUEsR0FFQSxFQUFBLEVBQUEsRUFBQSxvQkFDQSxFQUFBLEVBQUEsTUFFQSxHQUFBLE9BQUEsRUFBQSxTQUFBLEdBRUEsR0FBQSxFQUFBLENBQ0EsR0FBQSxJQUNBLEVBQUEscUJBQ0EsRUFBQSxHQUFBLEdBRUEsRUFBQSxVQUNBLE1BSUEsR0FBQSxZQUVBLEtBQUEsRUFBQSxVQUVBLEVBQUEsY0NoQ0EsUUFBQSxPQUFBLFlBQUEsdUJBQUEsVUFBQSxpQkFBQSxzQkFBQSxTQUFBLEdBRUEsT0FDQSxTQUFBLGlCQUFBLGlCQUNBLFNBQUEsRUFDQSxZQUFBLGlEQUNBLE9BQ0EsWUFBQSxpQkFDQSxTQUFBLHFCQUNBLFNBQUEscUJBRUEsb0JBQUEsZ0NBRUEsV0FBQSwwQkFDQSxLQUFBLE1BR0EsUUFBQSx1QkFBQSxnQkFBQSxTQUFBLEdBQ0EsTUFBQSxVQUFBLEVBQUEsRUFBQSxFQUFBLEdBRUEsR0FBQSxHQUFBLEVBQUEsR0FDQSxFQUFBLEVBQUEsRUFFQSxVQUFBLEVBQUEsV0FDQSxFQUFBLFNBQUEsUUFHQSxFQUFBLFdBQUEsRUFBQSxjQUFBLEVBQUEsYUFFQSxFQUFBLEtBQUEsRUFBQSxFQUFBLFlBQUEsRUFBQSxjQzdCQSxRQUFBLE9BQUEsWUFBQSx1QkFBQSxXQUFBLDJCQUFBLFNBQUEsZ0JBQUEsU0FBQSxFQUFBLEdBRUEsR0FDQSxHQUFBLEVBREEsRUFBQSxJQUdBLE1BQUEsS0FBQSxTQUFBLEVBQUEsRUFBQSxHQUVBLEVBQUEsU0FBQSxHQUNBLEVBQUEsVUFBQSxHQUNBLEVBQUEsZ0JBQUEsRUFBQSxHQUVBLEVBQUEsS0FBQSxFQUNBLEVBQUEsTUFBQSxHQUlBLEtBQUEsU0FBQSxTQUFBLEdBR0EsTUFGQSxHQUFBLEVBQUEsRUFBQSxVQUtBLEtBQUEsVUFBQSxTQUFBLEdBV0EsTUFUQSxJQUNBLEtBQUEsS0FBQSxFQUFBLFlBQ0EsT0FBQSxHQUdBLEVBQUEsT0FBQSxvQkFBQSxTQUFBLEdBQ0EsRUFBQSxjQUFBLEtBR0EsR0FHQSxLQUFBLGdCQUFBLFNBQUEsRUFBQSxHQUVBLEdBQUEsR0FBQSxFQUFBLElBc0JBLE9BcEJBLEdBQUEsS0FBQSxFQUFBLFNBRUEsR0FFQSxFQUFBLE9BQUEscUJBQUEsU0FBQSxHQUNBLEVBQUEsS0FBQSxFQUFBLE1BQUEsSUFHQSxFQUFBLE9BQUEsb0JBQUEsU0FBQSxFQUFBLEdBQ0EsR0FBQSxJQUFBLEVBQUEsQ0FDQSxHQUFBLEdBQUEsRUFBQSxLQUFBLFNBQ0EsR0FBQSxLQUFBLEdBQ0EsRUFBQSxLQUFBLEdBQUEsTUFJQSxFQUFBLE1BQUEsU0FBQSxFQUFBLEtBQUEsSUFBQSxTQUFBLEVBQUEsUUFDQSxFQUFBLEtBQUEsR0FBQSxFQUFBLE9BR0EsRUFBQSxNQUdBLEtBQUEsY0FBQSxTQUFBLEdBRUEsRUFBQSxNQUFBLEVBQ0EsRUFBQSxjQUFBLEVBQUEsT0FBQSxPQUdBLEtBQUEsY0FBQSxTQUFBLEdBSUEsRUFBQSxPQUFBLEVBQUEsUUFDQSxFQUFBLE1BQUEsZUFBQSxFQUFBLE9BQ0EsRUFBQSxNQUFBLE1BQUEsRUFDQSxFQUFBLE1BQUEsWUFBQSxFQUFBLFFBR0EsRUFBQSxLQUFBLEdBSUEsS0FBQSxNQUFBLFdBQ0EsTUFBQSxJQUdBLEtBQUEsS0FBQSxXQUNBLE1BQUEsT0N4RkEsUUFBQSxPQUFBLFlBQUEsdUJBQUEsVUFBQSxzQkFBQSxXQUNBLE9BQ0EsU0FBQSxtQkFDQSxZQUFBLHFEQUNBLFdBQUEsZ0NBQ0EsS0FBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEdBQ0EsRUFBQSxXQUFBLEVBQUEsT0NOQSxRQUFBLE9BQUEsWUFBQSx1QkFBQSxXQUFBLGlDQUFBLFNBQUEsaUJBQUEsU0FBQSxFQUFBLEdBRUEsRUFBQSxVQUFBLFFBQUEsS0FBQSxFQUFBLE9BQUEsVUFJQSxHQUFBLGVBQUEsU0FBQSxHQUNBLE9BQUEsRUFBQSxrQkFBQSxFQUFBLGlCQUFBLEVBQUEsVUNQQSxRQUFBLE9BQUEsWUFBQSx1QkFBQSxVQUFBLDJCQUFBLGlCQUFBLFNBQUEsR0FFQSxPQUNBLFFBQUEsZ0JBQ0EsWUFBQSwrREFDQSxLQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsR0FFQSxFQUFBLGlCQUFBLEVBQUEsZ0JBRUEsRUFBQSxjQUFBLFdBQ0EsRUFBQSxPQUFBLFdBQ0EsRUFBQSxpQkFJQSxFQUFBLFdBQUEsV0FDQSxFQUFBLE9BQUEsV0FDQSxFQUFBLFFBQUEsT0FBQSxFQUFBLFVBSUEsRUFBQSxhQUFBLFdBQ0EsRUFBQSxVQUFBLE9BQUEsRUFBQSxlQ3RCQSxRQUFBLE9BQUEsWUFBQSx1QkFBQSxVQUFBLHFCQUFBLFdBRUEsT0FDQSxTQUFBLGdCQUFBLG1CQUNBLFlBQUEsbURBQ0EsV0FBQSw2Q0FDQSxLQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsR0FDQSxFQUFBLFNBQUEsRUFBQSxHQUNBLEVBQUEsV0FBQSxFQUFBLE9DUkEsUUFBQSxPQUFBLFlBQUEsdUJBQUEsV0FBQSxnQ0FBQSxTQUFBLFVBQUEsV0FBQSxnQkFBQSxTQUFBLEVBQUEsRUFBQSxHQUVBLEVBQUEsaUJBQ0EsU0FBQSxFQUNBLE1BQUEsR0FPQSxLQUFBLFVBQUEsV0FDQSxFQUFBLGdCQUFBLFNBQUEsRUFDQSxFQUFBLGdCQUFBLE1BQUEsRUFBQSxPQUFBLE9BQUEsUUFHQSxLQUFBLFVBQUEsV0FDQSxFQUFBLGdCQUFBLFNBQUEsR0FHQSxLQUFBLHFCQUFBLFNBQUEsRUFBQSxHQVFBLE1BSkEsR0FBQSxXQUNBLEVBQUEsY0FBQSxHQUNBLElBRUEsT0FBQSxTQUFBLE1BQUEsRUFBQSxNQUFBLElBR0EsS0FBQSxtQkFBQSxTQUFBLEdBSUEsRUFBQSxXQUNBLEVBQUEsY0FBQSxHQUNBLEtBR0EsS0FBQSxLQUFBLFdBRUEsR0FBQSxHQUFBLEVBQUEsVUFFQSxLQUFBLElBQUEsRUFBQSxLQWtCQSxLQUFBLE9BQUEsb0JBaEJBLEVBQUEsR0FBQSxHQUFBLEVBQUEsS0FBQSxNQUNBLEVBQUEsRUFBQSxLQUFBLE9BQ0EsRUFBQSxFQUFBLEtBQUEsS0FDQSxHQUFBLE9BQUEsT0FFQSxXQUFBLEVBQ0EsRUFBQSxXQUFBLFNBQUEsRUFBQSxFQUFBLGdCQUFBLE9BQ0EsVUFBQSxHQUNBLEVBQUEsV0FBQSxVQUFBLEVBQUEsRUFBQSxnQkFBQSxPQU1BLEVBQUEsY0FBQSxNQzVEQSxRQUFBLE9BQUEsWUFBQSx1QkFBQSxVQUFBLG9CQUFBLHlCQUFBLFNBQUEsR0FDQSxPQUNBLFNBQUEsbUJBQUEsaUJBQ0EsU0FBQSxLQUNBLE9BQUEsRUFDQSxZQUFBLEVBQ0EsV0FBQSw2QkFDQSxZQUFBLHNEQUNBLEtBQUEsTUFFQSxRQUFBLHlCQUFBLFdBQ0EsTUFBQSxVQUFBLEVBQUEsRUFBQSxFQUFBLEdBRUEsR0FBQSxHQUFBLEVBQUEsR0FDQSxFQUFBLEVBQUEsRUFLQSxHQUFBLFdBQUEsRUFFQSxFQUFBLFNBQUEsbUJBQUEsU0FBQSxHQUNBLEVBQUEsTUFBQSxJQUdBLEVBQUEsUUFBQSxNQ3pCQSxRQUFBLE9BQUEsWUFBQSx1QkFBQSxXQUFBLDhCQUFBLFNBQUEsZUNBQSxRQUFBLE9BQUEsWUFBQSx1QkFBQSxVQUFBLGVBQUEsV0FDQSxPQUNBLFNBQUEsZ0JBQ0EsU0FBQSxLQUNBLFlBQUEsRUFDQSxXQUFBLHlCQUNBLFlBQUEsaURBQ0EsS0FBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEdBS0EsRUFBQSxVQUFBLEVBQUEsT0NaQSxRQUFBLE9BQUEsWUFBQSx1QkFBQSxXQUFBLDBCQUFBLFNBQUEsV0FFQSxHQUFBLEdBQUEsSUFDQSxNQUFBLFNBRUEsS0FBQSxRQUFBLFNBQUEsR0FDQSxFQUFBLE1BQUEsS0FBQSxHQUVBLElBQUEsRUFBQSxNQUFBLFFBQ0EsRUFBQSxPQUFBLElBSUEsS0FBQSxPQUFBLFNBQUEsR0FDQSxRQUFBLFFBQUEsRUFBQSxNQUFBLFNBQUEsR0FDQSxFQUFBLFFBQUEsSUFHQSxFQUFBLFFBQUEsTUNsQkEsUUFBQSxPQUFBLFlBQUEsdUJBQUEsT0FBQSxPQUFBLFdBQ0EsTUFBQSxVQUFBLEVBQUEsR0FFQSxNQUFBLEdBQ0EsS0FBQSxVQUFBLE1BQUEsS0FBQSxNQUVBLFFBQUEsT0FBQSxPQUFBLE1BRUEsVUFBQSxXQUFBLFVBQUEsVUFBQSxTQUFBLEVBQUEsR0FDQSxPQUNBLFlBQUEsdURBQ0EsU0FBQSxFQUNBLE9BQ0EsUUFBQSxJQUNBLGNBQUEseUJBRUEsS0FBQSxTQUFBLEVBQUEsRUFBQSxHQUNBLEVBQUEsV0FBQSxFQUFBLFFBRUEsRUFBQSxLQUFBLFdBQ0EsRUFBQSxPQUFBLG1DQUFBLEVBQUEsUUFBQSxFQUFBLFFBQUEsRUFBQSxzQkNwQkEsUUFBQSxPQUFBLFlBQUEsdUJBQUEsVUFBQSwwQkFBQSxXQUlBLFFBQUEsR0FBQSxFQUFBLEVBQUEsR0FFQSxHQUVBLEdBRkEsRUFBQSxFQUFBLFFBQ0EsR0FBQSxDQUdBLElBQUEsRUFJQSxJQUFBLEdBRkEsR0FBQSxFQUFBLE9BRUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxPQUFBLElBRUEsR0FEQSxFQUFBLEVBQUEsR0FDQSxJQUFBLEdBQUEsRUFBQSxPQUFBLEVBQUEsS0FBQSxDQUNBLEdBQUEsQ0FDQSxPQUtBLEVBQUEsYUFBQSxTQUFBLEdBckJBLEdBQUEsR0FBQSxDQXdCQSxRQUNBLFNBQUEsSUFDQSxTQUFBLFVBQUEsbUJBQ0EsS0FBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEdBRUEsR0FBQSxHQUFBLEVBQUEsR0FDQSxFQUFBLEVBQUEsR0FFQSxFQUFBLEVBQUEsS0FFQSxLQUFBLEVBQ0EsS0FBQSxPQUFBLDZCQUdBLEdBQUEsT0FBQSxXQUFBLE1BQUEsR0FBQSxhQUFBLGFBS0EsSUFHQSxFQUFBLE9BQUEsV0FBQSxNQUFBLElBQUEsV0FLQSxFQUFBLEVBQUEsRUFBQSxTQ3JEQSxRQUFBLE9BQUEsWUFBQSx1QkFBQSxVQUFBLDZCQUFBLGtDQUFBLFNBQUEsR0FFQSxPQUNBLFNBQUEsa0JBQUEsVUFDQSxZQUFBLG1EQUNBLE9BQ0EsVUFBQSw4QkFDQSxtQkFBQSxnQ0FFQSxLQUFBLE1BRUEsUUFBQSxtQ0FBQSxpQkFBQSxTQUFBLEdBRUEsTUFBQSxVQUFBLEVBQUEsRUFBQSxFQUFBLEdBRUEsR0FBQSxHQUFBLEVBQUEsR0FDQSxFQUFBLEVBQUEsRUFFQSxJQUVBLEVBQUEsTUFBQSxFQUFBLFFBQ0EsRUFBQSxLQUFBLEVBQUEsUUFFQSxJQUVBLEVBQUEsTUFDQSxNQUFBLEdBR0EsRUFBQSxPQUFBLFlBQUEsU0FBQSxHQUNBLEVBQUEsT0FDQSxLQUFBLEVBQ0EsTUFBQSxFQUFBLE9BUUEsRUFBQSxvQkFDQSxRQUFBLFFBQUEsRUFBQSxtQkFBQSxTQUFBLEVBQUEsR0FDQSxTQUNBLEdBQUEsbUJBQUEsS0FLQSxFQUFBLFNBQUEsUUFBQSxVQUFBLEVBQUEsV0FBQSxTQUFBLEVBQUEsd0JDaERBLFFBQUEsT0FBQSxZQUFBLHVCQUFBLFVBQUEsZ0JBQUEsd0JBQUEsU0FBQSxHQUNBLE9BQ0EsU0FBQSxLQUNBLFNBQUEsU0FBQSxlQUFBLG1CQUNBLFdBQUEseUJBQ0EsT0FBQSxFQUNBLFFBQUEsTUFFQSxRQUFBLHFCQUFBLFdBQ0EsTUFBQSxVQUFBLEVBQUEsRUFBQSxFQUFBLEdBRUEsR0FBQSxHQUFBLEVBQUEsR0FDQSxFQUFBLEVBQUEsR0FDQSxFQUFBLEVBQUEsR0FFQSxFQUFBLFNBQUEsRUFBQSxnQkFFQSxHQUFBLEtBQUEsRUFBQSxpQkFBQSxFQUFBLEVBQUEsTUFHQSxRQUFBLHlCQUFBLHFCQUFBLFNBQUEsR0FDQSxNQUFBLFVBQUEsRUFBQSxHQUVBLEdBQUEsR0FBQSxFQUFBLGdCQUVBLElBQUEsU0FBQSxFQUFBLENBQ0EsR0FBQSxHQUFBLGtDQUNBLEdBQUEsT0FBQSxHQUdBLE1BQUEsT0M5QkEsUUFBQSxPQUFBLFlBQUEsdUJBQUEsV0FBQSwwQkFBQSxTQUFBLFNBQUEsU0FBQSxFQUFBLEdBRUEsS0FBQSxRQUNBLElBQUEsR0FBQSxJQUVBLE1BQUEsS0FBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEdBR0EsRUFBQSxTQUFBLENBRUEsSUFBQSxHQUFBLEVBQUEsR0FDQSxFQUFBLEVBQUEsTUEyQkEsT0F6QkEsR0FBQSxPQUFBLEVBQUEsU0FBQSxHQUNBLFNBQUEsSUFDQSxLQUVBLEdBQ0EsRUFBQSxFQUFBLElBSUEsRUFBQSxNQUFBLEtBQUEsSUFHQSxFQUFBLE9BQUEsV0FDQSxNQUFBLEdBQUEsU0FDQSxTQUFBLEdBQ0EsU0FBQSxFQUNBLEVBQUEsVUFFQSxFQUFBLE1BQUEsT0FBQSxJQUlBLEVBQUEsTUFBQSxNQUFBLEVBR0EsRUFBQSxPQUdBLEtBQUEsbUJBQUEsV0FDQSxRQUFBLFFBQUEsRUFBQSxNQUFBLE9BQUEsT0FBQSxTQUFBLEdBQ0EsRUFBQSxPQUFBLFFDM0NBLFFBQUEsT0FBQSxZQUFBLHVCQUFBLFVBQUEsZUFBQSxXQUNBLE9BQ0EsU0FBQSxJQUNBLFFBQUEsaUJBQ0EsU0FBQSxLQUNBLE9BRUEsT0FBQSxtQkFFQSxlQUFBLDJCQUVBLE9BQUEsa0JBRUEsU0FBQSxvQkFFQSxRQUFBLHFCQUVBLFNBQUEsRUFDQSxXQUFBLHFDQUNBLFlBQUEsMENBQ0EsS0FBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEdBRUEsU0FBQSxFQUFBLFNBQ0EsRUFBQSxXQUdBLFNBQUEsRUFBQSxpQkFDQSxFQUFBLGdCQUFBLEdBR0EsU0FBQSxFQUFBLFVBQ0EsRUFBQSxTQUFBLEdBR0EsRUFBQSxNQUFBLEVBQUEsUUFDQSxFQUFBLFdBQUEsTUNuQ0EsUUFBQSxPQUFBLFlBQUEsdUJBQUEsV0FBQSwwQkFBQSxTQUFBLGdCQUFBLFlBQUEsU0FBQSxFQUFBLEVBQUEsR0FFQSxHQUFBLEdBQUEsSUFFQSxHQUFBLFFBQUEsRUFBQSxTQUFBLFFBRUEsS0FBQSxZQUFBLFNBQUEsR0FDQSxFQUFBLFNBQUEsR0FHQSxLQUFBLGNBQUEsV0FDQSxFQUFBLFNBQUEsRUFBQSxTQUdBLEVBQUEsT0FBQSxXQUVBLEdBQUEsR0FBQSxFQUFBLFdBQUEsT0FJQSxJQUFBLElBQ0EsRUFBQSxVQUFBLEVBQUEsU0FBQSxFQUFBLFNBQUEsVUFBQSxHQUVBLEVBQUEsV0FBQSxDQUVBLEdBQUEsR0FBQSxFQUFBLE1BRUEsSUFBQSxFQUlBLElBRkEsR0FBQSxHQUFBLEVBQUEsU0FFQSxHQUFBLElBQUEsRUFBQSxXQUNBLEVBQUEsVUFBQSxFQUFBLEdBQUEsZ0JDaENBLFFBQUEsT0FBQSxTQUFBLFFBQUEsV0FBQSxVQUFBLGFBQUEsU0FBQSxHQUVBLEdBQUEsR0FBQSxJQUdBLFFBQ0EsU0FBQSxTQUFBLEdBQ0EsTUFBQSxJQUFBLEVBQUEsY0FBQSxFQUFBLGNBQUEsR0FBQSxFQUFBLE9BRUEsVUFBQSxTQUFBLEdBVUEsTUFQQSxHQUFBLGNBQUEsRUFDQSxFQUFBLFNBQUEsRUFHQSxFQUFBLGlCQUFBLEVBQUEsa0JBQ0EsRUFBQSxnQkFBQSxFQUFBLGtCQUVBLEdBRUEsU0FBQSxTQUFBLEdBQ0EsTUFBQSxVQUFBLEVBQ0EsT0FFQSxFQUFBLElBRUEsY0FBQSxTQUFBLEdBQ0EsR0FBQSxLQUVBLE9BREEsR0FBQSxNQUFBLGVBQUEsR0FDQSxFQUFBLE1BRUEsWUFBQSxTQUFBLEdBQ0EsR0FBQSxHQUFBLEtBQUEsY0FBQSxHQUNBLEVBQUEsRUFBQSxFQUFBLEtBQUEsRUFFQSxPQUFBLEtBQUEsT0NwQ0EsUUFBQSxPQUFBLE1BQUEsVUFBQSxlQUFBLFVBQUEsYUFBQSxTQUFBLEVBQUEsR0FFQSxRQUFBLEdBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxHQUNBLEVBQUEsT0FBQSxXQUNBLEdBQUEsR0FBQSxFQUFBLE1BQUEsR0FFQSxHQUNBLEtBQUEsRUFDQSxLQUFBLEVBR0EsR0FBQSxHQUVBLEVBQUEsV0FBQSxFQUFBLEtBSUEsT0FDQSxTQUFBLE1BQ0EsS0FBQSxTQUFBLEVBQUEsRUFBQSxHQUVBLEdBQUEsR0FBQSxFQUFBLGFBQUEsRUFBQSxrQkFBQSxHQUNBLEdBQUEsQ0FFQSxHQUFBLE9BQUEsRUFBQSxlQUFBLFNBQUEsR0FDQSxFQUFBLEVBQ0EsRUFBQSxLQUFBLFlBQUEsRUFBQSxRQUFBLFVBR0EsRUFBQSxHQUFBLGNBQUEsU0FBQSxHQUlBLE9BQUEsR0FBQSxLQUFBLFVBQ0EsS0FBQSxXQUNBLEVBQUEsRUFBQSxTQUFBLEdBQ0EsRUFBQSxVQUFBLElBSEEsU0FLQSxHQUFBLFlBQUEsU0FBQSxHQUlBLEdBRkEsRUFBQSxFQUFBLFNBQUEsR0FFQSxFQUNBLE1BQUEsR0FBQSxVQUFBLEVBR0EsSUFBQSxHQUFBLEVBQUEsWUFDQSxHQUFBLGNBQUEsTUFDQSxFQUFBLFFBQUEsT0FBQSxzQkFFQSxFQUFBLGNBQUEsRUFBQSxFQUFBLEVBQUEsWUFBQSxTQUFBLEdBQ0EsRUFBQSxTQUFBLE9BR0EsR0FBQSxVQUFBLFdBRUEsRUFBQSxZQUFBLEVBQUEsRUFBQSxFQUFBLFVBQUEsV0FDQSxFQUFBLFNBQUEsZUN6REEsUUFBQSxPQUFBLE1BQUEsVUFBQSxlQUFBLGNBQUEsU0FBQSxHQUNBLE9BQ0EsS0FBQSxNQUVBLFVBQUEsZUFBQSxjQUFBLFNBQUEsR0FDQSxPQUNBLEtBQUEsTUFFQSxVQUFBLGNBQUEsY0FBQSxTQUFBLEdBQ0EsT0FDQSxLQUFBLE1BRUEsVUFBQSxVQUFBLGNBQUEsU0FBQSxHQUNBLE9BQ0EsS0FBQSxNQUVBLFFBQUEsZUFBQSxVQUFBLFlBQUEsU0FBQSxFQUFBLEdBSUEsTUFBQSxVQUFBLEVBQUEsRUFBQSxHQWNBLFFBQUEsR0FBQSxHQUNBLEdBQUEsR0FBQSxFQUFBLFNBQUEsR0FJQSxFQUFBLEVBQUEsUUFBQSxFQUFBLE1BMkJBLE9BekJBLEtBQUEsSUFJQSxFQUFBLFNBQUEsSUFJQSxHQUFBLElBTUEsRUFBQSxJQUFBLFdBQUEsR0FLQSxHQUFBLEVBRUEsRUFBQSxhQUFBLFdBQUEsRUFJQSxFQUFBLFVBQUEsR0FHQSxRQUFBLEdBQUEsR0FDQSxHQUFBLENBQ0EsSUFBQSxHQUFBLEVBQUEsV0FDQSxLQUNBLEVBQ0EsRUFBQSxPQUFBLFdBQ0EsRUFBQSxNQUFBLEtBR0EsRUFBQSxNQUFBLElBdERBLEdBQUEsRUFBQSxLQUFBLGtCQUFBLEVBQUEsQ0FFQSxHQUFBLElBQUEsRUFDQSxHQUFBLEVBQ0EsRUFBQSxFQUFBLEdBQ0EsRUFBQSxPQUNBLEdBQUEsRUFFQSxFQUFBLEVBQUEsS0FBQSxPQW1EQSxHQUFBLElBQUEsV0FBQSxXQUVBLEVBQUEsSUFBQSxXQUFBLEtBR0EsRUFBQSxJQUFBLGNBQUEsV0FFQSxFQUFBLEVBQUEsWUFBQSxLQUdBLEVBQUEsSUFBQSxZQUFBLFdBQ0EsR0FFQSxHQUFBLEtBSUEsRUFBQSxHQUFBLFlBQUEsV0FDQSxHQUFBLEdBQUEsS0FBQSxFQUFBLENBQ0EsR0FBQSxDQUNBLElBQUEsR0FBQSxFQUFBLFdBQ0EsSUFDQSxFQUFBLE9BQUEsV0FDQSxFQUFBLE1BQUEsUUFNQSxFQUFBLEdBQUEsWUFBQSxXQUNBLEdBQUEsS0FBQSxJQVFBLEdBQUEsRUFDQSxFQUFBLEdBQUEsV0FBQSxNQUtBLEVBQUEsR0FBQSxXQUFBLFNBQUEsR0FFQSxHQUFBLEVBQUEsQ0FFQSxHQUdBLEdBSEEsRUFBQSxFQUFBLFNBQUEsR0FFQSxFQUFBLEVBQUEsVUFhQSxJQVZBLEdBQ0EsRUFBQSxPQUFBLFdBQ0EsRUFBQSxFQUFBLE1BQUEsS0FNQSxFQUFBLEtBQUEsRUFBQSxPQUFBLFFBRUEsRUFPQSxNQURBLEdBQUEsYUFBQSxXQUFBLEVBQ0EsRUFBQSxVQUFBLE1BTUEsRUFBQSxHQUFBLE9BQUEsU0FBQSxHQUVBLEVBQUEsU0FBQSxFQUVBLElBQUEsRUFBQSxDQUNBLEdBQUEsR0FBQSxFQUFBLE1BRUEsSUFDQSxFQUFBLE9BQUEsR0FJQSxNQUFBLEdBQUEsVUFBQSxLQUtBLEVBQUEsS0FBQSxlQUFBLFFDaExBLFFBQUEsT0FBQSxNQUFBLFVBQUEsY0FBQSxVQUFBLFdBRUEsUUFBQSxHQUFBLEVBQUEsRUFBQSxFQUFBLEdBQ0EsR0FBQSxHQUFBLEVBQUEsT0FBQSxHQUNBLEVBQUEsTUFBQSxHQUlBLE9BQ0EsU0FBQSxNQUNBLEtBQUEsU0FBQSxFQUFBLEVBQUEsR0FFQSxHQUFBLEdBQUEsRUFBQSxZQUFBLEVBQUEsZ0JBQUEsRUFFQSxHQUFBLElBQUEsY0FBQSxTQUFBLEVBQUEsR0FDQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsdUJBR0EsRUFBQSxJQUFBLFlBQUEsU0FBQSxFQUFBLEdBQ0EsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLHFCQUdBLEVBQUEsSUFBQSxlQUFBLFNBQUEsRUFBQSxHQUNBLEVBQUEsS0FBQSxFQUNBLEVBQUEseUJDeEJBLFFBQUEsT0FBQSxZQUFBLHVCQUFBLFFBQUEsaUJBQUEsaUJBQUEsUUFBQSxVQUFBLGlCQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsR0FFQSxHQUFBLElBQUEsR0FBQSxNQUFBLEdBRUEsUUFDQSxnQkFBQSxXQWdCQSxHQUFBLEtBRUEsSUFBQSxTQUFBLEVBQUEsWUFDQSxFQUFBLEVBQUEsRUFBQSxZQUNBLEVBQUEsRUFBQSxFQUFBLGdCQUNBLENBQ0EsR0FBQSxHQUFBLEVBQUEsU0FBQSxlQUNBLEdBQUEsRUFBQSxFQUFBLFdBQ0EsRUFBQSxFQUFBLEVBQUEsVUFHQSxNQUFBLElBRUEsWUFBQSxVQUNBLGNBQUEsU0FBQSxHQUVBLEdBQUEsR0FBQSxFQUFBLE9BQUEsV0FBQSxFQUFBLEtBZ0JBLE9BZEEsS0FDQSxLQUVBLEVBQUEsT0FBQSxXQUFBLEVBQUEsTUFBQSxHQUdBLEVBQUEsY0FDQSxFQUFBLFlBQUEsS0FBQSxlQUFBLElBR0EsRUFBQSx3QkFDQSxFQUFBLHNCQUFBLEtBQUEsZUFBQSxFQUFBLGVBR0EsR0FFQSxrQkFBQSxTQUFBLEVBQUEsR0FDQSxNQUFBLHdDQUFBLEdBQUEsS0FBQSxhQUFBLElBQUEsRUFBQSxjQUVBLGVBQUEsU0FBQSxFQUFBLEdBRUEsRUFBQSxHQUFBLEtBQUEsV0FJQSxJQUFBLEdBQUEsRUFBQSxLQUNBLEVBQUEsS0FBQSxrQkFBQSxFQUFBLEVBcUJBLE9BbkJBLGVBQUEsR0FBQSxJQUFBLEtBQUEsY0FDQSxFQUFBLEtBQUEsZUFBQSxFQUFBLEtBQUEsY0FrQkEsR0FFQSxVQUFBLFdBQ0EsUUFBQSxHQUVBLFVBQUEsU0FBQSxHQUNBLEdBQUEsR0FBQSxRQUFBLEtBQUEsRUFFQSxPQURBLEdBQUEsS0FBQSxRQUFBLEtBQUEsWUFDQSxHQUVBLG9CQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsR0FPQSxHQU5BLEVBQUEsTUFFQSxFQUFBLFlBQUEsR0FDQSxFQUFBLEtBQUEsR0FHQSxFQUFBLGdCQUNBLElBQUEsR0FBQSxHQUFBLEVBQUEsRUFBQSxFQUFBLFNBQUEsT0FBQSxJQUFBLENBQ0EsR0FBQSxHQUFBLEVBQUEsU0FBQSxFQUNBLEdBQUEsWUFBQSxHQUNBLEVBQUEsS0FBQSxHQUVBLEdBQ0EsS0FBQSxvQkFBQSxFQUFBLEVBQUEsRUFBQSxHQUlBLE1BQUEsUUNsSEEsUUFBQSxPQUFBLFlBQUEsdUJBQUEsVUFBQSxzQkFBQSxXQUtBLE9BQ0EsS0FBQSxTQUFBLEVBQUEsRUFBQSxHQUNBLEVBQUEsT0FBQSxFQUFBLG9CQUFBLFNBQUEsR0FDQSxFQUFBLEtBQUEsY0FBQSxTQ1JBLFFBQUEsT0FBQSxZQUFBLHVCQUFBLFVBQUEsc0JBQUEsV0FDQSxPQUNBLFFBQUEsVUFDQSxLQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsR0F1Q0EsR0FyQ0EsRUFBQSxTQUFBLEtBQUEsU0FBQSxHQUlBLEdBQUEsUUFBQSxFQUNBLE1BQUEsRUFHQSxJQUFBLEdBQUEsRUFBQSxRQUFBLFVBQUEsSUFFQSxFQUFBLFNBQUEsRUFRQSxPQUxBLElBQUEsSUFDQSxFQUFBLGNBQUEsR0FDQSxFQUFBLFdBR0EsSUFJQSxFQUFBLFNBQUEsS0FBQSxTQUFBLEdBQ0EsR0FBQSxHQUFBLEVBQUEsU0FBQSxFQUNBLE9BQUEsSUFBQSxxQ0FBQSxLQUFBLElBQ0EsRUFBQSxhQUFBLFVBQUEsR0FDQSxLQUFBLEVBQUEsS0FBQSxFQUFBLEVBQUEsV0FBQSxRQUVBLEdBQUEsYUFBQSxVQUFBLEtBS0EsRUFBQSxZQUFBLEtBQUEsU0FBQSxHQUNBLE1BQUEsR0FBQSxTQUFBLEdBQUEsT0FBQSxJQUdBLEVBQUEsSUFBQSxDQUNBLEdBQUEsR0FBQSxTQUFBLEdBQ0EsR0FBQSxHQUFBLFdBQUEsRUFBQSxJQUNBLFFBQUEsRUFBQSxTQUFBLElBQUEsRUFBQSxNQUNBLEdBQUEsYUFBQSxPQUFBLElBR0EsRUFBQSxhQUFBLE9BQUEsR0FDQSxHQUlBLEdBQUEsU0FBQSxLQUFBLEdBQ0EsRUFBQSxZQUFBLEtBQUEsR0FHQSxHQUFBLEVBQUEsSUFBQSxDQUNBLEdBQUEsR0FBQSxTQUFBLEdBQ0EsR0FBQSxHQUFBLFdBQUEsRUFBQSxJQUNBLFFBQUEsRUFBQSxTQUFBLElBQUEsRUFBQSxNQUNBLEdBQUEsYUFBQSxPQUFBLElBR0EsRUFBQSxhQUFBLE9BQUEsR0FDQSxHQUlBLEdBQUEsU0FBQSxLQUFBLEdBQ0EsRUFBQSxZQUFBLEtBQUEsR0FHQSxFQUFBLFlBQUEsS0FBQSxTQUFBLEdBRUEsTUFBQSxHQUFBLFNBQUEsSUFBQSxRQUFBLFNBQUEsSUFDQSxFQUFBLGFBQUEsVUFBQSxHQUNBLE9BRUEsR0FBQSxhQUFBLFVBQUEsU0NoRkEsUUFBQSxPQUFBLFlBQUEsdUJBQUEsVUFBQSx5QkFBQSxXQUFBLFlBQUEsV0FBQSxTQUFBLGdCQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxHQUVBLFFBQUEsR0FBQSxFQUFBLEdBRUEsR0FBQSxHQUFBLDhNQVNBLEVBQUEsUUFBQSxRQUFBLEdBQ0EsRUFBQSxFQUFBLEtBQUEsU0FJQSxFQUFBLEVBQUEsS0FBQSxhQUVBLFNBQUEsUUFBQSxFQUFBLFNBQUEsR0FDQSw0QkFBQSxFQUFBLE1BQUEsVUFBQSxFQUFBLE1BQ0EsRUFBQSxLQUFBLEVBQUEsS0FBQSxFQUFBLFFBSUEsSUFDQSxHQURBLEVBQUEsRUFBQSxLQUFBLElBbUJBLE9BaEJBLEdBQUEsZUFBQSxXQUNBLEVBQUEsR0FBQSxRQUNBLEVBQUEsaUJBQUEsRUFBQSxpQkFHQSxFQUFBLEdBQUEsT0FBQSxXQUNBLEVBQUEsRUFBQSxXQUNBLEVBQUEsaUJBQUEsR0FDQSxPQUdBLEVBQUEsSUFBQSxXQUFBLFdBQ0EsR0FBQSxFQUFBLE9BQUEsR0FDQSxFQUFBLFNBR0EsRUFHQSxRQUFBLEdBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxHQUVBLEdBQUEsR0FBQSxFQUFBLEVBQUEsU0FDQSxFQUFBLEVBQUEsT0FFQSxFQUFBLHdUQVFBLEVBQUEsUUFBQSxRQUFBLEVBRUEsR0FBQSxjQUFBLFNBQUEsR0FFQSxFQUFBLGlCQUFBLENBUUEsS0FKQSxHQUFBLEdBQUEsR0FBQSxHQUVBLEVBQUEsRUFBQSxZQUFBLE9BRUEsS0FBQSxDQUNBLEdBQUEsR0FBQSxFQUFBLFlBQUEsR0FDQSxFQUFBLEVBQUEsRUFFQSxJQUFBLFNBQUEsRUFDQSxNQU1BLEVBQUEsRUFBQSxTQUFBLE1BR0EsS0FGQSxHQUFBLEdBQUEsRUFFQSxLQUFBLENBQ0EsR0FBQSxHQUFBLEVBQUEsU0FBQSxFQUdBLElBRkEsRUFBQSxFQUFBLEdBRUEsU0FBQSxFQUNBLE1BSUEsU0FBQSxHQUlBLEVBQUEsY0FBQSxHQUNBLEVBQUEsV0FHQSxFQUFBLEVBQUEsSUFJQSxFQUFBLGNBQUEsV0FDQSxNQUFBLEdBQUEsR0FHQSxJQUFBLEdBQUEsRUFBQSxFQXdCQSxPQXRCQSxHQUFBLE9BQUEsa0JBQUEsU0FBQSxHQUNBLEdBQUEsRUFBQSxDQUVBLEdBQUEsR0FBQSxFQUFBLHdCQUNBLEVBQUEsRUFBQSxpQkFFQSxHQUFBLEtBQ0EsS0FBQSxFQUFBLEVBQUEsRUFBQSxLQUFBLEtBQ0EsSUFBQSxFQUFBLEVBQUEsRUFBQSxJQUFBLEVBQUEsYUFBQSxLQUNBLE1BQUEsRUFBQSxZQUFBLFVBS0EsRUFBQSxpQkFBQSxFQUFBLHNCQUFBLFNBQUEsR0FDQSxFQUFBLE1BQUEsSUFHQSxFQUFBLElBQUEsV0FBQSxXQUNBLEVBQUEsV0FHQSxFQUdBLE9BQ0EsU0FBQSxJQUNBLFNBQUEsSUFDQSxVQUFBLEVBQ0EsT0FBQSxFQUNBLFFBQUEsV0FFQSxNQUFBLFVBQUEsRUFBQSxFQUFBLEdBRUEsR0FBQSxHQUFBLEVBQUEsRUFBQSxFQUFBLEVBRUEsR0FBQSxPQUFBLEdBQ0EsRUFBQSxHQUFBLEVBRUEsSUFBQSxHQUFBLEVBQUEsS0FBQSxTQUNBLEVBQUEsRUFBQSxXQUFBLFdBSUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsR0FDQSxFQUFBLEVBQUEsR0FFQSxFQUFBLEVBQUEsS0FBQSxPQUVBLEdBQUEsT0FBQSxHQUVBLEVBQUEsU0NyS0EsUUFBQSxPQUFBLFlBQUEsdUJBQUEsVUFBQSwwQkFBQSxlQUFBLFNBQUEsR0FFQSxRQUFBLEdBQUEsR0FLQSxJQUpBLEdBQUEsTUFDQSxFQUFBLEVBQUEsTUFDQSxFQUFBLEVBQUEsT0FFQSxLQUFBLENBQ0EsR0FBQSxHQUFBLEVBQUEsRUFFQSxHQUFBLE1BQUEsRUFBQSxJQUFBLE1BQUEsVUFDQSxFQUFBLEtBQUEsRUFBQSxLQUlBLE1BQUEsSUFBQSxFQUFBLE9BQUEsSUFHQSxNQUFBLFVBQUEsRUFBQSxFQUFBLEdBSUEsUUFBQSxLQUNBLEdBQUEsSUFDQSxFQUFBLE9BR0EsUUFBQSxLQUNBLEVBQUEsS0FBQSxFQUFBLElBUkEsR0FBQSxHQUFBLEVBQUEsQ0FXQSxHQUFBLElBQUEsV0FBQSxXQUNBLE1BR0EsRUFBQSxPQUFBLEVBQUEsdUJBQUEsU0FBQSxHQUNBLEdBQUEsU0FBQSxFQUFBLENBQ0EsRUFBQSxFQUFBLEdBRUEsRUFBQSxTQUFBLGNBQUEsS0FBQSxXQUFBLEVBRUEsSUFBQSxHQUFBLEVBQUEsRUFFQSxLQUFBLEdBRUEsRUFBQSxFQUVBLElBRUEsRUFBQSxFQUFBLGlCQUFBLEVBQUEsV0FDQSxPQUdBIiwiZmlsZSI6ImZlYndvcm1zLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBmZWJ3b3JtcyA9IGZlYndvcm1zIHx8IHt9O1xyXG4vKipcclxuICogQ29uc3RydWN0b3IgZm9yIGZlYndvcm0gRmllbGQgdHlwZXMuXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlICAgICAgICAgSW5kaWNhdGVzIHRoZSB0eXBlIG9mIGZpZWxkXHJcbiAqIEBwYXJhbSB7b2JqZWN0fSBwcm9wZXJ0aWVzICAgW29wdGlvbmFsXSBJbml0aWFsIHByb3BlcnR5IHZhbHVlc1xyXG4gKi9cclxuZmVid29ybXMuRmllbGQgPSBmdW5jdGlvbih0eXBlLCBwcm9wZXJ0aWVzKSB7XHJcbiAgdGhpcy5uYW1lID0gdGhpcy50eXBlID0gdHlwZTtcclxuXHJcbiAgaWYgKHByb3BlcnRpZXMpIHtcclxuICAgIGFuZ3VsYXIuZXh0ZW5kKHRoaXMsIHByb3BlcnRpZXMpO1xyXG4gIH1cclxuXHJcbiAgdGhpcy5kaXNwbGF5TmFtZSA9IHRoaXMuZGlzcGxheU5hbWUgfHwgdGhpcy50eXBlLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgdGhpcy50eXBlLnN1YnN0cmluZygxKTtcclxufTtcclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdmZWJ3b3JtcycsIFtcIm5nUm91dGVcIixcImRxXCIsXCJmZWJ3b3Jtcy50ZW1wbGF0ZXNcIl0pO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ2ZlYndvcm1zJywgW1wiZmVid29ybXMudGVtcGxhdGVzXCJdKS5jb25maWcoWyckcHJvdmlkZScsIGZ1bmN0aW9uKCRwcm92aWRlKSB7XHJcblxyXG4gICRwcm92aWRlLnByb3ZpZGVyKCdmZWJ3b3Jtc0NvbmZpZycsIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIHZhciBjb25maWcgPSB7XHJcbiAgICAgIGVuYWJsZURlYnVnSW5mbzogdHJ1ZSxcclxuICAgICAgdmFsaWRhdGlvbjoge1xyXG4gICAgICAgIG1lc3NhZ2VzOiB7fSxcclxuICAgICAgICBwYXR0ZXJuczoge31cclxuICAgICAgfSxcclxuICAgICAgZmllbGRzOiB7XHJcbiAgICAgICAgdGVtcGxhdGVzOiBbXSxcclxuICAgICAgICBjYXRlZ29yaWVzOiB7fSxcclxuICAgICAgICByZW5kZXJJbmZvOiB7fVxyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciB0ZW1wbGF0ZXMgPSBjb25maWcuZmllbGRzLnRlbXBsYXRlcztcclxuXHJcbiAgICBmdW5jdGlvbiBpbmRleE9mVGVtcGxhdGUodHlwZSkge1xyXG4gICAgICB2YXIgaWR4ID0gdGVtcGxhdGVzLmxlbmd0aDtcclxuXHJcbiAgICAgIHdoaWxlIChpZHgtLSkge1xyXG4gICAgICAgIGlmICh0ZW1wbGF0ZXNbaWR4XS50eXBlID09PSB0eXBlKSB7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBpZHg7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgZGVidWc6IGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgY29uZmlnLmVuYWJsZURlYnVnSW5mbyA9IHZhbHVlO1xyXG4gICAgICB9LFxyXG4gICAgICBmaWVsZHM6IHtcclxuICAgICAgICBhZGQ6IGZ1bmN0aW9uKG9iamVjdFRlbXBsYXRlLCBjYXRlZ29yaWVzLCB0ZW1wbGF0ZVVybCwgcHJvcGVydGllc1RlbXBsYXRlVXJsKSB7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGlmICghb2JqZWN0VGVtcGxhdGUgfHwgIW9iamVjdFRlbXBsYXRlLnR5cGUgfHwgIWNhdGVnb3JpZXMgfHwgIWNhdGVnb3JpZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTmVlZCBhIHZhbGlkIG9iamVjdFRlbXBsYXRlIGFuZCBhdCBsZWFzdCBvbmUgY2F0ZWdvcnknKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICB2YXIgaWR4ID0gaW5kZXhPZlRlbXBsYXRlKG9iamVjdFRlbXBsYXRlLnR5cGUpO1xyXG5cclxuICAgICAgICAgIGlmIChpZHggIT09IC0xKSB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlc1tpZHhdID0gb2JqZWN0VGVtcGxhdGU7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZXMucHVzaChvYmplY3RUZW1wbGF0ZSk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgdGhpcy5jYXRlZ29yeShvYmplY3RUZW1wbGF0ZS50eXBlLCBjYXRlZ29yaWVzKTtcclxuICAgICAgICAgIHRoaXMucmVuZGVySW5mbyhvYmplY3RUZW1wbGF0ZS50eXBlLCB0ZW1wbGF0ZVVybCwgcHJvcGVydGllc1RlbXBsYXRlVXJsKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHJlbW92ZTogZnVuY3Rpb24odHlwZSkge1xyXG4gICAgICAgICAgdmFyIGlkeCA9IGluZGV4T2ZUZW1wbGF0ZSh0eXBlKTtcclxuXHJcbiAgICAgICAgICBpZihpZHggIT09IC0xKSB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlcy5zcGxpY2UoaWR4LCAxKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICB0aGlzLmNhdGVnb3J5KHR5cGUpO1xyXG4gICAgICAgICAgdGhpcy5yZW5kZXJJbmZvKHR5cGUpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcmVuZGVySW5mbzogZnVuY3Rpb24oZmllbGRUeXBlLCB0ZW1wbGF0ZVVybCwgcHJvcGVydGllc1RlbXBsYXRlVXJsKSB7XHJcbiAgICAgICAgICB2YXIgcmVuZGVySW5mbyA9IHtcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6IHRlbXBsYXRlVXJsLFxyXG4gICAgICAgICAgICBwcm9wZXJ0aWVzVGVtcGxhdGVVcmw6IHByb3BlcnRpZXNUZW1wbGF0ZVVybFxyXG4gICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICBjb25maWcuZmllbGRzLnJlbmRlckluZm9bZmllbGRUeXBlXSA9IHJlbmRlckluZm87XHJcbiAgICAgICAgfSxcclxuICAgICAgICBjYXRlZ29yeTogZnVuY3Rpb24oZmllbGRUeXBlLCBjYXRlZ29yaWVzKSB7XHJcbiAgICAgICAgICBpZiAoIWFuZ3VsYXIuaXNBcnJheShjYXRlZ29yaWVzKSkge1xyXG4gICAgICAgICAgICBjYXRlZ29yaWVzID0gW2NhdGVnb3JpZXNdO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChjb25maWcuZmllbGRzLmNhdGVnb3JpZXMsIGZ1bmN0aW9uKGNhdGVnb3J5KSB7XHJcbiAgICAgICAgICAgIGRlbGV0ZSBjYXRlZ29yeVtmaWVsZFR5cGVdO1xyXG4gICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGNhdGVnb3JpZXMsIGZ1bmN0aW9uKGNhdGVnb3J5KSB7XHJcbiAgICAgICAgICAgIGlmIChjb25maWcuZmllbGRzLmNhdGVnb3JpZXNbY2F0ZWdvcnldID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICBjb25maWcuZmllbGRzLmNhdGVnb3JpZXNbY2F0ZWdvcnldID0ge307XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbmZpZy5maWVsZHMuY2F0ZWdvcmllc1tjYXRlZ29yeV1bZmllbGRUeXBlXSA9IHRydWU7XHJcbiAgICAgICAgICB9KTsgICAgICAgICAgXHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICB2YWxpZGF0aW9uOiB7XHJcbiAgICAgICAgbWVzc2FnZTogZnVuY3Rpb24odHlwZU9yT2JqZWN0LCBtZXNzYWdlKSB7XHJcblxyXG4gICAgICAgICAgdmFyIG1lc3NhZ2VzID0gY29uZmlnLnZhbGlkYXRpb24ubWVzc2FnZXM7XHJcblxyXG4gICAgICAgICAgaWYgKGFuZ3VsYXIuaXNTdHJpbmcodHlwZU9yT2JqZWN0KSkge1xyXG5cclxuICAgICAgICAgICAgaWYgKCFtZXNzYWdlKSB7XHJcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBtZXNzYWdlIHNwZWNpZmllZCBmb3IgJyArIHR5cGVPck9iamVjdCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIG1lc3NhZ2VzW3R5cGVPck9iamVjdF0gPSBtZXNzYWdlO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgYW5ndWxhci5leHRlbmQobWVzc2FnZXMsIHR5cGVPck9iamVjdCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBwYXR0ZXJuOiBmdW5jdGlvbihuYW1lT3JPYmplY3QsIHBhdHRlcm4pIHtcclxuXHJcbiAgICAgICAgICBpZihhbmd1bGFyLmlzU3RyaW5nKG5hbWVPck9iamVjdCkpIHtcclxuICAgICAgICAgICAgY29uZmlnLnZhbGlkYXRpb24ucGF0dGVybnNbbmFtZV0gPSBwYXR0ZXJuO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgYW5ndWxhci5leHRlbmQoY29uZmlnLnZhbGlkYXRpb24ucGF0dGVybnMsIG5hbWVPck9iamVjdCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICAkZ2V0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gY29uZmlnO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gIH0pO1xyXG5cclxufV0pO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ2ZlYndvcm1zJywgW1wiZmVid29ybXMudGVtcGxhdGVzXCJdKS5jb25maWcoWydmZWJ3b3Jtc0NvbmZpZ1Byb3ZpZGVyJywgZnVuY3Rpb24oZmVid29ybXNDb25maWdQcm92aWRlcikge1xyXG5cclxuICAvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXHJcbiAgLy8gTWVzc2FnZXNcclxuICAvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXHJcblxyXG4gIGZlYndvcm1zQ29uZmlnUHJvdmlkZXIudmFsaWRhdGlvbi5tZXNzYWdlKHtcclxuICAgIHJlcXVpcmVkOiAnQSB2YWx1ZSBpcyByZXF1aXJlZCBmb3IgdGhpcyBmaWVsZC4nLFxyXG4gICAgbWlubGVuZ3RoOiAnVGhlIHZhbHVlIGRvZXMgbm90IG1hdGNoIHRoZSBtaW5pbXVtIGxlbmd0aHt7IGZpZWxkLnNjaGVtYSAmJiAoXCIgb2YgXCIgKyBmaWVsZC5zY2hlbWEudmFsaWRhdGlvbi5taW5sZW5ndGggKyBcIiBjaGFyYWN0ZXJzXCIgfHwgXCJcIil9fS4nLFxyXG4gICAgbWF4bGVuZ3RoOiAnVGhlIHZhbHVlIGV4Y2VlZHMgdGhlIG1heGltdW0gbGVuZ3Roe3sgZmllbGQuc2NoZW1hICYmIChcIiBvZiBcIiArIGZpZWxkLnNjaGVtYS52YWxpZGF0aW9uLm1heGxlbmd0aCArIFwiIGNoYXJhY3RlcnNcIiB8fCBcIlwiKX19LicsXHJcbiAgICBwYXR0ZXJuOiAnVGhlIHZhbHVlIFwie3sgZmllbGQuc3RhdGUuJHZpZXdWYWx1ZSB9fVwiIGRvZXMgbm90IG1hdGNoIHRoZSByZXF1aXJlZCBmb3JtYXQuJyxcclxuICAgIGVtYWlsOiAnVGhlIHZhbHVlIFwie3sgZmllbGQuc3RhdGUuJHZpZXdWYWx1ZSB9fVwiIGlzIG5vdCBhIHZhbGlkIGVtYWlsIGFkZHJlc3MuJyxcclxuICAgIHVuaXF1ZTogJ1RoZSB2YWx1ZSBcInt7IGZpZWxkLnN0YXRlLiR2aWV3VmFsdWUgfX1cIiBpcyBhbHJlYWR5IGluIHVzZS4nLFxyXG4gICAgbnVtYmVyOiAnVGhlIHZhbHVlIFwie3sgZmllbGQuc3RhdGUuJHZpZXdWYWx1ZSB9fVwiIGlzIG5vdCBhIG51bWJlci4nLFxyXG4gICAgbWluOiAnVGhlIHZhbHVlIHt7IGZpZWxkLnNjaGVtYSAmJiAoXCJzaG91bGQgYmUgYXQgbGVhc3QgXCIgKyBmaWVsZC5zY2hlbWEudmFsaWRhdGlvbi5taW4pIHx8IGZpZWxkLnN0YXRlLiR2aWV3VmFsdWUgKyBcIiBpcyB0b28gbG93XCIgfX0nLFxyXG4gICAgbWF4OiAnVGhlIHZhbHVlIHt7IGZpZWxkLnNjaGVtYSAmJiAoXCJzaG91bGQgYmUgbGVzcyB0aGFuIFwiICsgZmllbGQuc2NoZW1hLnZhbGlkYXRpb24ubWF4KSB8fCBmaWVsZC5zdGF0ZS4kdmlld1ZhbHVlICsgXCIgaXMgdG9vIGhpZ2hcIiB9fSdcclxuICB9KTtcclxuXHJcbiAgLy8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxyXG4gIC8vIEZpZWxkc1xyXG4gIC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cclxuXHJcbiAgdmFyIGNhdGVnb3JpZXMgPSB7XHJcbiAgICAnVGV4dCBpbnB1dCBmaWVsZHMnOiBbXHJcbiAgICAgIG5ldyBmZWJ3b3Jtcy5GaWVsZCgndGV4dCcsIHtcclxuICAgICAgICBkaXNwbGF5TmFtZTogJ1RleHRib3gnXHJcbiAgICAgIH0pLFxyXG4gICAgICBuZXcgZmVid29ybXMuRmllbGQoJ2VtYWlsJyksXHJcbiAgICAgIG5ldyBmZWJ3b3Jtcy5GaWVsZCgnbnVtYmVyJywgeyBcclxuICAgICAgICB2YWxpZGF0aW9uOiB7IG1heGxlbmd0aDogMTUgLyogdG8gcHJldmVudCA+IE51bWJlci5NQVhfVkFMVUUgKi8gfSAgXHJcbiAgICAgIH0pLFxyXG4gICAgICBuZXcgZmVid29ybXMuRmllbGQoJ3Bhc3N3b3JkJyksXHJcbiAgICAgIG5ldyBmZWJ3b3Jtcy5GaWVsZCgndGV4dGFyZWEnKVxyXG4gICAgXSxcclxuICAgICdDaGVja2JveCBmaWVsZHMnOiBbXHJcbiAgICAgIG5ldyBmZWJ3b3Jtcy5GaWVsZCgnY2hlY2tib3gnLCB7IG5vbGFiZWw6IHRydWUgfSksXHJcbiAgICAgIG5ldyBmZWJ3b3Jtcy5GaWVsZCgnY2hlY2tib3hsaXN0Jywge1xyXG4gICAgICAgIGRpc3BsYXlOYW1lOiAnQ2hlY2tib3ggTGlzdCcsXHJcbiAgICAgICAgb3B0aW9uczogW3tcclxuICAgICAgICAgIHZhbHVlOiAnMScsXHJcbiAgICAgICAgICB0ZXh0OiAnT3B0aW9uIDEnXHJcbiAgICAgICAgfSwge1xyXG4gICAgICAgICAgdmFsdWU6ICcyJyxcclxuICAgICAgICAgIHRleHQ6ICdPcHRpb24gMidcclxuICAgICAgICB9LCB7XHJcbiAgICAgICAgICB2YWx1ZTogJzMnLFxyXG4gICAgICAgICAgdGV4dDogJ09wdGlvbiAzJ1xyXG4gICAgICAgIH1dLFxyXG4gICAgICAgIHZhbHVlOiB7XHJcbiAgICAgICAgICAnMSc6IHRydWUsXHJcbiAgICAgICAgICAnMic6IHRydWVcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICBdLFxyXG4gICAgJ1NlbGVjdCBpbnB1dCBmaWVsZHMnOiBbXHJcbiAgICAgIG5ldyBmZWJ3b3Jtcy5GaWVsZCgncmFkaW9idXR0b25saXN0Jywge1xyXG4gICAgICAgIGRpc3BsYXlOYW1lOiAnUmFkaW9idXR0b24gTGlzdCcsXHJcbiAgICAgICAgb3B0aW9uczogW3tcclxuICAgICAgICAgIHZhbHVlOiAnMScsXHJcbiAgICAgICAgICB0ZXh0OiAnT3B0aW9uIDEnXHJcbiAgICAgICAgfSwge1xyXG4gICAgICAgICAgdmFsdWU6ICcyJyxcclxuICAgICAgICAgIHRleHQ6ICdPcHRpb24gMidcclxuICAgICAgICB9LCB7XHJcbiAgICAgICAgICB2YWx1ZTogJzMnLFxyXG4gICAgICAgICAgdGV4dDogJ09wdGlvbiAzJ1xyXG4gICAgICAgIH1dLFxyXG4gICAgICAgIHZhbHVlOiAnMSdcclxuICAgICAgfSksXHJcbiAgICAgIG5ldyBmZWJ3b3Jtcy5GaWVsZCgnc2VsZWN0bGlzdCcsIHtcclxuICAgICAgICBkaXNwbGF5TmFtZTogJ1NlbGVjdCBMaXN0JyxcclxuICAgICAgICBvcHRpb25zOiBbe1xyXG4gICAgICAgICAgdmFsdWU6ICcxJyxcclxuICAgICAgICAgIHRleHQ6ICdPcHRpb24gMSdcclxuICAgICAgICB9LCB7XHJcbiAgICAgICAgICB2YWx1ZTogJzInLFxyXG4gICAgICAgICAgdGV4dDogJ09wdGlvbiAyJ1xyXG4gICAgICAgIH0sIHtcclxuICAgICAgICAgIHZhbHVlOiAnMycsXHJcbiAgICAgICAgICB0ZXh0OiAnT3B0aW9uIDMnXHJcbiAgICAgICAgfV0sXHJcbiAgICAgICAgdmFsdWU6ICcxJ1xyXG4gICAgICB9KSAvLyAsXHJcbiAgICAgIC8vIG5ldyBmZWJ3b3Jtcy5GaWVsZCgnZHJvcGRvd25saXN0Jywge1xyXG4gICAgICAvLyAgIG9wdGlvbnM6IFt7XHJcbiAgICAgIC8vICAgICB2YWx1ZTogJzEnLFxyXG4gICAgICAvLyAgICAgdGV4dDogJ09wdGlvbiAxJ1xyXG4gICAgICAvLyAgIH0sIHtcclxuICAgICAgLy8gICAgIHZhbHVlOiAnMicsXHJcbiAgICAgIC8vICAgICB0ZXh0OiAnT3B0aW9uIDInXHJcbiAgICAgIC8vICAgfSwge1xyXG4gICAgICAvLyAgICAgdmFsdWU6ICczJyxcclxuICAgICAgLy8gICAgIHRleHQ6ICdPcHRpb24gMydcclxuICAgICAgLy8gICB9XSxcclxuICAgICAgLy8gICB2YWx1ZTogJzEnXHJcbiAgICAgIC8vIH0pXHJcbiAgICBdXHJcbiAgfTtcclxuICBcclxuXHJcbiAgYW5ndWxhci5mb3JFYWNoKGNhdGVnb3JpZXMsIGZ1bmN0aW9uKGZpZWxkcywgY2F0ZWdvcnkpIHtcclxuICAgIGFuZ3VsYXIuZm9yRWFjaChmaWVsZHMsIGZ1bmN0aW9uKGZpZWxkKSB7XHJcbiAgICAgIGZlYndvcm1zQ29uZmlnUHJvdmlkZXIuZmllbGRzLmFkZChmaWVsZCwgY2F0ZWdvcnkgLyosIHRlbXBsYXRlVXJsLCBwcm9wZXJ0aWVzVGVtcGxhdGVVcmwgKi8gKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICAvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXHJcbiAgLy8gUGF0dGVybnNcclxuICAvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXHJcblxyXG4gIGZlYndvcm1zQ29uZmlnUHJvdmlkZXIudmFsaWRhdGlvbi5wYXR0ZXJuKHtcclxuICAgICdOb25lJzogdW5kZWZpbmVkLFxyXG4gICAgJ1VybCc6ICdeKGh0dHBzPzpcXFxcL1xcXFwvKT8oW1xcXFxkYS16XFxcXC4tXSspXFxcXC4oW2EtelxcXFwuXXsyLDZ9KShbXFxcXC9cXFxcdyBcXFxcLi1dKikqXFxcXC8/JCcsXHJcbiAgICAnRG9tYWluJzogJ14oW2Etel1bYS16MC05XFwtXSsoXFxcXC58XFxcXC0qXFxcXC4pKStbYS16XXsyLDZ9JCcsXHJcbiAgICAnSVB2NCBBZGRyZXNzJzogJ14oPzooPzoyNVswLTVdfDJbMC00XVswLTldfFswMV0/WzAtOV1bMC05XT8pXFxcXC4pezN9KD86MjVbMC01XXwyWzAtNF1bMC05XXxbMDFdP1swLTldWzAtOV0/KSQnLFxyXG4gICAgJ0VtYWlsIEFkZHJlc3MnOiAnXihbYS16MC05X1xcXFwuLV0rKUAoW1xcXFxkYS16XFxcXC4tXSspXFxcXC4oW2EtelxcXFwuXXsyLDZ9KSQnLFxyXG4gICAgJ0ludGVnZXInOiAnXi17MCwxfVxcXFxkKyQnLFxyXG4gICAgJ1Bvc2l0aXZlIEludGVnZXJzJzogJ15cXFxcZCskJyxcclxuICAgICdOZWdhdGl2ZSBJbnRlZ2Vycyc6ICdeLVxcXFxkKyQnLFxyXG4gICAgJ051bWJlcic6ICdeLXswLDF9XFxcXGQqXFxcXC57MCwxfVxcZCskJyxcclxuICAgICdQb3NpdGl2ZSBOdW1iZXInOiAnXlxcXFxkKlxcXFwuezAsMX1cXFxcZCskJyxcclxuICAgICdOZWdhdGl2ZSBOdW1iZXInOiAnXi1cXFxcZCpcXFxcLnswLDF9XFxcXGQrJCcsXHJcbiAgICAnWWVhciAoMTkyMC0yMDk5KSc6ICdeKDE5fDIwKVtcXFxcZF17MiwyfSQnLFxyXG4gICAgJ1Bhc3N3b3JkJzogJyg/PS4qXFxcXGQpKD89LipbIUAjJCVeJipcXFxcLT0oKXw/LlxcXCJcXCc7Ol0rKSg/IVsuXFxcXG5dKSg/PS4qW0EtWl0pKD89LipbYS16XSkuKiQnXHJcbiAgfSk7XHJcbn1dKTtcclxuIiwiYW5ndWxhci5tb2R1bGUoJ2ZlYndvcm1zJywgW1wiZmVid29ybXMudGVtcGxhdGVzXCJdKS5kaXJlY3RpdmUoJ2ZlYndvcm1zRWRpdFZhbGlkYXRpb25NZXNzYWdlJywgWydmZWJ3b3Jtc0VkaXRWYWxpZGF0aW9uTWVzc2FnZUxpbmtGbicsIGZ1bmN0aW9uKGZlYndvcm1zRWRpdFZhbGlkYXRpb25NZXNzYWdlTGlua0ZuKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9mZWJ3b3Jtcy9lZGl0L2NhbnZhcy9maWVsZC9wcm9wZXJ0aWVzL3ZhbGlkYXRpb24vdmFsaWRhdGlvbi1tZXNzYWdlLnRtcGwuaHRtbCcsXHJcbiAgICBsaW5rOiBmZWJ3b3Jtc0VkaXRWYWxpZGF0aW9uTWVzc2FnZUxpbmtGbixcclxuICAgIHNjb3BlOiB0cnVlXHJcbiAgfTtcclxufV0pLmZhY3RvcnkoJ2ZlYndvcm1zRWRpdFZhbGlkYXRpb25NZXNzYWdlTGlua0ZuJywgZnVuY3Rpb24oKSB7XHJcblxyXG4gIHZhciBERUZBVUxUX1RPT0xUSVAgPSBcIkVudGVyIGEgZXJyb3IgbWVzc2FnZSBoZXJlIHRoYXQgd2lsbCBiZSBzaG93biBpZiB0aGlzIHZhbGlkYXRpb24gZmFpbHMuIElmIHRoaXMgZmllbGQgaXMgZW1wdHkgYSBkZWZhdWx0IG1lc3NhZ2Ugd2lsbCBiZSB1c2VkLlwiO1xyXG4gIFxyXG4gIHJldHVybiBmdW5jdGlvbigkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMsIGN0cmxzKSB7XHJcbiAgICAkYXR0cnMuJG9ic2VydmUoJ2ZlYndvcm1zRWRpdFZhbGlkYXRpb25NZXNzYWdlJywgZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgJHNjb3BlLnZhbGlkYXRpb25UeXBlID0gdmFsdWU7XHJcbiAgICB9KTtcclxuXHJcbiAgICAkYXR0cnMuJG9ic2VydmUoJ2ZlYndvcm1zRWRpdFZhbGlkYXRpb25Ub29sdGlwJywgZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgdmFsdWUgPSB2YWx1ZSB8fCBERUZBVUxUX1RPT0xUSVA7XHJcbiAgICAgICRzY29wZS50b29sdGlwID0gdmFsdWU7XHJcbiAgICB9KTtcclxuICB9O1xyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnZmVid29ybXMnLCBbXCJmZWJ3b3Jtcy50ZW1wbGF0ZXNcIl0pLmRpcmVjdGl2ZSgnZmVid29ybXNQcm9wZXJ0eUZpZWxkVmFsaWRhdGlvbicsIFsnZmVid29ybXNQcm9wZXJ0eUZpZWxkVmFsaWRhdGlvbkxpbmtGbicsIGZ1bmN0aW9uKGZlYndvcm1zUHJvcGVydHlGaWVsZFZhbGlkYXRpb25MaW5rRm4pIHtcclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9mZWJ3b3Jtcy9lZGl0L2NhbnZhcy9maWVsZC9wcm9wZXJ0aWVzL3ZhbGlkYXRpb24vdmFsaWRhdGlvbi50bXBsLmh0bWwnLFxyXG4gICAgbGluazogZmVid29ybXNQcm9wZXJ0eUZpZWxkVmFsaWRhdGlvbkxpbmtGblxyXG4gIH07XHJcbn1dKS5mYWN0b3J5KCdmZWJ3b3Jtc1Byb3BlcnR5RmllbGRWYWxpZGF0aW9uTGlua0ZuJywgWydmZWJ3b3Jtc0NvbmZpZycsIGZ1bmN0aW9uKGZlYndvcm1zQ29uZmlnKSB7XHJcblxyXG4gIHZhciBwYXR0ZXJuT3B0aW9ucyA9IFtdO1xyXG4gIHZhciBwYXR0ZXJuQ29uZmlnID0gZmVid29ybXNDb25maWcudmFsaWRhdGlvbi5wYXR0ZXJucztcclxuXHJcbiAgYW5ndWxhci5mb3JFYWNoKHBhdHRlcm5Db25maWcsIGZ1bmN0aW9uKHZhbHVlLCB0ZXh0KSB7XHJcbiAgICBwYXR0ZXJuT3B0aW9ucy5wdXNoKHsgdmFsdWU6IHZhbHVlLCB0ZXh0OiB0ZXh0IH0pO1xyXG4gIH0pO1xyXG5cclxuICByZXR1cm4gZnVuY3Rpb24oJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzLCBjdHJscykge1xyXG5cclxuICAgICRzY29wZS5wYXR0ZXJuT3B0aW9ucyA9IHBhdHRlcm5PcHRpb25zO1xyXG5cclxuICAgICRzY29wZS5maWVsZC52YWxpZGF0aW9uID0gJHNjb3BlLmZpZWxkLnZhbGlkYXRpb24gfHwge307XHJcbiAgICAkc2NvcGUuZmllbGQudmFsaWRhdGlvbi5tZXNzYWdlcyA9ICRzY29wZS5maWVsZC52YWxpZGF0aW9uLm1lc3NhZ2VzIHx8IHt9O1xyXG5cclxuICAgICRzY29wZS5maWVsZHMgPSB7XHJcbiAgICAgIHJlcXVpcmVkOiBmYWxzZSxcclxuICAgICAgbWlubGVuZ3RoOiBmYWxzZSxcclxuICAgICAgbWF4bGVuZ3RoOiBmYWxzZSxcclxuICAgICAgcGF0dGVybjogZmFsc2VcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLiR3YXRjaCgkYXR0cnNbJ2ZlYndvcm1zUHJvcGVydHlGaWVsZFZhbGlkYXRpb24nXSwgZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgJHNjb3BlLmZpZWxkcyA9IGFuZ3VsYXIuZXh0ZW5kKCRzY29wZS5maWVsZHMsIHZhbHVlKTtcclxuICAgIH0pO1xyXG4gIH07XHJcbn1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnZmVid29ybXMnLCBbXCJmZWJ3b3Jtcy50ZW1wbGF0ZXNcIl0pLmRpcmVjdGl2ZSgnZmVid29ybXNQYXJzZVBhdHRlcm4nLCBmdW5jdGlvbigpIHtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIHJlcXVpcmU6IFsnbmdNb2RlbCddLFxyXG4gICAgbGluazogZnVuY3Rpb24oJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzLCBjdHJscykge1xyXG4gICAgICB2YXIgbmdNb2RlbEN0cmwgPSBjdHJsc1swXTtcclxuXHJcbiAgICAgIG5nTW9kZWxDdHJsLiRwYXJzZXJzLnB1c2godmFsaWRhdGUpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCcxMjMnKTtcclxuICAgICAgZnVuY3Rpb24gdmFsaWRhdGUodmFsdWUpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyh2YWx1ZSk7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIG5ldyBSZWdFeHAodmFsdWUpO1xyXG4gICAgICAgIH0gY2F0Y2goZSkge1xyXG4gICAgICAgICAgbmdNb2RlbEN0cmwuJHNldFZhbGlkaXR5KCdwYXR0ZXJuJywgZmFsc2UpO1xyXG4gICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIG5nTW9kZWxDdHJsLiRzZXRWYWxpZGl0eSgncGF0dGVybicsIHRydWUpO1xyXG4gICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH07XHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdmZWJ3b3JtcycsIFtcImZlYndvcm1zLnRlbXBsYXRlc1wiXSkuZGlyZWN0aXZlKCdmZWJ3b3Jtc1Byb3BlcnR5RmllbGQnLCBbJ2ZlYndvcm1zUHJvcGVydHlGaWVsZExpbmtGbicsIGZ1bmN0aW9uKGZlYndvcm1zUHJvcGVydHlGaWVsZExpbmtGbikge1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdBRScsXHJcbiAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZmVid29ybXMvZWRpdC9jYW52YXMvZmllbGQvcHJvcGVydGllcy9wcm9wZXJ0eS1maWVsZC9wcm9wZXJ0eS1maWVsZC50bXBsLmh0bWwnLFxyXG4gICAgdHJhbnNjbHVkZTogdHJ1ZSxcclxuICAgIHNjb3BlOiB0cnVlLFxyXG4gICAgbGluazogZmVid29ybXNQcm9wZXJ0eUZpZWxkTGlua0ZuXHJcbiAgfTtcclxuXHJcbn1dKS5mYWN0b3J5KCdmZWJ3b3Jtc1Byb3BlcnR5RmllbGRMaW5rRm4nLCBmdW5jdGlvbigpIHtcclxuICByZXR1cm4gZnVuY3Rpb24oJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzLCBjdHJscykge1xyXG4gICAgXHJcbiAgICAkYXR0cnMuJG9ic2VydmUoJ2ZlYndvcm1zUHJvcGVydHlGaWVsZCcsIGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICRzY29wZS5maWVsZE5hbWUgPSB2YWx1ZTtcclxuICAgIH0pO1xyXG5cclxuICAgICRhdHRycy4kb2JzZXJ2ZSgnZmVid29ybXNQcm9wZXJ0eUZpZWxkTGFiZWwnLCBmdW5jdGlvbih2YWx1ZSkge1xyXG4gICAgICBpZih2YWx1ZSkge1xyXG4gICAgICAgICRzY29wZS5maWVsZExhYmVsID0gdmFsdWU7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICB9O1xyXG59KTsiLCIvKlxyXG4gICAgICBUaGUgZmllbGQtdmFsdWUgZGlyZWN0aXZlIHdpbGwgcmUtcmVuZGVyIGl0c2VsZiB3aGVuIGNlcnRhaW4gdmFsaWRhdGlvbiB2YWx1ZXMgYXJlIG1vZGlmaWVkLlxyXG4gICAgICBUaGlzIGlzIG5lZWRlZCBiZWNhdXNlIGFuZ3VsYXIgZG9lcyBub3Qgd2F0Y2ggb3Igb2JzZXJ2ZSB0aGUgdmFsdWVzIG9mIGNlcnRhaW4gYXR0cmlidXRlcyBhbmQgYWxsb3dzXHJcbiAgICAgIGFuIGludmFsaWQgaW5pdGlhbCB2YWx1ZSB0byBiZSBzYXZlZCBpbiB0aGUgZm9ybSBzY2hlbWEuXHJcblxyXG4gICAgICBJbXBvcnRhbnQ6IHRoZSB0cmFuc2NsdWRlZCBmb3JtIGZpZWxkIG11c3QgYmUgbmFtZSBmaWVsZFZhbHVlIVxyXG5cclxuICAgICAgPGRpdiBmZWJ3b3Jtcy1wcm9wZXJ0eS1maWVsZC12YWx1ZT5cclxuICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBcclxuICAgICAgICAgICAgICAgbmFtZT1cImZpZWxkVmFsdWVcIiBcclxuICAgICAgICAgICAgICAgbmctbW9kZWw9XCJmaWVsZC52YWx1ZVwiIFxyXG4gICAgICAgICAgICAgICBuZy1taW5sZW5ndGg9XCJ7eyBmaWVsZC52YWxpZGF0aW9uLm1pbmxlbmd0aCB9fVwiXHJcbiAgICAgICAgICAgICAgIG5nLW1heGxlbmd0aD1cInt7IGZpZWxkLnZhbGlkYXRpb24ubWF4bGVuZ3RoIH19XCJcclxuICAgICAgICAgICAgICAgbmctcGF0dGVybj1cIi97eyBmaWVsZC52YWxpZGF0aW9uLnBhdHRlcm4gfX0vXCIvPlxyXG4gICAgICA8L2Rpdj5cclxuXHJcbiAgICAgIFRoZSBmZWJ3b3Jtcy1maWVsZC1yZWRyYXcgZGlyZWN0aXZlIHdpbGwgdHJpZ2dlciwgb24gbW9kZWwgY2hhbmdlLCB0aGUgZmllbGQtdmFsdWUgdG8gcmUtcmVuZGVyIGl0c2VsZi5cclxuICovXHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnZmVid29ybXMnLCBbXCJmZWJ3b3Jtcy50ZW1wbGF0ZXNcIl0pLmRpcmVjdGl2ZSgnZmVid29ybXNQcm9wZXJ0eUZpZWxkVmFsdWUnLCBbJ2ZlYndvcm1zUHJvcGVydHlGaWVsZFZhbHVlTGlua0ZuJywgZnVuY3Rpb24oZmVid29ybXNQcm9wZXJ0eUZpZWxkVmFsdWVMaW5rRm4pIHtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIHJlcXVpcmU6IFsnXmZvcm0nXSxcclxuICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9mZWJ3b3Jtcy9lZGl0L2NhbnZhcy9maWVsZC9wcm9wZXJ0aWVzL3Byb3BlcnR5LWZpZWxkL2ZpZWxkLXZhbHVlLnRtcGwuaHRtbCcsXHJcbiAgICB0cmFuc2NsdWRlOiB0cnVlLFxyXG4gICAgbGluazogZmVid29ybXNQcm9wZXJ0eUZpZWxkVmFsdWVMaW5rRm5cclxuICB9O1xyXG5cclxufV0pLmZhY3RvcnkoJ2ZlYndvcm1zUHJvcGVydHlGaWVsZFZhbHVlTGlua0ZuJywgWyckcGFyc2UnLCBmdW5jdGlvbigkcGFyc2UpIHtcclxuXHJcbiAgcmV0dXJuIGZ1bmN0aW9uKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgY3RybHMpIHtcclxuXHJcbiAgICAkc2NvcGUuZHJhdyA9IHRydWU7XHJcbiAgICB2YXIgZnJtQ3RybCA9IGN0cmxzWzBdO1xyXG4gICAgdmFyIG9sZFZpZXdWYWx1ZTtcclxuXHJcbiAgICAkc2NvcGUuJHdhdGNoKCdmaWVsZC4kX3JlZHJhdycsIGZ1bmN0aW9uKHZhbHVlKSB7XHJcblxyXG4gICAgICBpZiAodmFsdWUpIHtcclxuXHJcbiAgICAgICAgdmFyIG5nTW9kZWxDdHJsID0gZnJtQ3RybFsnZmllbGRWYWx1ZSddO1xyXG5cclxuICAgICAgICBpZihuZ01vZGVsQ3RybCkge1xyXG4gICAgICAgICAgb2xkVmlld1ZhbHVlID0gbmdNb2RlbEN0cmwuJHZpZXdWYWx1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS5kcmF3ID0gZmFsc2U7XHJcbiAgICAgICAgJHNjb3BlLmZpZWxkLiRfcmVkcmF3ID0gZmFsc2U7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJHNjb3BlLmRyYXcgPSB0cnVlO1xyXG4gICAgICAgICRlbGVtZW50ID0gJGVsZW1lbnQ7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgICRzY29wZS4kd2F0Y2goZnVuY3Rpb24oKSB7IHJldHVybiBmcm1DdHJsWydmaWVsZFZhbHVlJ107IH0sIGZ1bmN0aW9uKG5nTW9kZWxDdHJsKSB7XHJcbiAgICAgIGlmKG5nTW9kZWxDdHJsICYmIG9sZFZpZXdWYWx1ZSkge1xyXG4gICAgICAgIG5nTW9kZWxDdHJsLiRzZXRWaWV3VmFsdWUob2xkVmlld1ZhbHVlKTtcclxuICAgICAgICBuZ01vZGVsQ3RybC4kcmVuZGVyKCk7XHJcbiAgICAgICAgb2xkVmlld1ZhbHVlID0gdW5kZWZpbmVkO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9O1xyXG59XSkuZGlyZWN0aXZlKCdmZWJ3b3Jtc0ZpZWxkUmVkcmF3JywgZnVuY3Rpb24oKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlcXVpcmU6IFsnbmdNb2RlbCddLFxyXG4gICAgbGluazogZnVuY3Rpb24oJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzLCBjdHJscykge1xyXG5cclxuICAgICAgdmFyIG9sZFZhbHVlID0gJHNjb3BlLiRldmFsKCRhdHRycy5uZ01vZGVsKTtcclxuXHJcbiAgICAgICRzY29wZS4kd2F0Y2goJGF0dHJzLm5nTW9kZWwsIGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgaWYodmFsdWUgIT0gb2xkVmFsdWUpIHtcclxuICAgICAgICAgICRzY29wZS5maWVsZC4kX3JlZHJhdyA9IHRydWU7XHJcbiAgICAgICAgICBvbGRWYWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfTtcclxufSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdmZWJ3b3JtcycsIFtcImZlYndvcm1zLnRlbXBsYXRlc1wiXSkuZGlyZWN0aXZlKCdmZWJ3b3Jtc1Byb3BlcnR5RmllbGRDb21tb24nLCBbJ2ZlYndvcm1zUHJvcGVydHlGaWVsZENvbW1vbkxpbmtGbicsIGZ1bmN0aW9uKGZlYndvcm1zUHJvcGVydHlGaWVsZENvbW1vbkxpbmtGbikge1xyXG4gIHJldHVybiB7XHJcbiAgICByZXN0cmljdDogJ0FFJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9mZWJ3b3Jtcy9lZGl0L2NhbnZhcy9maWVsZC9wcm9wZXJ0aWVzL3Byb3BlcnR5LWZpZWxkL2NvbW1vbi50bXBsLmh0bWwnLFxyXG4gICAgbGluazogZmVid29ybXNQcm9wZXJ0eUZpZWxkQ29tbW9uTGlua0ZuXHJcbiAgfTtcclxufV0pLmZhY3RvcnkoJ2ZlYndvcm1zUHJvcGVydHlGaWVsZENvbW1vbkxpbmtGbicsIGZ1bmN0aW9uKCkge1xyXG4gIHJldHVybiBmdW5jdGlvbigkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMsIGN0cmxzKSB7XHJcblxyXG4gICAgJHNjb3BlLmZpZWxkcyA9IHtcclxuICAgICAgZmllbGRuYW1lOiBmYWxzZSxcclxuICAgICAgZGlzcGxheW5hbWU6IGZhbHNlLFxyXG4gICAgICBwbGFjZWhvbGRlcjogZmFsc2UsXHJcbiAgICAgIHRvb2x0aXA6IGZhbHNlLFxyXG4gICAgICBmb2N1czogZmFsc2VcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLiR3YXRjaCgkYXR0cnNbJ2ZlYndvcm1zUHJvcGVydHlGaWVsZENvbW1vbiddLCBmdW5jdGlvbih2YWx1ZSkge1xyXG4gICAgICAkc2NvcGUuZmllbGRzID0gYW5ndWxhci5leHRlbmQoJHNjb3BlLmZpZWxkcywgdmFsdWUpO1xyXG4gICAgfSk7XHJcbiAgfTtcclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2ZlYndvcm1zJywgW1wiZmVid29ybXMudGVtcGxhdGVzXCJdKS5kaXJlY3RpdmUoJ2ZlYndvcm1zUHJvcGVydHlGaWVsZE9wdGlvbnMnLCBbJ2ZlYndvcm1zUHJvcGVydHlGaWVsZE9wdGlvbnNMaW5rRm4nLCBmdW5jdGlvbihmZWJ3b3Jtc1Byb3BlcnR5RmllbGRPcHRpb25zTGlua0ZuKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHNjb3BlOiB0cnVlLFxyXG4gICAgY29udHJvbGxlcjogJ2ZlYndvcm1zUHJvcGVydHlGaWVsZE9wdGlvbnNDb250cm9sbGVyIGFzIG9wdGlvbnNDdHJsJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9mZWJ3b3Jtcy9lZGl0L2NhbnZhcy9maWVsZC9wcm9wZXJ0aWVzL29wdGlvbnMvb3B0aW9ucy50bXBsLmh0bWwnLFxyXG4gICAgbGluazogZmVid29ybXNQcm9wZXJ0eUZpZWxkT3B0aW9uc0xpbmtGblxyXG4gIH07XHJcbn1dKS5mYWN0b3J5KCdmZWJ3b3Jtc1Byb3BlcnR5RmllbGRPcHRpb25zTGlua0ZuJywgZnVuY3Rpb24oKSB7XHJcbiAgcmV0dXJuIGZ1bmN0aW9uKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgY3RybHMpIHtcclxuXHJcbiAgICAkc2NvcGUubXVsdGlwbGUgPSBmYWxzZTtcclxuXHJcbiAgICAkYXR0cnMuJG9ic2VydmUoJ2ZlYndvcm1zUHJvcGVydHlGaWVsZE9wdGlvbnMnLCBmdW5jdGlvbih2YWx1ZSkge1xyXG4gICAgICBpZih2YWx1ZSA9PT0gJ211bHRpcGxlJykge1xyXG4gICAgICAgICRzY29wZS5tdWx0aXBsZSA9IHRydWU7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH07XHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdmZWJ3b3JtcycsIFtcImZlYndvcm1zLnRlbXBsYXRlc1wiXSkuY29udHJvbGxlcignZmVid29ybXNQcm9wZXJ0eUZpZWxkT3B0aW9uc0NvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xyXG5cclxuICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgdmFyIG9wdGlvbkNvdW50ZXIgPSAxO1xyXG5cclxuICAvLyBNb25pdG9yIGZvciBjaGFuZ2VzIGluIHRoZSBvcHRpb25zIGFycmF5IGFuZCBlbnN1cmUgYVxyXG4gIC8vIHdhdGNoIGZvciBldmVyeSBvcHRpb24gdmFsdWUuXHJcbiAgLy8gV2F0Y2hlcnMgYXJlIGRlbGV0ZWQgd2hlbiByZW1vdmluZyBvcHRpb25zIGZyb20gdGhlIGFycmF5LlxyXG5cclxuICAkc2NvcGUuJHdhdGNoQ29sbGVjdGlvbignZmllbGQub3B0aW9ucycsIGZ1bmN0aW9uKG9wdGlvbnMpIHtcclxuICAgIGlmIChvcHRpb25zKSB7XHJcbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChvcHRpb25zLCBmdW5jdGlvbihvcHRpb24pIHtcclxuICAgICAgICBpZiAoIW9wdGlvbi4kX3ZhbHVlV2F0Y2hGbikge1xyXG4gICAgICAgICAgb3B0aW9uLiRfdmFsdWVXYXRjaEZuID0gJHNjb3BlLiR3YXRjaChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG9wdGlvbi52YWx1ZTtcclxuICAgICAgICAgIH0sIGhhbmRsZVZhbHVlQ2hhbmdlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICBmdW5jdGlvbiBoYW5kbGVWYWx1ZUNoYW5nZShuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcclxuXHJcbiAgICAvLyBDYWxsZWQgYnkgdGhlIHdhdGNoIGNvbGxlY3Rpb25cclxuICAgIC8vIEVuc3VyZSB0aGF0IHdoZW4gdGhlIHNlbGVjdGVkIHZhbHVlIGlzIGNoYW5nZWQsIHRoaXNcclxuICAgIC8vIGlzIHN5bmNlZCB0byB0aGUgZmllbGQgdmFsdWUuXHJcblxyXG4gICAgaWYgKG5ld1ZhbHVlICE9PSBvbGRWYWx1ZSkge1xyXG4gICAgICBpZiAoJHNjb3BlLm11bHRpcGxlKSB7XHJcbiAgICAgICAgJHNjb3BlLmZpZWxkLnZhbHVlW25ld1ZhbHVlXSA9ICRzY29wZS5maWVsZC52YWx1ZVtvbGRWYWx1ZV07XHJcbiAgICAgICAgZGVsZXRlICRzY29wZS5maWVsZC52YWx1ZVtvbGRWYWx1ZV07XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaWYgKG9sZFZhbHVlID09PSAkc2NvcGUuZmllbGQudmFsdWUpIHtcclxuICAgICAgICAgICRzY29wZS5maWVsZC52YWx1ZSA9IG5ld1ZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgdGhpcy5hZGRPcHRpb24gPSBmdW5jdGlvbigpIHtcclxuXHJcbiAgICBpZiAoISRzY29wZS5maWVsZC5vcHRpb25zKSB7XHJcbiAgICAgICRzY29wZS5maWVsZC5vcHRpb25zID0gW107XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIG9wdGlvbiA9IHtcclxuICAgICAgdmFsdWU6ICdPcHRpb24gJyArIG9wdGlvbkNvdW50ZXIrK1xyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUuZmllbGQub3B0aW9ucy5wdXNoKG9wdGlvbik7XHJcblxyXG4gICAgdmFyIGNvdW50ID0gJHNjb3BlLmZpZWxkLm9wdGlvbnMubGVuZ3RoO1xyXG5cclxuICAgIGlmKCEkc2NvcGUubXVsdGlwbGUgJiYgY291bnQgPT09IDEpIHtcclxuICAgICAgJHNjb3BlLmZpZWxkLnZhbHVlID0gb3B0aW9uLnZhbHVlO1xyXG4gICAgfVxyXG5cclxuICB9O1xyXG5cclxuICB0aGlzLnJlbW92ZU9wdGlvbiA9IGZ1bmN0aW9uKGluZGV4KSB7XHJcbiAgICB2YXIgb3B0aW9ucyA9ICRzY29wZS5maWVsZC5vcHRpb25zLnNwbGljZShpbmRleCwgMSk7XHJcblxyXG4gICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5sZW5ndGgpIHtcclxuXHJcbiAgICAgIHZhciBvcHRpb24gPSBvcHRpb25zWzBdO1xyXG5cclxuICAgICAgaWYgKCRzY29wZS5tdWx0aXBsZSkge1xyXG5cclxuICAgICAgICBpZigkc2NvcGUuZmllbGQudmFsdWVbb3B0aW9uLnZhbHVlXSAhPT0gdW5kZWZpbmVkKVxyXG4gICAgICAgICAgZGVsZXRlICRzY29wZS5maWVsZC52YWx1ZVtvcHRpb24udmFsdWVdO1xyXG5cclxuICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgaWYgKG9wdGlvbi52YWx1ZSA9PT0gJHNjb3BlLmZpZWxkLnZhbHVlICYmICRzY29wZS5maWVsZC5vcHRpb25zLmxlbmd0aCkge1xyXG4gICAgICAgICAgJHNjb3BlLmZpZWxkLnZhbHVlID0gJHNjb3BlLmZpZWxkLm9wdGlvbnNbMF0udmFsdWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBvcHRpb24uJF92YWx1ZVdhdGNoRm4oKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH07XHJcblxyXG59XSk7IiwiYW5ndWxhci5tb2R1bGUoJ2ZlYndvcm1zJywgW1wiZmVid29ybXMudGVtcGxhdGVzXCJdKS5kaXJlY3RpdmUoJ2ZlYndvcm1zRWRpdENhbnZhc0ZpZWxkUHJvcGVydGllcycsIFsnZmVid29ybXNVdGlscycsIGZ1bmN0aW9uIChmZWJ3b3Jtc1V0aWxzKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9mZWJ3b3Jtcy9lZGl0L2NhbnZhcy9maWVsZC9wcm9wZXJ0aWVzL3Byb3BlcnRpZXMudG1wbC5odG1sJyxcclxuICAgIHJlcGxhY2U6IHRydWUsXHJcbiAgICBzY29wZToge1xyXG4gICAgICBmaWVsZDogJz1mZWJ3b3Jtc0VkaXRDYW52YXNGaWVsZFByb3BlcnRpZXMnXHJcbiAgICB9LFxyXG4gICAgbGluazogZnVuY3Rpb24gKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgY3RybHMpIHtcclxuXHJcbiAgICAgICRzY29wZS4kd2F0Y2goJ2ZpZWxkUHJvcGVydGllc0Zvcm0uJGludmFsaWQnLCBmdW5jdGlvbiAobmV3VmFsdWUpIHtcclxuICAgICAgICAkc2NvcGUuZmllbGQuJF9pbnZhbGlkID0gbmV3VmFsdWU7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgJHNjb3BlLnJlbmRlckluZm8gPSBmZWJ3b3Jtc1V0aWxzLmdldFJlbmRlckluZm8oJHNjb3BlLmZpZWxkKTtcclxuICAgIH1cclxuICB9O1xyXG59XSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdmZWJ3b3JtcycsIFtcImZlYndvcm1zLnRlbXBsYXRlc1wiXSkuZGlyZWN0aXZlKCdmZWJ3b3Jtc0VkaXRQYWxldHRlQ2F0ZWdvcmllcycsIGZ1bmN0aW9uICgpIHtcclxuICByZXR1cm4ge1xyXG4gICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2ZlYndvcm1zL2VkaXQvcGFsZXR0ZS9jYXRlZ29yaWVzL2NhdGVnb3JpZXMudG1wbC5odG1sJyxcclxuICAgIHJlcXVpcmU6ICdeZmVid29ybXNFZGl0UGFsZXR0ZScsXHJcbiAgICBzY29wZToge1xyXG4gICAgICBjYXRlZ29yeTogXCI9P1wiXHJcbiAgICB9LFxyXG4gICAgY29udHJvbGxlcjogJ2ZlYndvcm1zRWRpdFBhbGV0dGVDYXRlZ29yaWVzQ29udHJvbGxlcidcclxuICB9O1xyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnZmVid29ybXMnLCBbXCJmZWJ3b3Jtcy50ZW1wbGF0ZXNcIl0pLmNvbnRyb2xsZXIoJ2ZlYndvcm1zRWRpdFBhbGV0dGVDYXRlZ29yaWVzQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJ2ZlYndvcm1zQ29uZmlnJywgZnVuY3Rpb24oJHNjb3BlLCBmZWJ3b3Jtc0NvbmZpZykge1xyXG5cclxuICAkc2NvcGUuY2F0ZWdvcmllcyA9IGZlYndvcm1zQ29uZmlnLmZpZWxkcy5jYXRlZ29yaWVzO1xyXG5cclxuICAkc2NvcGUuc2V0Q2F0ZWdvcnkgPSBmdW5jdGlvbihuYW1lLCBjYXRlZ29yeSkge1xyXG4gICAgJHNjb3BlLmNhdGVnb3J5TmFtZSA9IG5hbWU7XHJcbiAgICAkc2NvcGUuY2F0ZWdvcnkgPSBjYXRlZ29yeTtcclxuICB9O1xyXG59XSk7IiwiYW5ndWxhci5tb2R1bGUoJ2ZlYndvcm1zJywgW1wiZmVid29ybXMudGVtcGxhdGVzXCJdKS5kaXJlY3RpdmUoJ2ZlYndvcm1zRWRpdENhbnZhc0ZpZWxkJywgZnVuY3Rpb24oKSB7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICByZXBsYWNlOiB0cnVlLFxyXG4gICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2ZlYndvcm1zL2VkaXQvY2FudmFzL2ZpZWxkL2ZpZWxkLnRtcGwuaHRtbCdcclxuICB9O1xyXG5cclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2ZlYndvcm1zJywgW1wiZmVid29ybXMudGVtcGxhdGVzXCJdKS5kaXJlY3RpdmUoJ2ZlYndvcm1zU2NoZW1hJywgWydmZWJ3b3Jtc1NjaGVtYUxpbmtGbicsIGZ1bmN0aW9uKGZlYndvcm1zU2NoZW1hTGlua0ZuKSB7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICByZXF1aXJlOiBbJ2ZlYndvcm1zU2NoZW1hJ10sXHJcbiAgICBjb250cm9sbGVyOiAnZmVid29ybXNTY2hlbWFDb250cm9sbGVyJyxcclxuICAgIGxpbms6IGZlYndvcm1zU2NoZW1hTGlua0ZuXHJcbiAgfTtcclxuXHJcbn1dKS5mYWN0b3J5KCdmZWJ3b3Jtc1NjaGVtYUxpbmtGbicgLCBbJyRwYXJzZScsIGZ1bmN0aW9uKCRwYXJzZSkge1xyXG4gIHJldHVybiBmdW5jdGlvbigkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMsIGN0cmxzKSB7XHJcbiAgICB2YXIgc2NoZW1hQ3RybCA9IGN0cmxzWzBdO1xyXG5cclxuICAgIHZhciBnZXRNb2RlbCA9ICRwYXJzZSgkYXR0cnMuZmVid29ybXNTY2hlbWEpO1xyXG4gICAgdmFyIHNldE1vZGVsID0gZ2V0TW9kZWwuYXNzaWduO1xyXG5cclxuICAgIHZhciBtb2RlbCA9IGdldE1vZGVsKCRzY29wZSk7XHJcblxyXG4gICAgc2NoZW1hQ3RybC5tb2RlbChtb2RlbCk7XHJcblxyXG4gICAgJHNjb3BlLiR3YXRjaChmdW5jdGlvbigpIHtcclxuICAgICAgcmV0dXJuIHNjaGVtYUN0cmwubW9kZWwoKTtcclxuICAgIH0sIGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgIHNldE1vZGVsKCRzY29wZSwgdmFsdWUpO1xyXG4gICAgfSk7XHJcbiAgfTtcclxufV0pO1xyXG5cclxuIiwiYW5ndWxhci5tb2R1bGUoJ2ZlYndvcm1zJywgW1wiZmVid29ybXMudGVtcGxhdGVzXCJdKS5jb250cm9sbGVyKCdmZWJ3b3Jtc1NjaGVtYUNvbnRyb2xsZXInLCBbJyRzY29wZScsICdmZWJ3b3Jtc1V0aWxzJywgZnVuY3Rpb24oJHNjb3BlLCBmZWJ3b3Jtc1V0aWxzKSB7XHJcblxyXG4gIHZhciBfbW9kZWwsIHNlbGYgPSB0aGlzO1xyXG5cclxuICB0aGlzLm1vZGVsID0gZnVuY3Rpb24odmFsdWUpIHtcclxuICAgIGlmKHZhbHVlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgX21vZGVsID0gdmFsdWU7XHJcblxyXG4gICAgICBpZighYW5ndWxhci5pc0FycmF5KHZhbHVlLmZpZWxkcykpIHtcclxuICAgICAgICB2YWx1ZS5maWVsZHMgPSBbXTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gX21vZGVsO1xyXG4gIH07XHJcblxyXG4gIHRoaXMuYWRkRmllbGQgPSBmdW5jdGlvbihmaWVsZCwgaW5kZXgpIHtcclxuXHJcbiAgICB2YXIgY29weSA9IGZlYndvcm1zVXRpbHMuY29weUZpZWxkKGZpZWxkKTtcclxuXHJcbiAgICBpbmRleCA9IGluZGV4ID09PSB1bmRlZmluZWQgPyBfbW9kZWwuZmllbGRzLmxlbmd0aCA6IGluZGV4O1xyXG4gICAgX21vZGVsLmZpZWxkcy5zcGxpY2UoaW5kZXgsIDAsIGNvcHkpO1xyXG5cclxuICB9O1xyXG5cclxuICB0aGlzLnJlbW92ZUZpZWxkID0gZnVuY3Rpb24oaW5kZXgpIHtcclxuICAgIF9tb2RlbC5maWVsZHMuc3BsaWNlKGluZGV4LCAxKTtcclxuICB9O1xyXG5cclxuICB0aGlzLnN3YXBGaWVsZHMgPSBmdW5jdGlvbihpZHgxLCBpZHgyKSB7XHJcbiAgICBpZiAoaWR4MSA8PSAtMSB8fCBpZHgyIDw9IC0xIHx8IGlkeDEgPj0gX21vZGVsLmZpZWxkcy5sZW5ndGggfHwgaWR4MiA+PSBfbW9kZWwuZmllbGRzLmxlbmd0aCkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgX21vZGVsLmZpZWxkc1tpZHgxXSA9IF9tb2RlbC5maWVsZHMuc3BsaWNlKGlkeDIsIDEsIF9tb2RlbC5maWVsZHNbaWR4MV0pWzBdO1xyXG4gIH07XHJcblxyXG4gIHRoaXMubW92ZUZpZWxkID0gZnVuY3Rpb24oZnJvbUlkeCwgdG9JZHgpIHtcclxuICAgIGlmIChmcm9tSWR4ID49IDAgJiYgdG9JZHggPD0gX21vZGVsLmZpZWxkcy5sZW5ndGggJiYgZnJvbUlkeCAhPT0gdG9JZHgpIHtcclxuICAgICAgdmFyIGZpZWxkID0gX21vZGVsLmZpZWxkcy5zcGxpY2UoZnJvbUlkeCwgMSlbMF07XHJcbiAgICAgIGlmICh0b0lkeCA+IGZyb21JZHgpLS10b0lkeDtcclxuICAgICAgX21vZGVsLmZpZWxkcy5zcGxpY2UodG9JZHgsIDAsIGZpZWxkKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdmZWJ3b3JtcycsIFtcImZlYndvcm1zLnRlbXBsYXRlc1wiXSkuZGlyZWN0aXZlKCdmZWJ3b3Jtc0Zvcm1GaWVsZHMnLCBmdW5jdGlvbigpIHtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIHJlcXVpcmU6IFsnXmZlYndvcm1zRm9ybSddLFxyXG4gICAgcmVzdHJpY3Q6ICdBRScsXHJcbiAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZmVid29ybXMvZm9ybS9mb3JtLWZpZWxkcy9mb3JtLWZpZWxkcy50bXBsLmh0bWwnLFxyXG4gICAgc2NvcGU6IHt9LFxyXG4gICAgbGluazogZnVuY3Rpb24oJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzLCBjdHJscykge1xyXG5cclxuICAgICAgdmFyIGZlYndvcm1zRm9ybSA9IGN0cmxzWzBdO1xyXG5cclxuICAgICAgJHNjb3BlLiR3YXRjaChmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gZmVid29ybXNGb3JtLm1vZGVsO1xyXG4gICAgICB9LCBmdW5jdGlvbih2YWx1ZSkge1xyXG4gICAgICAgICRzY29wZS5mb3JtID0gdmFsdWU7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnZmVid29ybXMnLCBbXCJmZWJ3b3Jtcy50ZW1wbGF0ZXNcIl0pLmRpcmVjdGl2ZSgnZmVid29ybXNGaWVsZElucHV0JywgWydmZWJ3b3Jtc0ZpZWxkSW5wdXRMaW5rRm4nLCBmdW5jdGlvbihmZWJ3b3Jtc0ZpZWxkSW5wdXRMaW5rRm4pIHtcclxuICByZXR1cm4ge1xyXG4gICAgcmVxdWlyZTogWydeZmVid29ybXNGaWVsZCcsICduZ01vZGVsJ10sXHJcbiAgICBsaW5rOiBmZWJ3b3Jtc0ZpZWxkSW5wdXRMaW5rRm5cclxuICB9O1xyXG59XSkuZmFjdG9yeSgnZmVid29ybXNGaWVsZElucHV0TGlua0ZuJywgZnVuY3Rpb24oKSB7XHJcbiAgcmV0dXJuIGZ1bmN0aW9uKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgY3RybHMpIHtcclxuXHJcbiAgICB2YXIgZmVid29ybXNGaWVsZEN0cmwgPSBjdHJsc1swXTtcclxuICAgIHZhciBuZ01vZGVsQ3RybCA9IGN0cmxzWzFdO1xyXG5cclxuICAgIGZlYndvcm1zRmllbGRDdHJsLnNldEZpZWxkU3RhdGUobmdNb2RlbEN0cmwpO1xyXG4gIH07XHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdmZWJ3b3JtcycsIFtcImZlYndvcm1zLnRlbXBsYXRlc1wiXSkuZGlyZWN0aXZlKCdmZWJ3b3Jtc0ZpZWxkRm9jdXMnLCBbJyRwYXJzZScsIGZ1bmN0aW9uKCRwYXJzZSkge1xyXG4gIHJldHVybiB7XHJcbiAgICByZXF1aXJlOiBbJz9eZmVid29ybXNGb3JtJ10sXHJcbiAgICBsaW5rOiBmdW5jdGlvbigkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMsIGN0cmxzKSB7XHJcblxyXG4gICAgICB2YXIgZm9ybUN0cmwgPSBjdHJsc1swXTtcclxuXHJcbiAgICAgIC8vIGlmKGZvcm1DdHJsICYmIGZvcm1DdHJsLmVkaXRNb2RlKSB7IFxyXG4gICAgICAvLyAgIHJldHVybjsgXHJcbiAgICAgIC8vIH1cclxuXHJcbiAgICAgIHZhciBlID0gJGVsZW1lbnRbMF07XHJcblxyXG4gICAgICB2YXIgZ2V0TW9kZWwgPSAkcGFyc2UoJGF0dHJzLmZlYndvcm1zRmllbGRGb2N1cyk7XHJcbiAgICAgIHZhciBzZXRNb2RlbCA9IGdldE1vZGVsLmFzc2lnbjtcclxuXHJcbiAgICAgICRzY29wZS4kd2F0Y2goZ2V0TW9kZWwsIGZ1bmN0aW9uKHZhbHVlKSB7XHJcblxyXG4gICAgICAgIGlmICh2YWx1ZSkge1xyXG4gICAgICAgICAgaWYoZm9ybUN0cmwpIHtcclxuICAgICAgICAgICAgZm9ybUN0cmwuY2xlYXJGb2N1c09uRmllbGRzKCk7XHJcbiAgICAgICAgICAgIHNldE1vZGVsKCRzY29wZSwgdHJ1ZSk7XHJcblxyXG4gICAgICAgICAgICBpZihmb3JtQ3RybC5lZGl0TW9kZSkge1xyXG4gICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIGUuZm9jdXMoKTtcclxuXHJcbiAgICAgICAgfSBlbHNlIGlmKGZvcm1DdHJsICYmICFmb3JtQ3RybC5lZGl0TW9kZSkge1xyXG5cclxuICAgICAgICAgIGUuYmx1cigpO1xyXG5cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gZnVuY3Rpb24gb25CbHVyKCkge1xyXG4gICAgICAvLyAgIC8vIGlmKGdldE1vZGVsKCRzY29wZSkgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAvLyAgIC8vICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgIC8vICAgLy8gICAgIHNldE1vZGVsKCRzY29wZSwgZmFsc2UpO1xyXG4gICAgICAvLyAgIC8vICAgfSk7XHJcbiAgICAgIC8vICAgLy8gfVxyXG4gICAgICAvLyB9XHJcblxyXG4gICAgICAvLyBmdW5jdGlvbiBvbkZvY3VzKCkge1xyXG4gICAgICAvLyAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAvLyAgICAgc2V0TW9kZWwoJHNjb3BlLCB0cnVlKTtcclxuICAgICAgLy8gICB9KTtcclxuICAgICAgLy8gfVxyXG5cclxuICAgICAgLy8gJGVsZW1lbnQub24oJ2ZvY3VzJywgb25Gb2N1cyk7XHJcbiAgICAgIC8vICRlbGVtZW50Lm9uKCdibHVyJywgb25CbHVyKTtcclxuXHJcbiAgICAgIC8vICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIC8vICAgJGVsZW1lbnQub2ZmKCdmb2N1cycsIG9uRm9jdXMpO1xyXG4gICAgICAvLyAgICRlbGVtZW50Lm9mZignYmx1cicsIG9uQmx1cik7XHJcbiAgICAgIC8vIH0pO1xyXG4gICAgfVxyXG4gIH07XHJcbn1dKTtcclxuIiwiYW5ndWxhci5tb2R1bGUoJ2ZlYndvcm1zJywgW1wiZmVid29ybXMudGVtcGxhdGVzXCJdKS5kaXJlY3RpdmUoJ2ZlYndvcm1zRmllbGQnLCBbJ2ZlYndvcm1zRmllbGRMaW5rRm4nLCBmdW5jdGlvbihmZWJ3b3Jtc0ZpZWxkTGlua0ZuKSB7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICByZXF1aXJlOiBbJ14/ZmVid29ybXNGb3JtJywgJ2ZlYndvcm1zRmllbGQnXSxcclxuICAgIHJlcGxhY2U6IHRydWUsXHJcbiAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZmVid29ybXMvZm9ybS9maWVsZC9maWVsZC50bXBsLmh0bWwnLFxyXG4gICAgc2NvcGU6IHtcclxuICAgICAgZmllbGRTY2hlbWE6ICc9ZmVid29ybXNGaWVsZCcsIC8vIFRoZSBzY2hlbWEgZGVmaW5pdGlvbiBvZiB0aGUgZmllbGRcclxuICAgICAgdGFiSW5kZXg6ICc9P2ZlYndvcm1zVGFiSW5kZXgnLCAvLyBPcHRpb25hbCB0YWIgaW5kZXggLS0gdXNlZCBpbiBvdmVybGF5IG1vZGUgdG8gZGlzYWJsZSBmb2N1c1xyXG4gICAgICBlZGl0TW9kZTogJz0/ZmVid29ybXNFZGl0TW9kZScsIC8vIEluZGljYXRlcyBlZGl0IG1vZGUsIHdoaWNoIHdpbGwgc3luYyB0aGUgZmllbGRTY2hlbWEudmFsdWUgXHJcbiAgICAgIC8vIHRvIHRoZSBmb3JtIGRhdGEgZm9yIFdZU0lXWUcgcGxlYXN1cmVzLlxyXG4gICAgICBub1ZhbGlkYXRpb25TdW1tYXJ5OiAnPWZlYndvcm1zTm9WYWxpZGF0aW9uU3VtbWFyeScgLy8gSWYgdHJ1ZSBoaWRlcyB0aGUgdmFsaWRhdGlvbiBzdW1tYXJ5XHJcbiAgICB9LFxyXG4gICAgY29udHJvbGxlcjogJ2ZlYndvcm1zRmllbGRDb250cm9sbGVyJyxcclxuICAgIGxpbms6IGZlYndvcm1zRmllbGRMaW5rRm5cclxuICB9O1xyXG5cclxufV0pLmZhY3RvcnkoJ2ZlYndvcm1zRmllbGRMaW5rRm4nLCBbJ2ZlYndvcm1zVXRpbHMnLCBmdW5jdGlvbihmZWJ3b3Jtc1V0aWxzKSB7XHJcbiAgcmV0dXJuIGZ1bmN0aW9uKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgY3RybHMpIHtcclxuXHJcbiAgICB2YXIgZmVid29ybXNGb3JtQ3RybCA9IGN0cmxzWzBdO1xyXG4gICAgdmFyIGZlYndvcm1zRmllbGRDdHJsID0gY3RybHNbMV07XHJcblxyXG4gICAgaWYgKCRzY29wZS50YWJJbmRleCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICRzY29wZS50YWJJbmRleCA9ICdhdXRvJztcclxuICAgIH1cclxuXHJcbiAgICAkc2NvcGUucmVuZGVySW5mbyA9IGZlYndvcm1zVXRpbHMuZ2V0UmVuZGVySW5mbygkc2NvcGUuZmllbGRTY2hlbWEpO1xyXG5cclxuICAgIGZlYndvcm1zRmllbGRDdHJsLmluaXQoZmVid29ybXNGb3JtQ3RybCwgJHNjb3BlLmZpZWxkU2NoZW1hLCAkc2NvcGUuZWRpdE1vZGUpO1xyXG4gIH07XHJcbn1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnZmVid29ybXMnLCBbXCJmZWJ3b3Jtcy50ZW1wbGF0ZXNcIl0pLmNvbnRyb2xsZXIoJ2ZlYndvcm1zRmllbGRDb250cm9sbGVyJywgWyckc2NvcGUnLCAnZmVid29ybXNVdGlscycsIGZ1bmN0aW9uKCRzY29wZSwgZmVid29ybXNVdGlscykge1xyXG5cclxuICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgdmFyIF9mb3JtLCBfZmllbGQ7XHJcblxyXG4gIHRoaXMuaW5pdCA9IGZ1bmN0aW9uKGZlYndvcm1zRm9ybUN0cmwsIGZpZWxkU2NoZW1hLCBlZGl0TW9kZSkge1xyXG4gICAgXHJcbiAgICBzZWxmLmluaXRGb3JtKGZlYndvcm1zRm9ybUN0cmwpO1xyXG4gICAgc2VsZi5pbml0RmllbGQoZmllbGRTY2hlbWEpO1xyXG4gICAgc2VsZi5pbml0RGVmYXVsdERhdGEoZmllbGRTY2hlbWEsIGVkaXRNb2RlKTtcclxuXHJcbiAgICAkc2NvcGUuZm9ybSA9IF9mb3JtO1xyXG4gICAgJHNjb3BlLmZpZWxkID0gX2ZpZWxkO1xyXG4gICAgXHJcbiAgfTtcclxuXHJcbiAgdGhpcy5pbml0Rm9ybSA9IGZ1bmN0aW9uKGZlYndvcm1zRm9ybUN0cmwpIHtcclxuICAgIF9mb3JtID0gZmVid29ybXNGb3JtQ3RybCA/IGZlYndvcm1zRm9ybUN0cmwubW9kZWwgOiB7fTtcclxuXHJcbiAgICByZXR1cm4gX2Zvcm07XHJcbiAgfTtcclxuXHJcbiAgdGhpcy5pbml0RmllbGQgPSBmdW5jdGlvbihmaWVsZFNjaGVtYSkge1xyXG5cclxuICAgIF9maWVsZCA9IHtcclxuICAgICAgJF9pZDogJ2lkJyArIGZlYndvcm1zVXRpbHMuZ2V0VW5pcXVlKCksXHJcbiAgICAgIHNjaGVtYTogZmllbGRTY2hlbWFcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLiR3YXRjaCgnZmllbGQuc2NoZW1hLm5hbWUnLCBmdW5jdGlvbih2YWx1ZSwgb2xkVmFsdWUpIHtcclxuICAgICAgc2VsZi5yZWdpc3RlclN0YXRlKHZhbHVlKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBfZmllbGQ7XHJcbiAgfTtcclxuXHJcbiAgdGhpcy5pbml0RGVmYXVsdERhdGEgPSBmdW5jdGlvbihmaWVsZFNjaGVtYSwgZWRpdE1vZGUpIHtcclxuXHJcbiAgICB2YXIgZmllbGROYW1lID0gZmllbGRTY2hlbWEubmFtZTtcclxuXHJcbiAgICBfZm9ybS5kYXRhID0gX2Zvcm0uZGF0YSB8fCB7fTtcclxuICAgIFxyXG4gICAgaWYgKGVkaXRNb2RlKSB7XHJcbiAgICAgIFxyXG4gICAgICAkc2NvcGUuJHdhdGNoKCdmaWVsZC5zY2hlbWEudmFsdWUnLCBmdW5jdGlvbih2YWx1ZSkge1xyXG4gICAgICAgIF9mb3JtLmRhdGFbZmllbGRTY2hlbWEubmFtZV0gPSB2YWx1ZTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAkc2NvcGUuJHdhdGNoKCdmaWVsZC5zY2hlbWEubmFtZScsIGZ1bmN0aW9uKHZhbHVlLCBvbGRWYWx1ZSkge1xyXG4gICAgICAgIGlmKHZhbHVlICE9PSBvbGRWYWx1ZSkge1xyXG4gICAgICAgICAgdmFyIGRhdGEgPSBfZm9ybS5kYXRhW29sZFZhbHVlXTtcclxuICAgICAgICAgIGRlbGV0ZSBfZm9ybS5kYXRhW29sZFZhbHVlXTtcclxuICAgICAgICAgIF9mb3JtLmRhdGFbdmFsdWVdID0gZGF0YTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIH0gZWxzZSBpZiAoX2Zvcm0uZGF0YSAmJiBfZm9ybS5kYXRhW2ZpZWxkTmFtZV0gPT09IHVuZGVmaW5lZCAmJiBmaWVsZFNjaGVtYS52YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIF9mb3JtLmRhdGFbZmllbGROYW1lXSA9IGZpZWxkU2NoZW1hLnZhbHVlO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBfZm9ybS5kYXRhO1xyXG4gIH07XHJcblxyXG4gIHRoaXMuc2V0RmllbGRTdGF0ZSA9IGZ1bmN0aW9uKHN0YXRlKSB7XHJcbiAgICAvLyBDYWxsZWQgYnkgdGhlIGZpZWxkLWlucHV0IGRpcmVjdGl2ZVxyXG4gICAgX2ZpZWxkLnN0YXRlID0gc3RhdGU7XHJcbiAgICBzZWxmLnJlZ2lzdGVyU3RhdGUoX2ZpZWxkLnNjaGVtYS5uYW1lKTtcclxuICB9O1xyXG5cclxuICB0aGlzLnJlZ2lzdGVyU3RhdGUgPSBmdW5jdGlvbihmaWVsZE5hbWUpIHtcclxuICAgIC8vIFJlLXJlZ2lzdGVyIHRoZSBuZ01vZGVsQ3RybCB3aXRoIHRoZSBmb3JtIGNvbnRyb2xsZXJcclxuICAgIC8vIHdoZW5ldmVyIHRoZSBuYW1lIG9mIHRoZSBmaWVsZCBoYXMgYmVlbiBtb2RpZmllZC5cclxuXHJcbiAgICBpZiAoX2Zvcm0uc3RhdGUgJiYgX2ZpZWxkLnN0YXRlKSB7XHJcbiAgICAgIF9mb3JtLnN0YXRlLiRyZW1vdmVDb250cm9sKF9maWVsZC5zdGF0ZSk7XHJcbiAgICAgIF9maWVsZC5zdGF0ZS4kbmFtZSA9IGZpZWxkTmFtZTtcclxuICAgICAgX2Zvcm0uc3RhdGUuJGFkZENvbnRyb2woX2ZpZWxkLnN0YXRlKTtcclxuICAgIH1cclxuXHJcbiAgICBfZmllbGQubmFtZSA9IGZpZWxkTmFtZTtcclxuXHJcbiAgfTtcclxuXHJcbiAgdGhpcy5maWVsZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIF9maWVsZDtcclxuICB9O1xyXG5cclxuICB0aGlzLmZvcm0gPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBfZm9ybTtcclxuICB9O1xyXG59XSk7IiwiYW5ndWxhci5tb2R1bGUoJ2ZlYndvcm1zJywgW1wiZmVid29ybXMudGVtcGxhdGVzXCJdKS5kaXJlY3RpdmUoJ2ZlYndvcm1zRWRpdFBhbGV0dGUnLGZ1bmN0aW9uICgpIHtcclxuICByZXR1cm4ge1xyXG4gICAgcmVxdWlyZTogWydeZmVid29ybXNTY2hlbWEnXSxcclxuICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9mZWJ3b3Jtcy9lZGl0L3BhbGV0dGUvcGFsZXR0ZS50bXBsLmh0bWwnLFxyXG4gICAgY29udHJvbGxlcjogJ2ZlYndvcm1zRWRpdFBhbGV0dGVDb250cm9sbGVyJyxcclxuICAgIGxpbms6IGZ1bmN0aW9uKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgY3RybHMpIHtcclxuICAgICAgJHNjb3BlLnNjaGVtYUN0cmwgPSBjdHJsc1swXTtcclxuICAgIH1cclxuICB9O1xyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnZmVid29ybXMnLCBbXCJmZWJ3b3Jtcy50ZW1wbGF0ZXNcIl0pLmNvbnRyb2xsZXIoJ2ZlYndvcm1zRWRpdFBhbGV0dGVDb250cm9sbGVyJywgWyckc2NvcGUnLCAnZmVid29ybXNDb25maWcnLCBmdW5jdGlvbiAoJHNjb3BlLCBmZWJ3b3Jtc0NvbmZpZykge1xyXG5cclxuICAkc2NvcGUudGVtcGxhdGVzID0gYW5ndWxhci5jb3B5KGZlYndvcm1zQ29uZmlnLmZpZWxkcy50ZW1wbGF0ZXMpO1xyXG5cclxuICB2YXIgY291bnQgPSAwO1xyXG5cclxuICAkc2NvcGUudGVtcGxhdGVGaWx0ZXIgPSBmdW5jdGlvbiAodGVtcGxhdGUpIHtcclxuICAgIHJldHVybiAhJHNjb3BlLnNlbGVjdGVkQ2F0ZWdvcnkgfHwgJHNjb3BlLnNlbGVjdGVkQ2F0ZWdvcnlbdGVtcGxhdGUudHlwZV07XHJcbiAgfTtcclxuXHJcbn1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnZmVid29ybXMnLCBbXCJmZWJ3b3Jtcy50ZW1wbGF0ZXNcIl0pLmRpcmVjdGl2ZSgnZmVid29ybXNFZGl0Rm9ybUFjdGlvbnMnLCBbJ2ZlYndvcm1zQ29uZmlnJywgZnVuY3Rpb24oZmVid29ybXNDb25maWcpIHtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIHJlcXVpcmU6ICdeZmVid29ybXNFZGl0JyxcclxuICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9mZWJ3b3Jtcy9lZGl0L2Zvcm0tYWN0aW9ucy9mb3JtLWFjdGlvbnMudG1wbC5odG1sJyxcclxuICAgIGxpbms6IGZ1bmN0aW9uKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgZmVid29ybXNFZGl0Q29udHJvbGxlcikge1xyXG5cclxuICAgICAgJHNjb3BlLmRlYnVnSW5mb0VuYWJsZWQgPSBmZWJ3b3Jtc0NvbmZpZy5lbmFibGVEZWJ1Z0luZm87XHJcblxyXG4gICAgICAkc2NvcGUudG9nZ2xlUHJldmlldyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmKCEkc2NvcGUuc2NoZW1hLiRfaW52YWxpZCkge1xyXG4gICAgICAgICAgZmVid29ybXNFZGl0Q29udHJvbGxlci50b2dnbGVQcmV2aWV3KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgJHNjb3BlLmhhbmRsZVNhdmUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZighJHNjb3BlLnNjaGVtYS4kX2ludmFsaWQpIHtcclxuICAgICAgICAgICRzY29wZS5vblNhdmUoeyBzY2hlbWE6ICRzY29wZS5zY2hlbWEgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgJHNjb3BlLmhhbmRsZUNhbmNlbCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICRzY29wZS5vbkNhbmNlbCh7IHNjaGVtYTogJHNjb3BlLnNjaGVtYSB9KTtcclxuICAgICAgfTtcclxuXHJcbiAgICB9XHJcbiAgfTtcclxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdmZWJ3b3JtcycsIFtcImZlYndvcm1zLnRlbXBsYXRlc1wiXSkuZGlyZWN0aXZlKCdmZWJ3b3Jtc0VkaXRDYW52YXMnLCBmdW5jdGlvbigpIHtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIHJlcXVpcmU6IFsnXmZlYndvcm1zRWRpdCcsICdeZmVid29ybXNTY2hlbWEnXSxcclxuICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9mZWJ3b3Jtcy9lZGl0L2NhbnZhcy9jYW52YXMudG1wbC5odG1sJyxcclxuICAgIGNvbnRyb2xsZXI6ICdmZWJ3b3Jtc0VkaXRDYW52YXNDb250cm9sbGVyIGFzIGNhbnZhc0N0cmwnLFxyXG4gICAgbGluazogZnVuY3Rpb24oJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzLCBjdHJscykge1xyXG4gICAgICAkc2NvcGUuZWRpdEN0cmwgPSBjdHJsc1swXTtcclxuICAgICAgJHNjb3BlLnNjaGVtYUN0cmwgPSBjdHJsc1sxXTtcclxuXHJcbiAgICAgIC8vICRzY29wZS5mb3JtTW9kZWwgPSB7fTsgLy8gRHVtbXkgZm9ybU1vZGVsIGZvciBXWVNJV1lHIHBsZWFzdXJlc1xyXG4gICAgfVxyXG4gIH07XHJcbn0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgnZmVid29ybXMnLCBbXCJmZWJ3b3Jtcy50ZW1wbGF0ZXNcIl0pLmNvbnRyb2xsZXIoJ2ZlYndvcm1zRWRpdENhbnZhc0NvbnRyb2xsZXInLCBbJyRzY29wZScsICdkcVV0aWxzJywgJyR0aW1lb3V0JywgJ2ZlYndvcm1zVXRpbHMnLCBmdW5jdGlvbiAoJHNjb3BlLCBkcVV0aWxzLCAkdGltZW91dCwgZmVid29ybXNVdGlscykge1xyXG5cclxuICAkc2NvcGUuZHJhZ1BsYWNlaG9sZGVyID0ge1xyXG4gICAgdmlzaWJsZTogZmFsc2UsXHJcbiAgICBpbmRleDogMFxyXG4gIH07XHJcblxyXG4gIC8vIC0gLSAtIDgtPCAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxyXG4gIC8vIERyYWcgJiBkcm9wXHJcbiAgLy8gLSAtIC0gOC08IC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXHJcblxyXG4gIHRoaXMuZHJhZ0VudGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgJHNjb3BlLmRyYWdQbGFjZWhvbGRlci52aXNpYmxlID0gdHJ1ZTtcclxuICAgICRzY29wZS5kcmFnUGxhY2Vob2xkZXIuaW5kZXggPSAkc2NvcGUuc2NoZW1hLmZpZWxkcy5sZW5ndGg7XHJcbiAgfTtcclxuXHJcbiAgdGhpcy5kcmFnTGVhdmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAkc2NvcGUuZHJhZ1BsYWNlaG9sZGVyLnZpc2libGUgPSBmYWxzZTtcclxuICB9O1xyXG5cclxuICB0aGlzLmRyYWdCZWdpbkNhbnZhc0ZpZWxkID0gZnVuY3Rpb24gKGluZGV4LCBmaWVsZCkge1xyXG5cclxuICAgIC8vIERlbGF5IGlzIHNldCB0byBwcmV2ZW50IGJyb3dzZXIgZnJvbSBjb3B5aW5nIGFkanVzdGVkIGh0bWwgYXMgY29weSBpbWFnZVxyXG5cclxuICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgZmllbGQuJF9pc0RyYWdnaW5nID0gdHJ1ZTtcclxuICAgIH0sIDEpO1xyXG5cclxuICAgIHJldHVybiB7IHNvdXJjZTogJ2NhbnZhcycsIGZpZWxkOiBmaWVsZCwgaW5kZXg6IGluZGV4IH07XHJcbiAgfTtcclxuXHJcbiAgdGhpcy5kcmFnRW5kQ2FudmFzRmllbGQgPSBmdW5jdGlvbiAoZmllbGQpIHtcclxuXHJcbiAgICAvLyBJRSBGaXg6IGVuc3VyZSB0aGlzIGlzIGZpcmVkIGFmdGVyIHRoZSBkcmFnIGJlZ2luXHJcblxyXG4gICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICBmaWVsZC4kX2lzRHJhZ2dpbmcgPSBmYWxzZTtcclxuICAgIH0sIDEwKTtcclxuICB9O1xyXG5cclxuICB0aGlzLmRyb3AgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgdmFyIGRyYWdEYXRhID0gZHFVdGlscy5kcmFnRGF0YSgpO1xyXG5cclxuICAgIGlmIChkcmFnRGF0YSAmJiBkcmFnRGF0YS5kYXRhKSB7XHJcblxyXG4gICAgICB2YXIgZmllbGQgPSBkcmFnRGF0YS5kYXRhLmZpZWxkO1xyXG4gICAgICB2YXIgc291cmNlID0gZHJhZ0RhdGEuZGF0YS5zb3VyY2U7XHJcbiAgICAgIHZhciBpbmRleCA9IGRyYWdEYXRhLmRhdGEuaW5kZXg7XHJcbiAgICAgIHZhciBmaWVsZHMgPSAkc2NvcGUuc2NoZW1hLmZpZWxkcztcclxuXHJcbiAgICAgIGlmIChzb3VyY2UgPT0gJ3BhbGV0dGUnKSB7XHJcbiAgICAgICAgJHNjb3BlLnNjaGVtYUN0cmwuYWRkRmllbGQoZmllbGQsICRzY29wZS5kcmFnUGxhY2Vob2xkZXIuaW5kZXgpO1xyXG4gICAgICB9IGVsc2UgaWYgKHNvdXJjZSA9PSAnY2FudmFzJykge1xyXG4gICAgICAgICRzY29wZS5zY2hlbWFDdHJsLm1vdmVGaWVsZChpbmRleCwgJHNjb3BlLmRyYWdQbGFjZWhvbGRlci5pbmRleCk7XHJcbiAgICAgICAgLy8gZmllbGRzLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgLy8gZmllbGRzLnNwbGljZSgkc2NvcGUuZHJhZ1BsYWNlaG9sZGVyLmluZGV4LCAwLCBmaWVsZCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIElFIGZpeDogbm90IGNhbGxpbmcgZHJhZ0VuZCBzb21ldGltZXNcclxuICAgICAgZmllbGQuJF9pc0RyYWdnaW5nID0gZmFsc2U7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aHJvdyBFcnJvcignRHJvcCB3aXRob3V0IGRhdGEnKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdmZWJ3b3JtcycsIFtcImZlYndvcm1zLnRlbXBsYXRlc1wiXSkuZGlyZWN0aXZlKCdmZWJ3b3Jtc1RhYnNQYW5lJywgWydmZWJ3b3Jtc1RhYnNQYW5lTGlua0ZuJywgZnVuY3Rpb24oZmVid29ybXNUYWJzUGFuZUxpbmtGbikge1xyXG4gIHJldHVybiB7XHJcbiAgICByZXF1aXJlOiBbJ2ZlYndvcm1zVGFic1BhbmUnLCAnXmZlYndvcm1zVGFicyddLFxyXG4gICAgcmVzdHJpY3Q6ICdFQScsXHJcbiAgICBzY29wZTogdHJ1ZSxcclxuICAgIHRyYW5zY2x1ZGU6IHRydWUsXHJcbiAgICBjb250cm9sbGVyOiAnZmVid29ybXNUYWJzUGFuZUNvbnRyb2xsZXInLFxyXG4gICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2ZlYndvcm1zL2NvbW1vbi90YWJzL3RhYnMtcGFuZS50bXBsLmh0bWwnLFxyXG4gICAgbGluazogZmVid29ybXNUYWJzUGFuZUxpbmtGblxyXG4gIH07XHJcbn1dKS5mYWN0b3J5KCdmZWJ3b3Jtc1RhYnNQYW5lTGlua0ZuJywgZnVuY3Rpb24oKSB7XHJcbiAgcmV0dXJuIGZ1bmN0aW9uKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgY3RybHMpIHtcclxuICAgIFxyXG4gICAgdmFyIHBhbmVDdHJsID0gY3RybHNbMF07XHJcbiAgICB2YXIgdGFic0N0cmwgPSBjdHJsc1sxXTtcclxuICAgIFxyXG4gICAgLy8gVGhpcyBpcyBkb25lIGhlcmUgc2luY2UgYW5ndWxhciBkb2Vzbid0IGFsbG93ICQgaW4gdGhlICdjb250cm9sbGVyIGFzJ1xyXG4gICAgLy8gc3ludGF4LlxyXG4gIFxyXG4gICAgJHNjb3BlLiRfcGFuZUN0cmwgPSBwYW5lQ3RybDtcclxuICAgIFxyXG4gICAgJGF0dHJzLiRvYnNlcnZlKCdmZWJ3b3Jtc1RhYnNQYW5lJywgZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgcGFuZUN0cmwudGl0bGUgPSB2YWx1ZTsgIFxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIHRhYnNDdHJsLmFkZFBhbmUocGFuZUN0cmwpO1xyXG4gIH07XHJcbn0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgnZmVid29ybXMnLCBbXCJmZWJ3b3Jtcy50ZW1wbGF0ZXNcIl0pLmNvbnRyb2xsZXIoJ2ZlYndvcm1zVGFic1BhbmVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpIHt9XSk7IiwiYW5ndWxhci5tb2R1bGUoJ2ZlYndvcm1zJywgW1wiZmVid29ybXMudGVtcGxhdGVzXCJdKS5kaXJlY3RpdmUoJ2ZlYndvcm1zVGFicycsIGZ1bmN0aW9uKCkge1xyXG4gIHJldHVybiB7XHJcbiAgICByZXF1aXJlOiBbJ2ZlYndvcm1zVGFicyddLFxyXG4gICAgcmVzdHJpY3Q6ICdFQScsXHJcbiAgICB0cmFuc2NsdWRlOiB0cnVlLFxyXG4gICAgY29udHJvbGxlcjogJ2ZlYndvcm1zVGFic0NvbnRyb2xsZXInLFxyXG4gICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2ZlYndvcm1zL2NvbW1vbi90YWJzL3RhYnMudG1wbC5odG1sJyxcclxuICAgIGxpbms6IGZ1bmN0aW9uKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgY3RybHMpIHtcclxuICAgICAgXHJcbiAgICAgIC8vIFRoaXMgaXMgZG9uZSBoZXJlIHNpbmNlIGFuZ3VsYXIgZG9lc24ndCBhbGxvdyAkIGluIHRoZSAnY29udHJvbGxlciBhcydcclxuICAgICAgLy8gc3ludGF4LlxyXG4gICAgICBcclxuICAgICAgJHNjb3BlLiRfdGFiQ3RybCA9IGN0cmxzWzBdO1xyXG4gICAgfVxyXG4gIH07XHJcbn0pO1xyXG5cclxuXHJcblxyXG4iLCJhbmd1bGFyLm1vZHVsZSgnZmVid29ybXMnLCBbXCJmZWJ3b3Jtcy50ZW1wbGF0ZXNcIl0pLmNvbnRyb2xsZXIoJ2ZlYndvcm1zVGFic0NvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xyXG4gIFxyXG4gIHZhciBzZWxmID0gdGhpcztcclxuICB0aGlzLnBhbmVzID0gW107XHJcbiAgXHJcbiAgdGhpcy5hZGRQYW5lID0gZnVuY3Rpb24ocGFuZSkge1xyXG4gICAgc2VsZi5wYW5lcy5wdXNoKHBhbmUpO1xyXG4gICAgXHJcbiAgICBpZihzZWxmLnBhbmVzLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICBzZWxmLmFjdGl2ZShwYW5lKTtcclxuICAgIH1cclxuICB9O1xyXG4gIFxyXG4gIHRoaXMuYWN0aXZlID0gZnVuY3Rpb24ocGFuZSkge1xyXG4gICAgYW5ndWxhci5mb3JFYWNoKHNlbGYucGFuZXMsIGZ1bmN0aW9uKHBhbmUpIHtcclxuICAgICAgcGFuZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBwYW5lLmFjdGl2ZSA9IHRydWU7XHJcbiAgfTtcclxufV0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgnZmVid29ybXMnLCBbXCJmZWJ3b3Jtcy50ZW1wbGF0ZXNcIl0pLmZpbHRlcignaiRvbicsZnVuY3Rpb24gKCkge1xyXG4gIHJldHVybiBmdW5jdGlvbiAoaW5wdXQsIGRpc3BsYXlIaWRkZW4pIHtcclxuXHJcbiAgICBpZihkaXNwbGF5SGlkZGVuKVxyXG4gICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoaW5wdXQgfHwge30sIG51bGwsICcgICcpO1xyXG5cclxuICAgIHJldHVybiBhbmd1bGFyLnRvSnNvbihpbnB1dCB8fCB7fSwgdHJ1ZSk7XHJcbiAgfTtcclxufSkuZGlyZWN0aXZlKCdqc29uaWZ5JywgWyckd2luZG93JywgJyRmaWx0ZXInLCBmdW5jdGlvbiAoJHdpbmRvdywgJGZpbHRlcikge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdGVtcGxhdGVVcmw6ICdjb21wb25lbnRzL2ZlYndvcm1zL2NvbW1vbi9qc29uaWZ5L2pzb25pZnkudG1wbC5odG1sJyxcclxuICAgICAgcmVwbGFjZTogdHJ1ZSxcclxuICAgICAgc2NvcGU6IHtcclxuICAgICAgICBqc29uaWZ5OiBcIj1cIixcclxuICAgICAgICBkaXNwbGF5SGlkZGVuOiBcIkBqc29uaWZ5RGlzcGxheUhpZGRlblwiXHJcbiAgICAgIH0sXHJcbiAgICAgIGxpbms6IGZ1bmN0aW9uKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgY3RybHMpIHtcclxuICAgICAgICAkc2NvcGUuZXhwcmVzc2lvbiA9ICRhdHRycy5qc29uaWZ5O1xyXG5cclxuICAgICAgICAkc2NvcGUuY29weSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgJHdpbmRvdy5wcm9tcHQgKFwiQ29weSB0byBjbGlwYm9hcmQ6IEN0cmwrQywgRW50ZXJcIiwgJGZpbHRlcignaiRvbicpKCRzY29wZS5qc29uaWZ5LCAkc2NvcGUuZGlzcGxheUhpZGRlbikpO1xyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgfV0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgnZmVid29ybXMnLCBbXCJmZWJ3b3Jtcy50ZW1wbGF0ZXNcIl0pLmRpcmVjdGl2ZSgnZmVid29ybXNVbmlxdWVGaWVsZE5hbWUnLCBmdW5jdGlvbiAoKSB7XHJcblxyXG4gIHZhciBjaGFuZ2VUaWNrID0gMDtcclxuXHJcbiAgZnVuY3Rpb24gdmFsaWRhdGUobmdNb2RlbEN0cmwsIHNjaGVtYUN0cmwsIGZpZWxkKSB7XHJcbiAgICBcclxuICAgIHZhciBzY2hlbWEgPSBzY2hlbWFDdHJsLm1vZGVsKCk7XHJcbiAgICB2YXIgdmFsaWQgPSB0cnVlO1xyXG4gICAgdmFyIHNjaGVtYUZpZWxkO1xyXG5cclxuICAgIGlmKHNjaGVtYSkge1xyXG5cclxuICAgICAgdmFyIGZpZWxkcyA9IHNjaGVtYS5maWVsZHM7XHJcblxyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZpZWxkcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIHNjaGVtYUZpZWxkID0gZmllbGRzW2ldO1xyXG4gICAgICAgIGlmIChzY2hlbWFGaWVsZCAhPT0gZmllbGQgJiYgZmllbGQubmFtZSA9PT0gc2NoZW1hRmllbGQubmFtZSkge1xyXG4gICAgICAgICAgdmFsaWQgPSBmYWxzZTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG5nTW9kZWxDdHJsLiRzZXRWYWxpZGl0eSgndW5pcXVlJywgdmFsaWQpO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIHByaW9yaXR5OiAxMDAsXHJcbiAgICByZXF1aXJlOiBbJ25nTW9kZWwnLCAnXmZlYndvcm1zU2NoZW1hJ10sXHJcbiAgICBsaW5rOiBmdW5jdGlvbiAoJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzLCBjdHJscykge1xyXG5cclxuICAgICAgdmFyIG5nTW9kZWxDdHJsID0gY3RybHNbMF07XHJcbiAgICAgIHZhciBzY2hlbWFDdHJsID0gY3RybHNbMV07XHJcbiAgICAgIFxyXG4gICAgICB2YXIgZmllbGQgPSAkc2NvcGUuZmllbGQ7XHJcblxyXG4gICAgICBpZighZmllbGQpIHtcclxuICAgICAgICB0aHJvdyBFcnJvcignTm8gZmllbGQgcHJvcGVydHkgb24gc2NvcGUnKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgJHNjb3BlLiR3YXRjaChmdW5jdGlvbigpIHsgcmV0dXJuIG5nTW9kZWxDdHJsLiRtb2RlbFZhbHVlOyB9LCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gRXZlcnkgaW5zdGFuY2Ugb2YgdGhpcyBkaXJlY3RpdmUgd2lsbCBpbmNyZW1lbnQgY2hhbmdlVGlja1xyXG4gICAgICAgIC8vIHdoZW5ldmVyIHRoZSBuYW1lIG9mIHRoZSBhc3NvY2lhdGVkIGZpZWxkIGlzIG1vZGlmaWVkLlxyXG5cclxuICAgICAgICArK2NoYW5nZVRpY2s7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgJHNjb3BlLiR3YXRjaChmdW5jdGlvbigpIHsgcmV0dXJuIGNoYW5nZVRpY2s7IH0sIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAvLyBFdmVyeSBpbnN0YW5jZSBvZiB0aGlzIGRpcmVjdGl2ZSB3aWxsIGZpcmUgb2ZmIHRoZSB2YWxpZGF0aW9uXHJcbiAgICAgICAgLy8gd2hlbmV2ZXIgdGhlIGNoYW5nZVRpY2sgaGFzIGJlZW4gbW9kaWZlZC5cclxuXHJcbiAgICAgICAgdmFsaWRhdGUobmdNb2RlbEN0cmwsIHNjaGVtYUN0cmwsIGZpZWxkKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfTtcclxufSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdmZWJ3b3JtcycsIFtcImZlYndvcm1zLnRlbXBsYXRlc1wiXSkuZGlyZWN0aXZlKCdmZWJ3b3Jtc1ZhbGlkYXRpb25TdW1tYXJ5JywgWydmZWJ3b3Jtc1ZhbGlkYXRpb25TdW1tYXJ5TGlua0ZuJywgZnVuY3Rpb24oZmVid29ybXNWYWxpZGF0aW9uU3VtbWFyeUxpbmtGbikge1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgcmVxdWlyZTogWydeP2ZlYndvcm1zRmllbGQnLCAnXj9mb3JtJ10sXHJcbiAgICB0ZW1wbGF0ZVVybDogJ2NvbXBvbmVudHMvZmVid29ybXMvdmFsaWRhdGlvbi9zdW1tYXJ5LnRtcGwuaHRtbCcsXHJcbiAgICBzY29wZToge1xyXG4gICAgICBmaWVsZE5hbWU6ICdAP2ZlYndvcm1zVmFsaWRhdGlvblN1bW1hcnknLFxyXG4gICAgICB2YWxpZGF0aW9uTWVzc2FnZXM6ICc9P2ZlYndvcm1zVmFsaWRhdGlvbk1lc3NhZ2VzJ1xyXG4gICAgfSxcclxuICAgIGxpbms6IGZlYndvcm1zVmFsaWRhdGlvblN1bW1hcnlMaW5rRm5cclxuICB9O1xyXG59XSkuZmFjdG9yeSgnZmVid29ybXNWYWxpZGF0aW9uU3VtbWFyeUxpbmtGbicsIFsnZmVid29ybXNDb25maWcnLCBmdW5jdGlvbihmZWJ3b3Jtc0NvbmZpZykge1xyXG5cclxuICByZXR1cm4gZnVuY3Rpb24oJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzLCBjdHJscykge1xyXG5cclxuICAgIHZhciBmZWJ3b3Jtc0ZpZWxkQ3RybCA9IGN0cmxzWzBdO1xyXG4gICAgdmFyIG5nRm9ybUNvbnRyb2xsZXIgPSBjdHJsc1sxXTtcclxuXHJcbiAgICBpZiAoZmVid29ybXNGaWVsZEN0cmwpIHtcclxuICAgICAgLy8gR3JhYiB0aGUgd2hvbGUgZmllbGQgc3RhdGUgZnJvbSB0aGUgZmllbGQgY29udHJvbGxlclxyXG4gICAgICAkc2NvcGUuZmllbGQgPSBmZWJ3b3Jtc0ZpZWxkQ3RybC5maWVsZCgpO1xyXG4gICAgICAkc2NvcGUuZm9ybSA9IGZlYndvcm1zRmllbGRDdHJsLmZvcm0oKTtcclxuXHJcbiAgICB9IGVsc2UgaWYgKG5nRm9ybUNvbnRyb2xsZXIpIHtcclxuICAgICAgXHJcbiAgICAgICRzY29wZS5mb3JtID0ge1xyXG4gICAgICAgIHN0YXRlOiBuZ0Zvcm1Db250cm9sbGVyXHJcbiAgICAgIH07XHJcblxyXG4gICAgICAkc2NvcGUuJHdhdGNoKCdmaWVsZE5hbWUnLCBmdW5jdGlvbih2YWx1ZSkge1xyXG4gICAgICAgICRzY29wZS5maWVsZCA9IHtcclxuICAgICAgICAgIG5hbWU6IHZhbHVlLFxyXG4gICAgICAgICAgc3RhdGU6IG5nRm9ybUNvbnRyb2xsZXJbdmFsdWVdXHJcbiAgICAgICAgfTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gV2hlbmV2ZXIgdGhlIGZvcm0gZGVzaWduZXIgZWRpdHMgYSBjdXN0b20gbWVzc2FnZSBidXQgZGVjaWRlcyB0byBkZWxldGUgaXQgbGF0ZXIgYSBcIlwiIGlzIGxlZnRvdmVyLlxyXG4gICAgLy8gSSBkb24ndCBmZWVsIGxpa2Ugc2V0dGluZyBhbGwga2luZHMgb2Ygd2F0Y2hlcnMgc28gd2UnbGwgZml4IHRoYXQgaGVyZVxyXG5cclxuICAgIGlmKCRzY29wZS52YWxpZGF0aW9uTWVzc2FnZXMpIHtcclxuICAgICAgYW5ndWxhci5mb3JFYWNoKCRzY29wZS52YWxpZGF0aW9uTWVzc2FnZXMsIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcclxuICAgICAgICBpZighdmFsdWUpIHtcclxuICAgICAgICAgIGRlbGV0ZSAkc2NvcGUudmFsaWRhdGlvbk1lc3NhZ2VzW2tleV07XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAkc2NvcGUubWVzc2FnZXMgPSBhbmd1bGFyLmV4dGVuZCh7fSwgZmVid29ybXNDb25maWcudmFsaWRhdGlvbi5tZXNzYWdlcywgJHNjb3BlLnZhbGlkYXRpb25NZXNzYWdlcyk7XHJcbiAgfTtcclxuXHJcbn1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnZmVid29ybXMnLCBbXCJmZWJ3b3Jtcy50ZW1wbGF0ZXNcIl0pLmRpcmVjdGl2ZSgnZmVid29ybXNGb3JtJywgWydmZWJ3b3Jtc0Zvcm1Db21waWxlRm4nLCBmdW5jdGlvbihmZWJ3b3Jtc0Zvcm1Db21waWxlRm4pIHtcclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdBRScsXHJcbiAgICByZXF1aXJlOiBbJ14/Zm9ybScsICdmZWJ3b3Jtc0Zvcm0nLCAnXmZlYndvcm1zU2NoZW1hJ10sXHJcbiAgICBjb250cm9sbGVyOiAnZmVid29ybXNGb3JtQ29udHJvbGxlcicsXHJcbiAgICBzY29wZTogdHJ1ZSxcclxuICAgIGNvbXBpbGU6IGZlYndvcm1zRm9ybUNvbXBpbGVGblxyXG4gIH07XHJcbn1dKS5mYWN0b3J5KCdmZWJ3b3Jtc0Zvcm1MaW5rRm4nLCBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiBsaW5rKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgY3RybHMpIHtcclxuXHJcbiAgICAgIHZhciBuZ0Zvcm1DdHJsID0gY3RybHNbMF07XHJcbiAgICAgIHZhciBmb3JtQ3RybCA9IGN0cmxzWzFdO1xyXG4gICAgICB2YXIgc2NoZW1hQ3RybCA9IGN0cmxzWzJdO1xyXG5cclxuICAgICAgdmFyIGVkaXRNb2RlID0gJGF0dHJzLmZlYndvcm1zTm9SZW5kZXIgPT09ICd0cnVlJztcclxuXHJcbiAgICAgIGZvcm1DdHJsLmluaXQoJGF0dHJzLmZlYndvcm1zRm9ybURhdGEsIHNjaGVtYUN0cmwsIG5nRm9ybUN0cmwsIGVkaXRNb2RlKTtcclxuICAgICAgXHJcbiAgICB9O1xyXG59KS5mYWN0b3J5KCdmZWJ3b3Jtc0Zvcm1Db21waWxlRm4nLCBbJ2ZlYndvcm1zRm9ybUxpbmtGbicsIGZ1bmN0aW9uKGZlYndvcm1zRm9ybUxpbmtGbikge1xyXG4gIHJldHVybiBmdW5jdGlvbigkZWxlbWVudCwgJGF0dHJzKSB7XHJcblxyXG4gICAgdmFyIG5vUmVuZGVyID0gJGF0dHJzLmZlYndvcm1zTm9SZW5kZXI7XHJcbiAgICBcclxuICAgIGlmIChub1JlbmRlciAhPT0gJ3RydWUnKSB7XHJcbiAgICAgIHZhciByZW5kZXJUZW1wbGF0ZSA9ICc8ZGl2IGZlYndvcm1zLWZvcm0tZmllbGRzPjwvZGl2Pic7XHJcbiAgICAgICRlbGVtZW50LmFwcGVuZChyZW5kZXJUZW1wbGF0ZSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBmZWJ3b3Jtc0Zvcm1MaW5rRm47XHJcbiAgfTtcclxufV0pO1xyXG5cclxuIiwiYW5ndWxhci5tb2R1bGUoJ2ZlYndvcm1zJywgW1wiZmVid29ybXMudGVtcGxhdGVzXCJdKS5jb250cm9sbGVyKCdmZWJ3b3Jtc0Zvcm1Db250cm9sbGVyJywgWyckc2NvcGUnLCAnJHBhcnNlJywgZnVuY3Rpb24oJHNjb3BlLCAkcGFyc2UpIHtcclxuXHJcbiAgdGhpcy5tb2RlbCA9IHt9O1xyXG4gIHZhciBzZWxmID0gdGhpcztcclxuXHJcbiAgdGhpcy5pbml0ID0gZnVuY3Rpb24oZGF0YUV4cHJlc3Npb24sIHNjaGVtYSwgc3RhdGUsIGVkaXRNb2RlKSB7XHJcbiAgICAvLyBDYWxsZWQgYnkgdGhlIGRpcmVjdGl2ZVxyXG4gICAgXHJcbiAgICBzZWxmLmVkaXRNb2RlID0gZWRpdE1vZGU7XHJcblxyXG4gICAgdmFyIGRhdGFHZXR0ZXIgPSAkcGFyc2UoZGF0YUV4cHJlc3Npb24pO1xyXG4gICAgdmFyIGRhdGFTZXR0ZXIgPSBkYXRhR2V0dGVyLmFzc2lnbjtcclxuXHJcbiAgICAkc2NvcGUuJHdhdGNoKGRhdGFHZXR0ZXIsIGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgIGlmKHZhbHVlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB2YWx1ZSA9IHt9O1xyXG5cclxuICAgICAgICBpZihkYXRhU2V0dGVyKSB7XHJcbiAgICAgICAgICBkYXRhU2V0dGVyKCRzY29wZSwgdmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgc2VsZi5tb2RlbC5kYXRhID0gdmFsdWU7XHJcbiAgICB9KTtcclxuXHJcbiAgICAkc2NvcGUuJHdhdGNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICByZXR1cm4gc2NoZW1hLm1vZGVsKCk7XHJcbiAgICB9LCBmdW5jdGlvbih2YWx1ZSkge1xyXG4gICAgICBpZih2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgc2NoZW1hLm1vZGVsKHt9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBzZWxmLm1vZGVsLnNjaGVtYSA9IHZhbHVlO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBzZWxmLm1vZGVsLnN0YXRlID0gc3RhdGU7XHJcblxyXG4gICAgXHJcbiAgICByZXR1cm4gc2VsZi5tb2RlbDtcclxuICB9O1xyXG5cclxuICB0aGlzLmNsZWFyRm9jdXNPbkZpZWxkcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgYW5ndWxhci5mb3JFYWNoKHNlbGYubW9kZWwuc2NoZW1hLmZpZWxkcywgZnVuY3Rpb24oZmllbGQpIHtcclxuICAgICAgZmllbGQuZm9jdXMgPSBmYWxzZTtcclxuICAgIH0pO1xyXG4gIH07XHJcblxyXG59XSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdmZWJ3b3JtcycsIFtcImZlYndvcm1zLnRlbXBsYXRlc1wiXSkuZGlyZWN0aXZlKCdmZWJ3b3Jtc0VkaXQnLCBmdW5jdGlvbigpIHtcclxuICByZXR1cm4ge1xyXG4gICAgcHJpb3JpdHk6IDEwMCxcclxuICAgIHJlcXVpcmU6ICdmZWJ3b3Jtc1NjaGVtYScsXHJcbiAgICByZXN0cmljdDogJ0FFJyxcclxuICAgIHNjb3BlOiB7XHJcbiAgICAgIC8vIC8vIFRoZSBzY2hlbWEgbW9kZWwgdG8gZWRpdFxyXG4gICAgICBzY2hlbWE6ICc9P2ZlYndvcm1zU2NoZW1hJyxcclxuICAgICAgLy8gQm9vbGVhbiBpbmRpY2F0aW5nIHdldGhlciB0byBzaG93IHRoZSBkZWZhdWx0IGZvcm0gYWN0aW9uIGJ1dHRvbnNcclxuICAgICAgYWN0aW9uc0VuYWJsZWQ6ICc9P2ZlYndvcm1zQWN0aW9uc0VuYWJsZWQnLFxyXG4gICAgICAvLyBDYWxsYmFjayBmdW5jdGlvbiB3aGVuIHRoZSB1c2VyIHByZXNzZXMgc2F2ZSAtLSBhbnkgYXJndW1lbnQgbmFtZWQgJ3NjaGVtYScgaXMgc2V0IHRvIHRoZSBzY2hlbWEgbW9kZWwuXHJcbiAgICAgIG9uU2F2ZTogJyZmZWJ3b3Jtc09uU2F2ZScsXHJcbiAgICAgIC8vIENhbGxiYWNrIGZ1bmN0aW9uIHdoZW4gdGhlIHVzZXIgcHJlc3NlcyBjYW5jZWwgLS0gYW55IGFyZ3VtZW50IG5hbWVkICdzY2hlbWEnIGlzIHNldCB0byB0aGUgc2NoZW1hIG1vZGVsLlxyXG4gICAgICBvbkNhbmNlbDogJyZmZWJ3b3Jtc09uQ2FuY2VsJyxcclxuICAgICAgLy8gQm9vbGVhbiBpbmRpY2F0aW5nIHdldGhlciB0aGUgZWRpdCBpcyBpbiBwcmV2aWV3IG1vZGUgb3Igbm90XHJcbiAgICAgIHByZXZpZXc6ICc9P2ZlYndvcm1zUHJldmlldydcclxuICAgIH0sXHJcbiAgICByZXBsYWNlOiB0cnVlLCBcclxuICAgIGNvbnRyb2xsZXI6ICdmZWJ3b3Jtc0VkaXRDb250cm9sbGVyIGFzIGVkaXRDdHJsJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnY29tcG9uZW50cy9mZWJ3b3Jtcy9lZGl0L2VkaXQudG1wbC5odG1sJyxcclxuICAgIGxpbms6IGZ1bmN0aW9uKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgc2NoZW1hQ3RybCkge1xyXG4gICAgICBcclxuICAgICAgaWYoJHNjb3BlLnNjaGVtYSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgJHNjb3BlLnNjaGVtYSA9IHt9O1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZigkc2NvcGUuYWN0aW9uc0VuYWJsZWQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICRzY29wZS5hY3Rpb25zRW5hYmxlZCA9IHRydWU7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmKCRzY29wZS5wcmV2aWV3ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAkc2NvcGUucHJldmlldyA9IGZhbHNlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBzY2hlbWFDdHJsLm1vZGVsKCRzY29wZS5zY2hlbWEpO1xyXG4gICAgICAkc2NvcGUuc2NoZW1hQ3RybCA9IHNjaGVtYUN0cmw7XHJcbiAgICB9XHJcbiAgfVxyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnZmVid29ybXMnLCBbXCJmZWJ3b3Jtcy50ZW1wbGF0ZXNcIl0pLmNvbnRyb2xsZXIoJ2ZlYndvcm1zRWRpdENvbnRyb2xsZXInLCBbJyRzY29wZScsICdmZWJ3b3Jtc1V0aWxzJywgJyRsb2NhdGlvbicsIGZ1bmN0aW9uKCRzY29wZSwgZmVid29ybXNVdGlscywgJGxvY2F0aW9uKSB7XHJcblxyXG4gIHZhciBzZWxmID0gdGhpcztcclxuXHJcbiAgJHNjb3BlLnByZXZpZXcgPSAkbG9jYXRpb24uc2VhcmNoKCkucHJldmlldztcclxuXHJcbiAgdGhpcy5zZXRNZXRhRm9ybSA9IGZ1bmN0aW9uKG1ldGFGb3JtKSB7XHJcbiAgICBzZWxmLm1ldGFGb3JtID0gbWV0YUZvcm07XHJcbiAgfTtcclxuXHJcbiAgdGhpcy50b2dnbGVQcmV2aWV3ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAkc2NvcGUucHJldmlldyA9ICEkc2NvcGUucHJldmlldztcclxuICB9O1xyXG5cclxuICAkc2NvcGUuJHdhdGNoKGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIHZhciBzY2hlbWEgPSAkc2NvcGUuc2NoZW1hQ3RybC5tb2RlbCgpO1xyXG5cclxuICAgIC8vIFNlZW1zIHRoYXQgdGhpcyB3YXRjaCBpcyBzb21ldGltZXMgZmlyZWQgYWZ0ZXIgdGhlIHNjb3BlIGhhcyBiZWVuIGRlc3Ryb3llZCg/KVxyXG4gICAgXHJcbiAgICBpZiAoc2NoZW1hKSB7IFxyXG4gICAgICBzY2hlbWEuJF9pbnZhbGlkID0gc2VsZi5tZXRhRm9ybSA/IHNlbGYubWV0YUZvcm0uJGludmFsaWQgOiBmYWxzZTtcclxuXHJcbiAgICAgIGlmICghc2NoZW1hLiRfaW52YWxpZCkge1xyXG5cclxuICAgICAgICB2YXIgZmllbGRzID0gc2NoZW1hLmZpZWxkcztcclxuXHJcbiAgICAgICAgaWYgKGZpZWxkcykge1xyXG5cclxuICAgICAgICAgIHZhciBpID0gZmllbGRzLmxlbmd0aDtcclxuXHJcbiAgICAgICAgICB3aGlsZSAoLS1pID49IDAgJiYgIXNjaGVtYS4kX2ludmFsaWQpIHtcclxuICAgICAgICAgICAgc2NoZW1hLiRfaW52YWxpZCA9IGZpZWxkc1tpXS4kX2ludmFsaWQ7XHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdkcScsIFtdKS5mYWN0b3J5KCdkcVV0aWxzJywgWyckd2luZG93JywgJyRyb290U2NvcGUnLCBmdW5jdGlvbigkd2luZG93LCAkcm9vdFNjb3BlKSB7XHJcblxyXG4gIHZhciBfZHJhZ0RhdGEgPSBudWxsO1xyXG5cclxuICAvL25vaW5zcGVjdGlvbiBGdW5jdGlvbldpdGhJbmNvbnNpc3RlbnRSZXR1cm5zSlNcclxuICByZXR1cm4ge1xyXG4gICAgZ2V0RXZlbnQ6IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgIHJldHVybiBlICYmIGUub3JpZ2luYWxFdmVudCA/IGUub3JpZ2luYWxFdmVudCA6IGUgfHwgJHdpbmRvdy5ldmVudDtcclxuICAgIH0sXHJcbiAgICBzdG9wRXZlbnQ6IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgIC8vIGUuY2FuY2VsQnViYmxlIGlzIHN1cHBvcnRlZCBieSBJRTggLVxyXG4gICAgICAvLyB0aGlzIHdpbGwga2lsbCB0aGUgYnViYmxpbmcgcHJvY2Vzcy5cclxuICAgICAgZS5jYW5jZWxCdWJibGUgPSB0cnVlO1xyXG4gICAgICBlLmJ1YmJsZXMgPSBmYWxzZTtcclxuICAgICAgXHJcbiAgICAgIC8vIGUuc3RvcFByb3BhZ2F0aW9uIHdvcmtzIGluIG1vZGVybiBicm93c2Vyc1xyXG4gICAgICBpZiAoZS5zdG9wUHJvcGFnYXRpb24pIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgIGlmIChlLnByZXZlbnREZWZhdWx0KSBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9LFxyXG4gICAgZHJhZ0RhdGE6IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgIGlmIChkYXRhID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICByZXR1cm4gX2RyYWdEYXRhO1xyXG4gICAgICB9XHJcbiAgICAgIF9kcmFnRGF0YSA9IGRhdGE7XHJcbiAgICB9LFxyXG4gICAgZ2V0UGFyZW50QXJlYTogZnVuY3Rpb24gKCRzY29wZSkge1xyXG4gICAgICB2YXIgYXJlYSA9IHt9O1xyXG4gICAgICAkc2NvcGUuJGVtaXQoJ2RxTG9jYXRlQXJlYScsIGFyZWEpO1xyXG4gICAgICByZXR1cm4gYXJlYS5uYW1lO1xyXG4gICAgfSxcclxuICAgIGlzQXJlYU1hdGNoOiBmdW5jdGlvbiAoJHNjb3BlKSB7XHJcbiAgICAgIHZhciBwYXJlbnRBcmVhID0gdGhpcy5nZXRQYXJlbnRBcmVhKCRzY29wZSk7XHJcbiAgICAgIHZhciBldmVudEFyZWEgPSBfZHJhZ0RhdGEgPyBfZHJhZ0RhdGEuYXJlYSA6IFwiXCI7XHJcblxyXG4gICAgICByZXR1cm4gcGFyZW50QXJlYSA9PT0gZXZlbnRBcmVhO1xyXG4gICAgfVxyXG4gIH07XHJcbn1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnZHEnKS5kaXJlY3RpdmUoJ2RxRHJhZ2dhYmxlJywgWydkcVV0aWxzJywgJyRyb290U2NvcGUnLCBmdW5jdGlvbiAoZHFVdGlscywgJHJvb3RTY29wZSkge1xyXG5cclxuICBmdW5jdGlvbiBldmFsQW5kQnJvYWRjYXN0KGV2ZW50TmFtZSwgdGFyZ2V0QXJlYSwgJHNjb3BlLCBleHByZXNzaW9uLCBjYikge1xyXG4gICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHZhciBkYXRhID0gJHNjb3BlLiRldmFsKGV4cHJlc3Npb24pO1xyXG5cclxuICAgICAgdmFyIGJjRGF0YSA9IHtcclxuICAgICAgICBhcmVhOiB0YXJnZXRBcmVhLFxyXG4gICAgICAgIGRhdGE6IGRhdGFcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNiKGJjRGF0YSk7XHJcblxyXG4gICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoZXZlbnROYW1lLCBiY0RhdGEpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdBRUMnLFxyXG4gICAgbGluazogZnVuY3Rpb24gKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycykge1xyXG5cclxuICAgICAgdmFyIHRhcmdldEFyZWEgPSAkYXR0cnMuZHFEcmFnZ2FibGUgfHwgJGF0dHJzLmRxRHJhZ1RhcmdldEFyZWEgfHwgXCJcIjtcclxuICAgICAgdmFyIGRpc2FibGVkID0gZmFsc2U7XHJcblxyXG4gICAgICAkc2NvcGUuJHdhdGNoKCRhdHRycy5kcURyYWdEaXNhYmxlZCwgZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICBkaXNhYmxlZCA9IHZhbHVlO1xyXG4gICAgICAgICRlbGVtZW50LmF0dHIoJ2RyYWdnYWJsZScsIGRpc2FibGVkID8gJ2ZhbHNlJyA6ICd0cnVlJyk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgJGVsZW1lbnQub24oJ3NlbGVjdHN0YXJ0JyxmdW5jdGlvbiAoZSkge1xyXG5cclxuICAgICAgICAvLyBQdXJlIElFIGV2aWxuZXNzXHJcblxyXG4gICAgICAgIGlmICghZGlzYWJsZWQgJiYgdGhpcy5kcmFnRHJvcCkge1xyXG4gICAgICAgICAgdGhpcy5kcmFnRHJvcCgpO1xyXG4gICAgICAgICAgZSA9IGRxVXRpbHMuZ2V0RXZlbnQoZSk7XHJcbiAgICAgICAgICByZXR1cm4gZHFVdGlscy5zdG9wRXZlbnQoZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KS5vbignZHJhZ3N0YXJ0JyxmdW5jdGlvbiAoZSkge1xyXG5cclxuICAgICAgICAgIGUgPSBkcVV0aWxzLmdldEV2ZW50KGUpO1xyXG5cclxuICAgICAgICAgIGlmKGRpc2FibGVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkcVV0aWxzLnN0b3BFdmVudChlKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICB2YXIgZHQgPSBlLmRhdGFUcmFuc2ZlcjtcclxuICAgICAgICAgIGR0LmVmZmVjdEFsbG93ZWQgPSAnYWxsJztcclxuICAgICAgICAgIGR0LnNldERhdGEoJ1RleHQnLCAnVGhlIGNha2UgaXMgYSBsaWUhJyk7XHJcblxyXG4gICAgICAgICAgZXZhbEFuZEJyb2FkY2FzdCgnZHFEcmFnQmVnaW4nLCB0YXJnZXRBcmVhLCAkc2NvcGUsICRhdHRycy5kcURyYWdCZWdpbiwgZnVuY3Rpb24oZHJhZ0RhdGEpIHtcclxuICAgICAgICAgICAgZHFVdGlscy5kcmFnRGF0YShkcmFnRGF0YSk7XHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgfSkub24oJ2RyYWdlbmQnLCBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgZXZhbEFuZEJyb2FkY2FzdCgnZHFEcmFnRW5kJywgdGFyZ2V0QXJlYSwgJHNjb3BlLCAkYXR0cnMuZHFEcmFnRW5kLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgZHFVdGlscy5kcmFnRGF0YShudWxsKTtcclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICB9O1xyXG5cclxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdkcScpLmRpcmVjdGl2ZSgnZHFEcmFnRW50ZXInLFsnZHFEcmFnVHJhY2snLCBmdW5jdGlvbiAoZHFEcmFnVHJhY2spIHtcclxuICByZXR1cm4ge1xyXG4gICAgbGluazogZHFEcmFnVHJhY2tcclxuICB9O1xyXG59XSkuZGlyZWN0aXZlKCdkcURyYWdMZWF2ZScsWydkcURyYWdUcmFjaycsIGZ1bmN0aW9uIChkcURyYWdUcmFjaykge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbGluazogZHFEcmFnVHJhY2tcclxuICAgIH07XHJcbiAgfV0pLmRpcmVjdGl2ZSgnZHFEcmFnT3ZlcicsWydkcURyYWdUcmFjaycsIGZ1bmN0aW9uIChkcURyYWdUcmFjaykge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbGluazogZHFEcmFnVHJhY2tcclxuICAgIH07XHJcbiAgfV0pLmRpcmVjdGl2ZSgnZHFEcm9wJyxbJ2RxRHJhZ1RyYWNrJywgZnVuY3Rpb24gKGRxRHJhZ1RyYWNrKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBsaW5rOiBkcURyYWdUcmFja1xyXG4gICAgfTtcclxuICB9XSkuZmFjdG9yeSgnZHFEcmFnVHJhY2snLCBbJ2RxVXRpbHMnLCAnJGRvY3VtZW50JywgZnVuY3Rpb24gKGRxVXRpbHMsICRkb2N1bWVudCkge1xyXG5cclxuICAgIC8vIENvbWJpbmVzIGJvdGggbnEtZHJhZy1lbnRlciAmIG5xLWRyYWctbGVhdmUgJiBucS1kcmFnLW92ZXJcclxuXHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycykge1xyXG5cclxuICAgICAgLy8gVHJhY2tpbmcgYWxyZWFkeSBzZXQgb24gdGhlIGVsZW1lbnQ/XHJcblxyXG4gICAgICBpZiAoJGVsZW1lbnQuZGF0YSgnZHFEcmFnVHJhY2snKSAhPT0gdHJ1ZSkge1xyXG5cclxuICAgICAgICB2YXIgdHJhY2tpbmdFbmFibGVkID0gZmFsc2U7IC8vIFRvZ2dsZWQgb24gZHJhZy1iZWdpbiBpZiB0aGUgYXJlYSBuYW1lIGRvZXMgbm90IG1hdGNoIHRoZSB0YXJnZXRcclxuICAgICAgICB2YXIgaW5ib3VuZCA9IGZhbHNlOyAvLyBUb2dnbGUgdG8gaW5kaWNhdGUgaWYgdGhlIGRyYWdnaW5nIGlzIGluIG9yIG91dGJvdW5kIGVsZW1lbnRcclxuICAgICAgICB2YXIgZWxlbWVudCA9ICRlbGVtZW50WzBdO1xyXG4gICAgICAgIHZhciBkcm9wRWZmZWN0ID0gJ25vbmUnOyAvLyBEcm9wIGVmZmVjdCB1c2VkIGluIHRoZSBkcmFnb3ZlciBldmVudFxyXG4gICAgICAgIHZhciBkb2luZ0xlYXZlRG91YmxlQ2hlY2sgPSBmYWxzZTsgLy8gVG9nZ2xlIHRoYXQgaW5kaWNhdGVzIHRoZSBib2R5IGhhcyBhIGRyYWdvdmVyIGV2ZW50IHRvIGRvLlxyXG5cclxuICAgICAgICB2YXIgJGJvZHkgPSAkZG9jdW1lbnQuZmluZCgnYm9keScpO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBkcmFnTGVhdmVEb3VibGVDaGVjaygkZSkge1xyXG4gICAgICAgICAgdmFyIGUgPSBkcVV0aWxzLmdldEV2ZW50KCRlKTtcclxuXHJcbiAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgZHJhZyBvdmVyIGVsZW1lbnQgaXMgYSBjaGlsZCBvZiB0aGUgdGhpcyBlbGVtZW50XHJcblxyXG4gICAgICAgICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0IHx8ICRlLnRhcmdldDtcclxuXHJcbiAgICAgICAgICBpZiAodGFyZ2V0ICE9PSBlbGVtZW50KSB7XHJcblxyXG4gICAgICAgICAgICAvLyBUT0RPOiB3ZSdyZSBub3QgcmVhbGx5IGNoZWNraW5nIGlmIHRoZSB0YXJnZXQgZWxlbWVudCBpcyB2aXN1YWxseSB3aXRoaW4gdGhlICRlbGVtZW50LlxyXG5cclxuICAgICAgICAgICAgaWYgKCFlbGVtZW50LmNvbnRhaW5zKHRhcmdldCkpIHtcclxuXHJcbiAgICAgICAgICAgICAgLy8gRHJhZyBvdmVyIGVsZW1lbnQgaXMgb3V0IG9mIGJvdW5kc1xyXG5cclxuICAgICAgICAgICAgICBkcmFnTGVhdmVGb3JTdXJlKHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgLy8gV2UncmUgZG9uZSB3aXRoIHRoZSBleHBlbnNpdmUgYm9keSBjYWxsXHJcblxyXG4gICAgICAgICAgJGJvZHkub2ZmKCdkcmFnb3ZlcicsIGRyYWdMZWF2ZURvdWJsZUNoZWNrKTtcclxuXHJcbiAgICAgICAgICAvLyBOb3RpZnkgdGhlIGxvY2FsIGVsZW1lbnQgZXZlbnQgY2FsbGJhY2sgdGhlcmUncyBubyBldmVudCBsaXN0ZW5lciBvbiB0aGUgYm9keSBhbmQgdGhlIG5leHQgZXZlbnRcclxuICAgICAgICAgIC8vIGNhbiBzYWZlbHkgYmUgY2FuY2VsbGVkLlxyXG5cclxuICAgICAgICAgIGRvaW5nTGVhdmVEb3VibGVDaGVjayA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgIGUuZGF0YVRyYW5zZmVyLmRyb3BFZmZlY3QgPSBkcm9wRWZmZWN0O1xyXG5cclxuICAgICAgICAgIC8vIEFsd2F5cyBjYW5jZWwgdGhlIGRyYWdvdmVyIC0tIG90aGVyd2lzZSB0aGUgZHJvcEVmZmVjdCBpcyBub3QgdXNlZC5cclxuXHJcbiAgICAgICAgICByZXR1cm4gZHFVdGlscy5zdG9wRXZlbnQoJGUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZHJhZ0xlYXZlRm9yU3VyZShhcHBseSkge1xyXG4gICAgICAgICAgaW5ib3VuZCA9IGZhbHNlO1xyXG4gICAgICAgICAgdmFyIGV4cHJlc3Npb24gPSAkYXR0cnMuZHFEcmFnTGVhdmU7XHJcbiAgICAgICAgICBpZiAoZXhwcmVzc2lvbikge1xyXG4gICAgICAgICAgICBpZiAoYXBwbHkpIHtcclxuICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS4kZXZhbChleHByZXNzaW9uKTtcclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAkc2NvcGUuJGV2YWwoZXhwcmVzc2lvbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgLy8gSnVzdCB0byBiZSBzdXJlXHJcbiAgICAgICAgICAkYm9keS5vZmYoJ2RyYWdvdmVyJywgZHJhZ0xlYXZlRG91YmxlQ2hlY2spO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAkc2NvcGUuJG9uKCdkcURyYWdCZWdpbicsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgIC8vIENoZWNrIGlmIHdlIHNob3VsZCB0cmFjayBkcmFnIG1vdmVtZW50c1xyXG4gICAgICAgICAgdHJhY2tpbmdFbmFibGVkID0gZHFVdGlscy5pc0FyZWFNYXRjaCgkc2NvcGUpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAkc2NvcGUuJG9uKCdkcURyYWdFbmQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICBpZiAodHJhY2tpbmdFbmFibGVkKSB7XHJcbiAgICAgICAgICAgIC8vIEdpZWYgY2FrZVxyXG4gICAgICAgICAgICBkcmFnTGVhdmVGb3JTdXJlKGZhbHNlKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgJGVsZW1lbnQub24oJ2RyYWdlbnRlcicsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICBpZiAodHJhY2tpbmdFbmFibGVkICYmIGluYm91bmQgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgIGluYm91bmQgPSB0cnVlO1xyXG4gICAgICAgICAgICB2YXIgZXhwcmVzc2lvbiA9ICRhdHRycy5kcURyYWdFbnRlcjtcclxuICAgICAgICAgICAgaWYgKGV4cHJlc3Npb24pIHtcclxuICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS4kZXZhbChleHByZXNzaW9uKTtcclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAkZWxlbWVudC5vbignZHJhZ2xlYXZlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgaWYgKHRyYWNraW5nRW5hYmxlZCAmJiBpbmJvdW5kID09PSB0cnVlKSB7XHJcblxyXG4gICAgICAgICAgICAvLyBkcmFnbGVhdmUgaXMgYSBsaWUgLS0gaG92ZXJpbmcgY2hpbGQgZWxlbWVudHMgd2lsbCBjYXVzZSB0aGlzIGV2ZW50IHRvIHRyaWdnZXIgYWxzby5cclxuICAgICAgICAgICAgLy8gV2UgZmFrZSB0aGUgY2FrZSBieSB0cmFja2luZyB0aGUgZHJhZyBvdXJzZWxmLlxyXG5cclxuICAgICAgICAgICAgLy8gTm90aWZ5IHRoZSBcInJlYWxcIiBkcmFnb3ZlciBldmVudCB0aGF0IGhlIGhhcyB0byBwbGF5IG5pY2Ugd2l0aCB0aGUgYm9keSBhbmQgbm90IHRvXHJcbiAgICAgICAgICAgIC8vIGNhbmNlbCB0aGUgZXZlbnQgY2hhaW4uXHJcblxyXG4gICAgICAgICAgICBkb2luZ0xlYXZlRG91YmxlQ2hlY2sgPSB0cnVlO1xyXG4gICAgICAgICAgICAkYm9keS5vbignZHJhZ292ZXInLCBkcmFnTGVhdmVEb3VibGVDaGVjayk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vbm9pbnNwZWN0aW9uIEZ1bmN0aW9uV2l0aEluY29uc2lzdGVudFJldHVybnNKU1xyXG4gICAgICAgICRlbGVtZW50Lm9uKCdkcmFnb3ZlcicsIGZ1bmN0aW9uICgkZSkge1xyXG5cclxuICAgICAgICAgIGlmICh0cmFja2luZ0VuYWJsZWQpIHtcclxuXHJcbiAgICAgICAgICAgIHZhciBlID0gZHFVdGlscy5nZXRFdmVudCgkZSk7XHJcblxyXG4gICAgICAgICAgICB2YXIgZXhwcmVzc2lvbiA9ICRhdHRycy5kcURyYWdPdmVyO1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0O1xyXG5cclxuICAgICAgICAgICAgaWYgKGV4cHJlc3Npb24pIHtcclxuICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9ICRzY29wZS4kZXZhbChleHByZXNzaW9uKTtcclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gVGhlIGV2YWx1YXRlZCBleHByZXNzaW9uIGNhbiBpbmRpY2F0ZSB0byBjYW5jZWwgdGhlIGRyb3BcclxuXHJcbiAgICAgICAgICAgIGRyb3BFZmZlY3QgPSByZXN1bHQgPT09IGZhbHNlID8gJ25vbmUnIDogJ2NvcHknO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFkb2luZ0xlYXZlRG91YmxlQ2hlY2spIHtcclxuXHJcbiAgICAgICAgICAgICAgLy8gVGhlcmUncyBubyBkcmFnb3ZlciBxdWV1ZWQgb24gdGhlIGJvZHkuXHJcbiAgICAgICAgICAgICAgLy8gVGhlIGV2ZW50IG5lZWRzIHRvIGJlIHRlcm1pbmF0ZWQgaGVyZSBlbHNlIHRoZSBkcm9wRWZmZWN0IHdpbGxcclxuICAgICAgICAgICAgICAvLyBub3QgYmUgYXBwbGllZCAoYW5kIGRyb3BwaW5nIGlzIG5vdCBhbGxvd2VkKS5cclxuXHJcbiAgICAgICAgICAgICAgZS5kYXRhVHJhbnNmZXIuZHJvcEVmZmVjdCA9IGRyb3BFZmZlY3Q7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIGRxVXRpbHMuc3RvcEV2ZW50KCRlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvL25vaW5zcGVjdGlvbiBGdW5jdGlvbldpdGhJbmNvbnNpc3RlbnRSZXR1cm5zSlNcclxuICAgICAgICAkZWxlbWVudC5vbignZHJvcCcsIGZ1bmN0aW9uKCRlKSB7XHJcblxyXG4gICAgICAgICAgdmFyIGUgPSBkcVV0aWxzLmdldEV2ZW50KCRlKTtcclxuXHJcbiAgICAgICAgICBpZih0cmFja2luZ0VuYWJsZWQpIHtcclxuICAgICAgICAgICAgdmFyIGV4cHJlc3Npb24gPSAkYXR0cnMuZHFEcm9wO1xyXG5cclxuICAgICAgICAgICAgaWYoZXhwcmVzc2lvbikge1xyXG4gICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZXhwcmVzc2lvbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICByZXR1cm4gZHFVdGlscy5zdG9wRXZlbnQoJGUpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBFbnN1cmUgdGhhdCB3ZSBvbmx5IGRvIGFsbCB0aGlzIG1hZ2ljIHN0dWZmIG9uIHRoaXMgZWxlbWVudCBmb3Igb25lIHRpbWUgb25seS5cclxuXHJcbiAgICAgICAgJGVsZW1lbnQuZGF0YSgnZHFEcmFnVHJhY2snLCB0cnVlKTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgfV0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgnZHEnKS5kaXJlY3RpdmUoJ2RxRHJhZ0FyZWEnLCBbJ2RxVXRpbHMnLCBmdW5jdGlvbiAoZHFVdGlscykge1xyXG5cclxuICBmdW5jdGlvbiBldmFsQnJvYWRjYXN0RXZlbnQoJHNjb3BlLCBhcmdzLCBhcmVhTmFtZSwgZXhwcmVzc2lvbikge1xyXG4gICAgaWYgKGV4cHJlc3Npb24gJiYgYXJncyAmJiBhcmdzLmFyZWEgPT09IGFyZWFOYW1lKSB7XHJcbiAgICAgICRzY29wZS4kZXZhbChleHByZXNzaW9uKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICByZXN0cmljdDogJ0FFQycsXHJcbiAgICBsaW5rOiBmdW5jdGlvbiAoJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzKSB7XHJcblxyXG4gICAgICB2YXIgYXJlYU5hbWUgPSAkYXR0cnMuZHFEcmFnQXJlYSB8fCAkYXR0cnMuZHFEcmFnQXJlYU5hbWUgfHwgXCJcIjtcclxuXHJcbiAgICAgICRzY29wZS4kb24oJ2RxRHJhZ0JlZ2luJywgZnVuY3Rpb24gKCRldmVudCwgYXJncykge1xyXG4gICAgICAgIGV2YWxCcm9hZGNhc3RFdmVudCgkc2NvcGUsIGFyZ3MsIGFyZWFOYW1lLCAkYXR0cnMuZHFEcmFnUHJvZ3Jlc3NCZWdpbik7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgJHNjb3BlLiRvbignZHFEcmFnRW5kJywgZnVuY3Rpb24gKCRldmVudCwgYXJncykge1xyXG4gICAgICAgIGV2YWxCcm9hZGNhc3RFdmVudCgkc2NvcGUsIGFyZ3MsIGFyZWFOYW1lLCAkYXR0cnMuZHFEcmFnUHJvZ3Jlc3NFbmQpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgICRzY29wZS4kb24oJ2RxTG9jYXRlQXJlYScsIGZ1bmN0aW9uKCRldmVudCwgYXJncykge1xyXG4gICAgICAgIGFyZ3MubmFtZSA9IGFyZWFOYW1lO1xyXG4gICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG59XSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdmZWJ3b3JtcycsIFtcImZlYndvcm1zLnRlbXBsYXRlc1wiXSkuZmFjdG9yeSgnZmVid29ybXNVdGlscycsIFsnJHRlbXBsYXRlQ2FjaGUnLCAnJGh0dHAnLCAnJHdpbmRvdycsICdmZWJ3b3Jtc0NvbmZpZycsIGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSwgJGh0dHAsICR3aW5kb3csIGZlYndvcm1zQ29uZmlnKSB7XHJcblxyXG4gICAgdmFyIHVuaXF1ZUNvdW50ZXIgPSAoK25ldyBEYXRlKSAlIDEwMDAwO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGdldFNjcm9sbE9mZnNldDogZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgIC8vIHRoZSBwYWdlWU9mZnNldCBwcm9wZXJ0eSBvZiB0aGUgd2luZG93IG9iamVjdCBpcyBzdXBwb3J0ZWQgaW4gYWxsIGJyb3dzZXJzIGV4Y2VwdCBcclxuICAgICAgICAvLyBpbiBJbnRlcm5ldCBFeHBsb3JlciBiZWZvcmUgdmVyc2lvbiA5LCBhbmQgYWx3YXlzIHJldHVybnMgdGhlIHNjcm9sbCBhbW91bnQgcmVnYXJkbGVzcyBvZiB0aGUgZG9jdHlwZVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIHRoZSBzY3JvbGxZIHByb3BlcnR5IG9mIHRoZSB3aW5kb3cgb2JqZWN0IGlzIHN1cHBvcnRlZCBieSBGaXJlZm94LCBHb29nbGUgQ2hyb21lIGFuZCBTYWZhcmksIGFuZCBhbHdheXNcclxuICAgICAgICAvLyByZXR1cm5zIHRoZSBzY3JvbGwgYW1vdW50IHJlZ2FyZGxlc3Mgb2YgdGhlIGRvY3R5cGVcclxuICAgICAgICBcclxuICAgICAgICAvLyBpZiBhIGRvY3R5cGUgaXMgc3BlY2lmaWVkIGluIHRoZSBkb2N1bWVudCwgdGhlIHNjcm9sbFRvcCBwcm9wZXJ0eSBvZiB0aGUgaHRtbCBlbGVtZW50IHJldHVybnMgdGhlIHNjcm9sbFxyXG4gICAgICAgIC8vIGFtb3VudCBpbiBJbnRlcm5ldCBFeHBsb3JlciwgRmlyZWZveCBhbmQgT3BlcmEsIGJ1dCBhbHdheXMgcmV0dXJucyB6ZXJvIGluIEdvb2dsZSBDaHJvbWUgYW5kIFNhZmFyaVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIGlmIG5vIGRvY3R5cGUgaXMgc3BlY2lmaWVkIGluIHRoZSBkb2N1bWVudCwgdGhlIHNjcm9sbFRvcCBwcm9wZXJ0eSBvZiB0aGUgaHRtbCBlbGVtZW50IGFsd2F5cyByZXR1cm5zIHplcm9cclxuXHJcbiAgICAgICAgLy8gaWYgbm8gZG9jdHlwZSBpcyBzcGVjaWZpZWQgaW4gdGhlIGRvY3VtZW50LCB0aGUgc2Nyb2xsVG9wIHByb3BlcnR5IG9mIHRoZSBib2R5IGVsZW1lbnQgcmV0dXJucyB0aGUgXHJcbiAgICAgICAgLy8gc2Nyb2xsIGFtb3VudCBpbiBJbnRlcm5ldCBFeHBsb3JlciwgRmlyZWZveCwgT3BlcmEsIEdvb2dsZSBDaHJvbWUgYW5kIFNhZmFyaS5cclxuXHJcbiAgICAgICAgdmFyIG9mZnNldCA9IHt9O1xyXG5cclxuICAgICAgICBpZigkd2luZG93LnBhZ2VZT2Zmc2V0ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgIG9mZnNldC54ID0gJHdpbmRvdy5wYWdlWE9mZnNldDtcclxuICAgICAgICAgIG9mZnNldC55ID0gJHdpbmRvdy5wYWdlWU9mZnNldDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdmFyIGRlID0gJHdpbmRvdy5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XHJcbiAgICAgICAgICBvZmZzZXQueCA9IGRlLnNjcm9sbExlZnQ7XHJcbiAgICAgICAgICBvZmZzZXQueSA9IGRlLnNjcm9sbFRvcDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBvZmZzZXQ7XHJcbiAgICAgIH0sXHJcbiAgICAgIGRlZmF1bHRBcmVhOiAnZGVmYXVsdCcsXHJcbiAgICAgIGdldFJlbmRlckluZm86IGZ1bmN0aW9uKGZpZWxkKSB7XHJcbiAgICAgICAgLy92YXIgcmVuZGVySW5mbyA9IGZlYndvcm1zLkZpZWxkW2ZpZWxkLnR5cGVdO1xyXG4gICAgICAgIHZhciByZW5kZXJJbmZvID0gZmVid29ybXNDb25maWcuZmllbGRzLnJlbmRlckluZm9bZmllbGQudHlwZV07XHJcblxyXG4gICAgICAgIGlmKCFyZW5kZXJJbmZvKSB7XHJcbiAgICAgICAgICByZW5kZXJJbmZvID0ge307XHJcbiAgICAgICAgICAvLyBmZWJ3b3Jtcy5GaWVsZFtmaWVsZC50eXBlXSA9IHJlbmRlckluZm87XHJcbiAgICAgICAgICBmZWJ3b3Jtc0NvbmZpZy5maWVsZHMucmVuZGVySW5mb1tmaWVsZC50eXBlXSA9IHJlbmRlckluZm87XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZighcmVuZGVySW5mby50ZW1wbGF0ZVVybCkge1xyXG4gICAgICAgICAgcmVuZGVySW5mby50ZW1wbGF0ZVVybCA9IHRoaXMuZ2V0VGVtcGxhdGVVcmwoZmllbGQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoIXJlbmRlckluZm8ucHJvcGVydGllc1RlbXBsYXRlVXJsKSB7XHJcbiAgICAgICAgICByZW5kZXJJbmZvLnByb3BlcnRpZXNUZW1wbGF0ZVVybCA9IHRoaXMuZ2V0VGVtcGxhdGVVcmwoZmllbGQsICdwcm9wZXJ0aWVzJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcmVuZGVySW5mbztcclxuICAgICAgfSxcclxuICAgICAgZm9ybWF0VGVtcGxhdGVVcmw6IGZ1bmN0aW9uICh0eXBlLCBhcmVhKSB7XHJcbiAgICAgICAgcmV0dXJuICdjb21wb25lbnRzL2ZlYndvcm1zL2ZpZWxkLXRlbXBsYXRlcy8nICsgKGFyZWEgfHwgdGhpcy5kZWZhdWx0QXJlYSkgKyAnLycgKyB0eXBlICsgJy50bXBsLmh0bWwnO1xyXG4gICAgICB9LFxyXG4gICAgICBnZXRUZW1wbGF0ZVVybDogZnVuY3Rpb24gKGZpZWxkLCBhcmVhKSB7XHJcblxyXG4gICAgICAgIGFyZWEgPSBhcmVhIHx8IHRoaXMuZGVmYXVsdEFyZWE7XHJcblxyXG4gICAgICAgIC8vIElFOCBmaXg6IEFsaWFzZXMgcmVtb3ZlZFxyXG4gICAgICAgIC8vIHZhciB0ZW1wbGF0ZVR5cGUgPSBmZWJ3b3Jtc0NvbmZpZy5maWVsZHMuYWxpYXNlc1tmaWVsZC50eXBlXSB8fCBmaWVsZC50eXBlO1xyXG4gICAgICAgIHZhciB0ZW1wbGF0ZVR5cGUgPSBmaWVsZC50eXBlO1xyXG4gICAgICAgIHZhciB0ZW1wbGF0ZVVybCA9IHRoaXMuZm9ybWF0VGVtcGxhdGVVcmwodGVtcGxhdGVUeXBlLCBhcmVhKTtcclxuXHJcbiAgICAgICAgICBpZiAoYXJlYSAhPT0gJ3Byb3BlcnRpZXMnICYmIGFyZWEgIT09IHRoaXMuZGVmYXVsdEFyZWEpIHtcclxuICAgICAgICAgICAgICB0ZW1wbGF0ZVVybCA9IHRoaXMuZ2V0VGVtcGxhdGVVcmwoZmllbGQsIHRoaXMuZGVmYXVsdEFyZWEpO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAvL2NvbnNvbGUubG9nKHRlbXBsYXRlVXJsKTtcclxuICAgICAgICAvL3ZhciBjYWNoZWQgPSAgJHRlbXBsYXRlQ2FjaGUuZ2V0KHRlbXBsYXRlVXJsKTtcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vaWYgKCFjYWNoZWQpIHtcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vICAvLyBVcmwgaXMgbm90IGluIGNhY2hlIC0tIGZhbGxiYWNrIHRvIGRlZmF1bHQgYXJlYS5cclxuICAgICAgICAvLyAgLy8gUHJvcGVydGllcyBhcmVhIHdpbGwgbmV2ZXIgZmFsbGJhY2sgdG8gZGVmYXVsdCBhcmVhLlxyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gIGlmIChhcmVhICE9PSAncHJvcGVydGllcycgJiYgYXJlYSAhPT0gdGhpcy5kZWZhdWx0QXJlYSkge1xyXG4gICAgICAgIC8vICAgIHRlbXBsYXRlVXJsID0gdGhpcy5nZXRUZW1wbGF0ZVVybChmaWVsZCwgdGhpcy5kZWZhdWx0QXJlYSk7XHJcbiAgICAgICAgLy8gIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gICAgcmV0dXJuIHRoaXMuZm9ybWF0VGVtcGxhdGVVcmwoJ25vdC1pbi1jYWNoZScpO1xyXG4gICAgICAgIC8vICB9XHJcbiAgICAgICAgLy99XHJcblxyXG4gICAgICAgIHJldHVybiB0ZW1wbGF0ZVVybDtcclxuICAgICAgfSxcclxuICAgICAgZ2V0VW5pcXVlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gKyt1bmlxdWVDb3VudGVyO1xyXG4gICAgICB9LFxyXG4gICAgICBjb3B5RmllbGQ6IGZ1bmN0aW9uKGZpZWxkKSB7XHJcbiAgICAgICAgdmFyIGNvcHkgPSBhbmd1bGFyLmNvcHkoZmllbGQpO1xyXG4gICAgICAgIGNvcHkubmFtZSA9ICdmaWVsZCcgKyB0aGlzLmdldFVuaXF1ZSgpO1xyXG4gICAgICAgIHJldHVybiBjb3B5O1xyXG4gICAgICB9LFxyXG4gICAgICBmaW5kRWxlbWVudHNCeUNsYXNzOiBmdW5jdGlvbiAocm9vdCwgY2xhc3NOYW1lLCByZWN1cnNpdmUsIGJ1ZmZlcikge1xyXG4gICAgICAgIGJ1ZmZlciA9IGJ1ZmZlciB8fCBbXTtcclxuXHJcbiAgICAgICAgaWYgKHJvb3QuY2xhc3NOYW1lID09PSBjbGFzc05hbWUpIHtcclxuICAgICAgICAgIGJ1ZmZlci5wdXNoKHJvb3QpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHJvb3QuaGFzQ2hpbGROb2RlcygpKSB7XHJcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJvb3QuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIGNoaWxkID0gcm9vdC5jaGlsZHJlbltpXTtcclxuICAgICAgICAgICAgaWYgKGNoaWxkLmNsYXNzTmFtZSA9PT0gY2xhc3NOYW1lKSB7XHJcbiAgICAgICAgICAgICAgYnVmZmVyLnB1c2goY2hpbGQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChyZWN1cnNpdmUpIHtcclxuICAgICAgICAgICAgICB0aGlzLmZpbmRFbGVtZW50c0J5Q2xhc3MoY2hpbGQsIGNsYXNzTmFtZSwgcmVjdXJzaXZlLCBidWZmZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBidWZmZXI7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgfV0pOyIsImFuZ3VsYXIubW9kdWxlKCdmZWJ3b3JtcycsIFtcImZlYndvcm1zLnRlbXBsYXRlc1wiXSkuZGlyZWN0aXZlKCdmZWJ3b3Jtc1BsYWNlaG9sZGVyJywgZnVuY3Rpb24oKSB7XHJcbiAgLypcclxuICAgIFRoaXMgYXR0cmlidXRlIGlzIG9ubHkgcmVxdWlyZWQgb24gVEVYVEFSRUEgZWxlbWVudHMuIFxyXG4gICAgQW5ndWxhciBpbiBjb21iaW5hdGlvbiB3aXRoIElFIGRvZXNuJ3QgbGlrZSBwbGFjZWhvbGRlcj1cInt7IG15RXhwcmVzc2lvbiB9fVwiLlxyXG4gICAqL1xyXG4gIHJldHVybiB7IFxyXG4gICAgbGluazogZnVuY3Rpb24oJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzKSB7XHJcbiAgICAgICRzY29wZS4kd2F0Y2goJGF0dHJzLmZlYndvcm1zUGxhY2Vob2xkZXIsIGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgJGVsZW1lbnQuYXR0cigncGxhY2Vob2xkZXInLCB2YWx1ZSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH07XHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdmZWJ3b3JtcycsIFtcImZlYndvcm1zLnRlbXBsYXRlc1wiXSkuZGlyZWN0aXZlKCdmZWJ3b3Jtc0lucHV0TnVtYmVyJywgZnVuY3Rpb24oKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlcXVpcmU6ICduZ01vZGVsJyxcclxuICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJsKSB7XHJcbiAgICAgIFxyXG4gICAgICBjdHJsLiRwYXJzZXJzLnB1c2goZnVuY3Rpb24oaW5wdXRWYWx1ZSkge1xyXG4gICAgICAgIC8vIHRoaXMgbmV4dCBpZiBpcyBuZWNlc3NhcnkgZm9yIHdoZW4gdXNpbmcgbmctcmVxdWlyZWQgb24geW91ciBpbnB1dC4gXHJcbiAgICAgICAgLy8gSW4gc3VjaCBjYXNlcywgd2hlbiBhIGxldHRlciBpcyB0eXBlZCBmaXJzdCwgdGhpcyBwYXJzZXIgd2lsbCBiZSBjYWxsZWRcclxuICAgICAgICAvLyBhZ2FpbiwgYW5kIHRoZSAybmQgdGltZSwgdGhlIHZhbHVlIHdpbGwgYmUgdW5kZWZpbmVkXHJcbiAgICAgICAgaWYgKGlucHV0VmFsdWUgPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgdHJhbnNmb3JtZWRJbnB1dCA9IGlucHV0VmFsdWUucmVwbGFjZSgvW14wLTldL2csICcnKTtcclxuXHJcbiAgICAgICAgdmFyIHZhbHVlID0gcGFyc2VJbnQodHJhbnNmb3JtZWRJbnB1dCk7XHJcbiAgICAgICAgdmFsdWUgPT09IE5hTiA/IHVuZGVmaW5lZCA6IHZhbHVlO1xyXG5cclxuICAgICAgICBpZiAodHJhbnNmb3JtZWRJbnB1dCAhPSBpbnB1dFZhbHVlKSB7XHJcbiAgICAgICAgICBjdHJsLiRzZXRWaWV3VmFsdWUodHJhbnNmb3JtZWRJbnB1dCk7XHJcbiAgICAgICAgICBjdHJsLiRyZW5kZXIoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB2YWx1ZTtcclxuXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgY3RybC4kcGFyc2Vycy5wdXNoKGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgdmFyIGVtcHR5ID0gY3RybC4kaXNFbXB0eSh2YWx1ZSk7XHJcbiAgICAgICAgaWYgKGVtcHR5IHx8IC9eXFxzKihcXC18XFwrKT8oXFxkK3woXFxkKihcXC5cXGQqKSkpXFxzKiQvLnRlc3QodmFsdWUpKSB7XHJcbiAgICAgICAgICBjdHJsLiRzZXRWYWxpZGl0eSgnbnVtYmVyJywgdHJ1ZSk7XHJcbiAgICAgICAgICByZXR1cm4gdmFsdWUgPT09ICcnID8gbnVsbCA6IChlbXB0eSA/IHZhbHVlIDogcGFyc2VGbG9hdCh2YWx1ZSkpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBjdHJsLiRzZXRWYWxpZGl0eSgnbnVtYmVyJywgZmFsc2UpO1xyXG4gICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgY3RybC4kZm9ybWF0dGVycy5wdXNoKGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgcmV0dXJuIGN0cmwuJGlzRW1wdHkodmFsdWUpID8gdW5kZWZpbmVkIDogdmFsdWU7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKGF0dHIubWluKSB7XHJcbiAgICAgICAgdmFyIG1pblZhbGlkYXRvciA9IGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgICB2YXIgbWluID0gcGFyc2VGbG9hdChhdHRyLm1pbik7XHJcbiAgICAgICAgICBpZiAoIWN0cmwuJGlzRW1wdHkodmFsdWUpICYmIHZhbHVlIDwgbWluKSB7XHJcbiAgICAgICAgICAgIGN0cmwuJHNldFZhbGlkaXR5KCdtaW4nLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjdHJsLiRzZXRWYWxpZGl0eSgnbWluJywgdHJ1ZSk7XHJcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBjdHJsLiRwYXJzZXJzLnB1c2gobWluVmFsaWRhdG9yKTtcclxuICAgICAgICBjdHJsLiRmb3JtYXR0ZXJzLnB1c2gobWluVmFsaWRhdG9yKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKGF0dHIubWF4KSB7XHJcbiAgICAgICAgdmFyIG1heFZhbGlkYXRvciA9IGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgICB2YXIgbWF4ID0gcGFyc2VGbG9hdChhdHRyLm1heCk7XHJcbiAgICAgICAgICBpZiAoIWN0cmwuJGlzRW1wdHkodmFsdWUpICYmIHZhbHVlID4gbWF4KSB7XHJcbiAgICAgICAgICAgIGN0cmwuJHNldFZhbGlkaXR5KCdtYXgnLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjdHJsLiRzZXRWYWxpZGl0eSgnbWF4JywgdHJ1ZSk7XHJcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBjdHJsLiRwYXJzZXJzLnB1c2gobWF4VmFsaWRhdG9yKTtcclxuICAgICAgICBjdHJsLiRmb3JtYXR0ZXJzLnB1c2gobWF4VmFsaWRhdG9yKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY3RybC4kZm9ybWF0dGVycy5wdXNoKGZ1bmN0aW9uKHZhbHVlKSB7XHJcblxyXG4gICAgICAgIGlmIChjdHJsLiRpc0VtcHR5KHZhbHVlKSB8fCBhbmd1bGFyLmlzTnVtYmVyKHZhbHVlKSkge1xyXG4gICAgICAgICAgY3RybC4kc2V0VmFsaWRpdHkoJ251bWJlcicsIHRydWUpO1xyXG4gICAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBjdHJsLiRzZXRWYWxpZGl0eSgnbnVtYmVyJywgZmFsc2UpO1xyXG4gICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH07XHJcbn0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgnZmVid29ybXMnLCBbXCJmZWJ3b3Jtcy50ZW1wbGF0ZXNcIl0pLmRpcmVjdGl2ZSgnZmVid29ybXNEcm9wZG93bklucHV0JywgWyckY29tcGlsZScsICckZG9jdW1lbnQnLCAnJHRpbWVvdXQnLCAnJHBhcnNlJywgJ2ZlYndvcm1zVXRpbHMnLCBmdW5jdGlvbigkY29tcGlsZSwgJGRvY3VtZW50LCAkdGltZW91dCwgJHBhcnNlLCBmZWJ3b3Jtc1V0aWxzKSB7XHJcblxyXG4gIGZ1bmN0aW9uIGNyZWF0ZUlucHV0KCRzY29wZSwgJGVsZW1lbnQsICRhdHRycykge1xyXG5cclxuICAgIHZhciB0ZW1wbGF0ZSA9ICc8ZGl2IGNsYXNzPVwiZmVid29ybXMtZHJvcGRvd24taW5wdXQgaW5wdXQtYXBwZW5kXCI+JyArXHJcbiAgICAgICc8aW5wdXQgdHlwZT1cInRleHRcIi8+JyArXHJcbiAgICAgICc8ZGl2IGNsYXNzPVwiYnRuLWdyb3VwXCI+JyArXHJcbiAgICAgICc8YSBocmVmPVwiXCIgY2xhc3M9XCJidG4gZHJvcGRvd24tdG9nZ2xlXCIgbmctY2xpY2s9XCJkcm9wZG93blRvZ2dsZSgpXCI+JyArXHJcbiAgICAgICc8c3BhbiBjbGFzcz1cImNhcmV0XCI+PC9zcGFuPicgK1xyXG4gICAgICAnPC9hPicgK1xyXG4gICAgICAnPC9kaXY+JyArXHJcbiAgICAgICc8L2Rpdj4nO1xyXG5cclxuICAgIHZhciAkdGVtcGxhdGUgPSBhbmd1bGFyLmVsZW1lbnQodGVtcGxhdGUpO1xyXG4gICAgdmFyICRpbnB1dCA9ICR0ZW1wbGF0ZS5maW5kKCdpbnB1dCcpO1xyXG5cclxuICAgIC8vIENvcHkgdGhlIG9yaWdpbmFsIGF0dHJpYnV0ZXMgdG8gdGhlIGlucHV0IGVsZW1lbnRcclxuXHJcbiAgICB2YXIgYXR0cmlidXRlcyA9ICRlbGVtZW50LnByb3AoXCJhdHRyaWJ1dGVzXCIpO1xyXG5cclxuICAgIGFuZ3VsYXIuZm9yRWFjaChhdHRyaWJ1dGVzLCBmdW5jdGlvbihhKSB7XHJcbiAgICAgIGlmIChhLm5hbWUgIT09ICdmZWJ3b3Jtcy1kcm9wZG93bi1pbnB1dCcgJiYgYS5uYW1lICE9PSAnY2xhc3MnKSB7XHJcbiAgICAgICAgJGlucHV0LmF0dHIoYS5uYW1lLCBhLnZhbHVlKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyICRidXR0b24gPSAkdGVtcGxhdGUuZmluZCgnYScpO1xyXG4gICAgdmFyIGNsb3NlVGltZW91dDtcclxuXHJcbiAgICAkc2NvcGUuZHJvcGRvd25Ub2dnbGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgJGJ1dHRvblswXS5mb2N1cygpOyAvLyBmb3JjZSBmb2N1cyBmb3IgY2hyb21lXHJcbiAgICAgICRzY29wZS5kcm9wZG93blZpc2libGUgPSAhJHNjb3BlLmRyb3Bkb3duVmlzaWJsZVxyXG4gICAgfTtcclxuXHJcbiAgICAkYnV0dG9uLm9uKCdibHVyJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIGNsb3NlVGltZW91dCA9ICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICRzY29wZS5kcm9wZG93blZpc2libGUgPSBmYWxzZTtcclxuICAgICAgfSwgMTAwKTtcclxuICAgIH0pO1xyXG5cclxuICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgIGlmIChjbG9zZVRpbWVvdXQpICR0aW1lb3V0LmNhbmNlbChjbG9zZVRpbWVvdXQpO1xyXG4gICAgICBjbG9zZVRpbWVvdXQgPSB1bmRlZmluZWQ7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gJHRlbXBsYXRlO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gY3JlYXRlRHJvcGRvd24oJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzLCBuZ01vZGVsQ3RybCwgJGlucHV0KSB7XHJcblxyXG4gICAgdmFyIG1vZGVsR2V0dGVyID0gJHBhcnNlKCRhdHRycy5uZ01vZGVsKTtcclxuICAgIHZhciBtb2RlbFNldHRlciA9IG1vZGVsR2V0dGVyLmFzc2lnbjtcclxuXHJcbiAgICB2YXIgdGVtcGxhdGUgPSAnPGRpdiBjbGFzcz1cImZlYndvcm1zLWRyb3Bkb3duXCIgbmctY2xhc3M9XCJ7IFxcJ29wZW5cXCc6IGRyb3Bkb3duVmlzaWJsZSB9XCI+JyArXHJcbiAgICAgICc8dWwgbmctaWY9XCJpdGVtcyAmJiBpdGVtcy5sZW5ndGhcIiBjbGFzcz1cImRyb3Bkb3duLW1lbnVcIj4nICtcclxuICAgICAgJzxsaSBuZy1yZXBlYXQ9XCJpdGVtIGluIGl0ZW1zXCIgbmctY2xhc3M9XCJ7IGFjdGl2ZTogaXRlbS52YWx1ZSA9PT0gZ2V0TW9kZWxWYWx1ZSgpIH1cIj4nICtcclxuICAgICAgJzxhIGhyZWY9XCJcIiBuZy1jbGljaz1cInNldE1vZGVsVmFsdWUoaXRlbS52YWx1ZSlcIj57eyBpdGVtLnRleHQgfHwgaXRlbS52YWx1ZSB9fTwvYT4nICtcclxuICAgICAgJzwvbGk+JyArXHJcbiAgICAgICc8L3VsPicgK1xyXG4gICAgICAnPC9kaXY+JztcclxuXHJcbiAgICB2YXIgJHRlbXBsYXRlID0gYW5ndWxhci5lbGVtZW50KHRlbXBsYXRlKTtcclxuXHJcbiAgICAkc2NvcGUuc2V0TW9kZWxWYWx1ZSA9IGZ1bmN0aW9uKHZhbHVlKSB7XHJcblxyXG4gICAgICAkc2NvcGUuZHJvcGRvd25WaXNpYmxlID0gZmFsc2U7XHJcblxyXG4gICAgICAvLyBDb252ZXJ0IHRvIGEgc3RyaW5nXHJcblxyXG4gICAgICB2YXIgdmlld1ZhbHVlID0gdmFsdWUgfHwgJyc7XHJcblxyXG4gICAgICB2YXIgaWR4ID0gbmdNb2RlbEN0cmwuJGZvcm1hdHRlcnMubGVuZ3RoO1xyXG5cclxuICAgICAgd2hpbGUgKGlkeC0tKSB7XHJcbiAgICAgICAgdmFyIGZuID0gbmdNb2RlbEN0cmwuJGZvcm1hdHRlcnNbaWR4XTtcclxuICAgICAgICB2YXIgdmlld1ZhbHVlID0gZm4odmlld1ZhbHVlKTtcclxuXHJcbiAgICAgICAgaWYgKHZpZXdWYWx1ZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvLyBQYXJzZSB0aGUgdmlld1ZhbHVlXHJcblxyXG4gICAgICBpZHggPSBuZ01vZGVsQ3RybC4kcGFyc2Vycy5sZW5ndGg7XHJcbiAgICAgIHZhciBwdiA9IHZpZXdWYWx1ZTtcclxuXHJcbiAgICAgIHdoaWxlIChpZHgtLSkge1xyXG4gICAgICAgIHZhciBmbiA9IG5nTW9kZWxDdHJsLiRwYXJzZXJzW2lkeF07XHJcbiAgICAgICAgcHYgPSBmbihwdik7XHJcblxyXG4gICAgICAgIGlmIChwdiA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChwdiA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgLy8gRmFpbGVkIHRvIHBhcnNlLlxyXG4gICAgICAgIC8vIFNldCB0aGUgZm9ybWF0dGVkIHN0cmluZyBpbiB0aGUgaW5wdXQsIHdoaWNoIHdpbGwgcmV0cmlnZ2VyIHRoZSBwYXJzaW5nIGFuZCBkaXNwbGF5IHRoZSBjb3JyZWN0IGVycm9yIG1lc3NhZ2UuXHJcblxyXG4gICAgICAgIG5nTW9kZWxDdHJsLiRzZXRWaWV3VmFsdWUodmlld1ZhbHVlKTtcclxuICAgICAgICBuZ01vZGVsQ3RybC4kcmVuZGVyKCk7XHJcblxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIG1vZGVsU2V0dGVyKCRzY29wZSwgdmFsdWUpO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5nZXRNb2RlbFZhbHVlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgIHJldHVybiBtb2RlbEdldHRlcigkc2NvcGUpO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgaW5wdXQgPSAkaW5wdXRbMF07XHJcblxyXG4gICAgJHNjb3BlLiR3YXRjaCgnZHJvcGRvd25WaXNpYmxlJywgZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgaWYgKHZhbHVlKSB7XHJcblxyXG4gICAgICAgIHZhciByZWN0ID0gaW5wdXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgdmFyIHNjcm9sbCA9IGZlYndvcm1zVXRpbHMuZ2V0U2Nyb2xsT2Zmc2V0KCk7XHJcblxyXG4gICAgICAgICR0ZW1wbGF0ZS5jc3Moe1xyXG4gICAgICAgICAgbGVmdDogKHNjcm9sbC54ICsgcmVjdC5sZWZ0KSArICdweCcsXHJcbiAgICAgICAgICB0b3A6IChzY3JvbGwueSArIHJlY3QudG9wICsgaW5wdXQuY2xpZW50SGVpZ2h0KSArICdweCcsXHJcbiAgICAgICAgICB3aWR0aDogaW5wdXQuY2xpZW50V2lkdGggKyAncHgnXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgICRzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKCRhdHRycy5mZWJ3b3Jtc0Ryb3Bkb3duSW5wdXQsIGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICRzY29wZS5pdGVtcyA9IHZhbHVlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbigpIHtcclxuICAgICAgJHRlbXBsYXRlLnJlbW92ZSgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuICR0ZW1wbGF0ZTtcclxuICB9XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBwcmlvcml0eTogMTAwMCxcclxuICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICB0ZXJtaW5hbDogdHJ1ZSxcclxuICAgIHNjb3BlOiB0cnVlLFxyXG4gICAgY29tcGlsZTogZnVuY3Rpb24odEVsZW1lbnQsIHRBdHRycykge1xyXG5cclxuICAgICAgcmV0dXJuIGZ1bmN0aW9uIGxpbmsoJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzLCBjdHJscykge1xyXG5cclxuICAgICAgICB2YXIgJGlucHV0ID0gY3JlYXRlSW5wdXQoJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzKTtcclxuXHJcbiAgICAgICAgJGVsZW1lbnQuYXBwZW5kKCRpbnB1dCk7XHJcbiAgICAgICAgJGNvbXBpbGUoJGlucHV0KSgkc2NvcGUpO1xyXG5cclxuICAgICAgICB2YXIgJGlucHV0VGV4dCA9ICRpbnB1dC5maW5kKCdpbnB1dCcpO1xyXG4gICAgICAgIHZhciBuZ01vZGVsQ3RybCA9ICRpbnB1dFRleHQuY29udHJvbGxlcignbmdNb2RlbCcpO1xyXG5cclxuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG4gICAgICAgIHZhciAkZHJvcGRvd24gPSBjcmVhdGVEcm9wZG93bigkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMsIG5nTW9kZWxDdHJsLCAkaW5wdXQpO1xyXG4gICAgICAgIHZhciBkcm9wZG93bkNvbXBpbGVGbiA9ICRjb21waWxlKCRkcm9wZG93bik7XHJcblxyXG4gICAgICAgIHZhciAkYm9keSA9ICRkb2N1bWVudC5maW5kKCdib2R5Jyk7XHJcblxyXG4gICAgICAgICRib2R5LmFwcGVuZCgkZHJvcGRvd24pO1xyXG5cclxuICAgICAgICBkcm9wZG93bkNvbXBpbGVGbigkc2NvcGUpO1xyXG5cclxuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgfTtcclxufV0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgnZmVid29ybXMnLCBbXCJmZWJ3b3Jtcy50ZW1wbGF0ZXNcIl0pLmRpcmVjdGl2ZSgnZmVid29ybXNCaW5kRXhwcmVzc2lvbicsIFsnJGludGVycG9sYXRlJywgZnVuY3Rpb24gKCRpbnRlcnBvbGF0ZSkge1xyXG5cclxuICBmdW5jdGlvbiBidWlsZFdhdGNoRXhwcmVzc2lvbihpbnRlcnBvbGF0ZUZuKSB7XHJcbiAgICB2YXIgc2IgPSBbXTtcclxuICAgIHZhciBwYXJ0cyA9IGludGVycG9sYXRlRm4ucGFydHM7XHJcbiAgICB2YXIgaWkgPSBwYXJ0cy5sZW5ndGg7XHJcblxyXG4gICAgd2hpbGUgKGlpLS0pIHtcclxuICAgICAgdmFyIHBhcnQgPSBwYXJ0c1tpaV07XHJcblxyXG4gICAgICBpZiAocGFydC5leHAgJiYgIXBhcnQuZXhwLm1hdGNoKC9eXFxzKiQvKSkge1xyXG4gICAgICAgIHNiLnB1c2gocGFydC5leHApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuICdbJyArIHNiLmpvaW4oKSArICddJztcclxuICB9XHJcblxyXG4gIHJldHVybiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcclxuXHJcbiAgICB2YXIgaW50ZXJwb2xhdGVGbiwgd2F0Y2hIYW5kbGUsIG9sZFdhdGNoRXhwcjtcclxuXHJcbiAgICBmdW5jdGlvbiBjbGVhbldhdGNoSGFuZGxlKCkge1xyXG4gICAgICBpZiAod2F0Y2hIYW5kbGUpIHdhdGNoSGFuZGxlKCk7XHJcbiAgICAgIHdhdGNoSGFuZGxlID0gdW5kZWZpbmVkO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGludGVycG9sYXRlRXhwcmVzc2lvbigpIHtcclxuICAgICAgZWxlbWVudC50ZXh0KGludGVycG9sYXRlRm4oc2NvcGUpKTtcclxuICAgIH1cclxuXHJcbiAgICBzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICBjbGVhbldhdGNoSGFuZGxlKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBzY29wZS4kd2F0Y2goYXR0ci5mZWJ3b3Jtc0JpbmRFeHByZXNzaW9uLCBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICBpbnRlcnBvbGF0ZUZuID0gJGludGVycG9sYXRlKHZhbHVlKTtcclxuXHJcbiAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnbmctYmluZGluZycpLmRhdGEoJyRiaW5kaW5nJywgaW50ZXJwb2xhdGVGbik7XHJcblxyXG4gICAgICAgIHZhciB3YXRjaEV4cHIgPSBidWlsZFdhdGNoRXhwcmVzc2lvbihpbnRlcnBvbGF0ZUZuKTtcclxuXHJcbiAgICAgICAgaWYgKG9sZFdhdGNoRXhwciAhPT0gd2F0Y2hFeHByKSB7XHJcblxyXG4gICAgICAgICAgb2xkV2F0Y2hFeHByID0gd2F0Y2hFeHByO1xyXG5cclxuICAgICAgICAgIGNsZWFuV2F0Y2hIYW5kbGUoKTtcclxuXHJcbiAgICAgICAgICB3YXRjaEhhbmRsZSA9IHNjb3BlLiR3YXRjaENvbGxlY3Rpb24od2F0Y2hFeHByLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGludGVycG9sYXRlRXhwcmVzc2lvbigpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGludGVycG9sYXRlRXhwcmVzc2lvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfTtcclxufV0pO1xyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=